

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="100:00:00,000 –&gt; 00:00:04,000By now you know how to calculate the end-to-end delay of a packet across a network, 200:00:04,000 –&gt; 00:00:09,000and you know that the queuing delay makes the end-to">
<meta property="og:type" content="article">
<meta property="og:title" content="CS144 Network3 4PacketSwitching">
<meta property="og:url" content="http://example.com/2025/10/23/CS144-network3-4PacketSwitching/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="100:00:00,000 –&gt; 00:00:04,000By now you know how to calculate the end-to-end delay of a packet across a network, 200:00:04,000 –&gt; 00:00:09,000and you know that the queuing delay makes the end-to">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-10-23T14:13:16.917Z">
<meta property="article:modified_time" content="2025-10-23T14:13:54.940Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>CS144 Network3 4PacketSwitching - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="CS144 Network3 4PacketSwitching"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-10-23 22:13" pubdate>
          2025年10月23日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          1.6k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          14 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">CS144 Network3 4PacketSwitching</h1>
            
            
              <div class="markdown-body">
                
                <p>1<br>00:00:00,000 –&gt; 00:00:04,000<br>By now you know how to calculate the end-to-end delay of a packet across a network,</p>
<p>2<br>00:00:04,000 –&gt; 00:00:09,000<br>and you know that the queuing delay makes the end-to-end delay variable.</p>
<p>3<br>00:00:09,000 –&gt; 00:00:14,000<br>Most of the applications that we use don’t particularly care about this variability in end-to-end delay.</p>
<p>4<br>00:00:14,000 –&gt; 00:00:17,000<br>For example, when we’re downloading a webpage or sending an email,</p>
<p>5<br>00:00:17,000 –&gt; 00:00:25,000<br>we want it to complete quickly, but we don’t particularly mind if individual packets take 10 or 12 milliseconds to reach the other end.</p>
<p>6<br>00:00:26,000 –&gt; 00:00:31,000<br>But there are some applications that really do care. They have to care about the queuing delay,</p>
<p>7<br>00:00:31,000 –&gt; 00:00:36,000<br>particularly what we call real-time applications like streaming video and voice.</p>
<p>8<br>00:00:36,000 –&gt; 00:00:46,000<br>So let’s take a look at an example. Over the next few minutes I’m going to explain why queuing delay makes life hard for these applications.</p>
<p>9<br>00:00:46,000 –&gt; 00:00:52,000<br>It serves as a good illustration of queuing delay and how we might mitigate the problem in practice.</p>
<p>10<br>00:00:53,000 –&gt; 00:00:58,000<br>Basically because the applications don’t know precisely when the packets are going to show up,</p>
<p>11<br>00:00:58,000 –&gt; 00:01:05,000<br>they can’t be sure they will have a voice or video sample in time to deliver it to the user.</p>
<p>12<br>00:01:05,000 –&gt; 00:01:10,000<br>And so they build up a reserve of packets in something called the playback buffer.</p>
<p>13<br>00:01:11,000 –&gt; 00:01:13,000<br>So we’re going to take a look at playback buffers.</p>
<p>14<br>00:01:14,000 –&gt; 00:01:18,000<br>You’ve actually all seen a playback buffer before.</p>
<p>15<br>00:01:18,000 –&gt; 00:01:23,000<br>This is a little screenshot from the bottom of a YouTube client.</p>
<p>16<br>00:01:23,000 –&gt; 00:01:27,000<br>And the red line on the left over here.</p>
<p>17<br>00:01:27,000 –&gt; 00:01:31,000<br>This shows the video that we’ve already watched.</p>
<p>18<br>00:01:32,000 –&gt; 00:01:37,000<br>This here is the point of playback. This dot shows where we’ve got to.</p>
<p>19<br>00:01:37,000 –&gt; 00:01:45,000<br>And this area over here is this gray line shows the video that has been buffered,</p>
<p>20<br>00:01:45,000 –&gt; 00:01:50,000<br>or the packets that have been buffered, that have not yet been played back to the user.</p>
<p>21<br>00:01:50,000 –&gt; 00:01:53,000<br>And this is the part that we’re going to be interested in.</p>
<p>22<br>00:01:53,000 –&gt; 00:01:56,000<br>This here is the playback buffer.</p>
<p>23<br>00:01:58,000 –&gt; 00:02:03,000<br>So the client deliberately tries to build up that playback buffer to try and get ahead,</p>
<p>24<br>00:02:03,000 –&gt; 00:02:07,000<br>just in case some of the packets are delayed or they don’t arrive in time.</p>
<p>25<br>00:02:07,000 –&gt; 00:02:11,000<br>And in case there’s some kind of temporary outage.</p>
<p>26<br>00:02:12,000 –&gt; 00:02:18,000<br>So when designing the playback buffer, we have to think about how far ahead we want the buffer to get.</p>
<p>27<br>00:02:18,000 –&gt; 00:02:22,000<br>So if we were to build up the buffer all the way over here and build up more packets,</p>
<p>28<br>00:02:22,000 –&gt; 00:02:29,000<br>then we’ve absorbed more data and we can write out more variability in the queueing delay.</p>
<p>29<br>00:02:29,000 –&gt; 00:02:34,000<br>If we make it very short down here, if there’s a big change or a big change in the queueing delay</p>
<p>30<br>00:02:34,000 –&gt; 00:02:40,000<br>or a sudden increase in the queueing delay, we may run out of packets because they may not show up in time.</p>
<p>31<br>00:02:40,000 –&gt; 00:02:45,000<br>So designing this playback buffer is pretty key to making this application work.</p>
<p>32<br>00:02:45,000 –&gt; 00:02:49,000<br>So how much we want to accumulate in the buffer when we start playing the back,</p>
<p>33<br>00:02:49,000 –&gt; 00:02:51,000<br>back the video to the user is key.</p>
<p>34<br>00:02:51,000 –&gt; 00:02:55,000<br>So let’s take a closer look at this.</p>
<p>35<br>00:02:55,000 –&gt; 00:02:58,000<br>This is the point that we’re playing.</p>
<p>36<br>00:02:58,000 –&gt; 00:03:01,000<br>This is the amount that we’ve buffered.</p>
<p>37<br>00:03:01,000 –&gt; 00:03:03,000<br>This is the contents of the playback buffer.</p>
<p>38<br>00:03:03,000 –&gt; 00:03:06,000<br>If we look down and do a little bit more detail,</p>
<p>39<br>00:03:06,000 –&gt; 00:03:10,000<br>let’s take as an example this setup here.</p>
<p>40<br>00:03:10,000 –&gt; 00:03:16,000<br>So imagine we’re watching a YouTube video on the laptop on the right, so we’re over here.</p>
<p>41<br>00:03:16,000 –&gt; 00:03:23,000<br>And it’s streaming video from the server, the YouTube server on the left, over here.</p>
<p>42<br>00:03:23,000 –&gt; 00:03:29,000<br>So we’re going to assume that the video is being streamed at one megabit per second.</p>
<p>43<br>00:03:29,000 –&gt; 00:03:32,000<br>Now this is just a made up number.</p>
<p>44<br>00:03:32,000 –&gt; 00:03:37,000<br>So this is just going to make it easy for us to think about.</p>
<p>45<br>00:03:37,000 –&gt; 00:03:40,000<br>And it’s going to pass through several routers along the path,</p>
<p>46<br>00:03:40,000 –&gt; 00:03:44,000<br>one, two, and three on the figure here, but it could be many more than that.</p>
<p>47<br>00:03:44,000 –&gt; 00:03:52,000<br>Be very common for our packets to go through 10 or 15 routers on the path from YouTube to our client.</p>
<p>48<br>00:03:52,000 –&gt; 00:04:01,000<br>And the thing that we’re going to be concerned mostly about is the queueing delay here.</p>
<p>49<br>00:04:01,000 –&gt; 00:04:04,000<br>So there’s three places where we can experience queueing delay.</p>
<p>50<br>00:04:04,000 –&gt; 00:04:10,000<br>And that variable queueing delay is going to mean that our packets show up at slightly unpredictable times.</p>
<p>51<br>00:04:10,000 –&gt; 00:04:13,000<br>So let’s look at a graph of what this might look like.</p>
<p>52<br>00:04:13,000 –&gt; 00:04:20,000<br>This graph shows the cumulative number of bytes sent by the server over time as a function of time.</p>
<p>53<br>00:04:20,000 –&gt; 00:04:24,000<br>Because it’s sending at a fixed rate of one megabit per second,</p>
<p>54<br>00:04:24,000 –&gt; 00:04:34,000<br>it means that the line is straight, the cumulative number of bits or bytes that it sent as a function of time is a straight line.</p>
<p>55<br>00:04:34,000 –&gt; 00:04:43,000<br>And so after one second, they will have sent a megabit, a million bits, and after 10 seconds, they will have sent 10 million bits.</p>
<p>56<br>00:04:43,000 –&gt; 00:04:51,000<br>Because of the variable queueing delay in the network, the cumulative arrivals at the laptop look a little bit different.</p>
<p>57<br>00:04:51,000 –&gt; 00:04:56,000<br>They might look like this. So you see this wheely line that I’ve got here.</p>
<p>58<br>00:04:56,000 –&gt; 00:05:01,000<br>What does this mean? It means that if we take the first byte here, because they’re all arriving in first come first server,</p>
<p>59<br>00:05:01,000 –&gt; 00:05:06,000<br>we can just draw horizontally across here and see when a particular byte arrived.</p>
<p>60<br>00:05:06,000 –&gt; 00:05:09,000<br>So this one arrived here after that delay.</p>
<p>61<br>00:05:09,000 –&gt; 00:05:15,000<br>So the x-axis is going to tell you how long that particular byte took together.</p>
<p>62<br>00:05:15,000 –&gt; 00:05:20,000<br>Notice I’m saying bits and bytes. It doesn’t matter what our units are here.</p>
<p>63<br>00:05:20,000 –&gt; 00:05:29,000<br>So if we would take any point on here, let’s say this particular byte, and we draw horizontally, I’m not very good at drawing straight lines,</p>
<p>64<br>00:05:29,000 –&gt; 00:05:36,000<br>but that’s supposed to be horizontal. And right here is the time at which that particular byte arrived at the laptop.</p>
<p>65<br>00:05:36,000 –&gt; 00:05:42,000<br>So you can see that the delay is measured by the horizontal distance, the horizontal distance here.</p>
<p>66<br>00:05:42,000 –&gt; 00:05:49,000<br>And you can see that it’s a variable number, depending on the queuing delay encountered by each of the individual packets.</p>
<p>67<br>00:05:49,000 –&gt; 00:06:06,000<br>We can also see for a given time, how big the amount of buffering along the path, basically how many bytes are in the path from the server to the client.</p>
<p>68<br>00:06:07,000 –&gt; 00:06:14,000<br>And that would be shown by the vertical distance here, because it says that at a particular time,</p>
<p>69<br>00:06:14,000 –&gt; 00:06:19,000<br>this is the number that have been sent, and this is the number that have been received.</p>
<p>70<br>00:06:19,000 –&gt; 00:06:25,000<br>So we can tell quite a lot of information from this graph. And we’re going to be seeing some more examples of this time of graph later.</p>
<p>71<br>00:06:25,000 –&gt; 00:06:33,000<br>Horizontal axis is the delay, the vertical axis, it tells us how many bytes are buffered right now in the network.</p>
<p>72<br>00:06:34,000 –&gt; 00:06:39,000<br>Okay, so let’s get back to our example.</p>
<p>73<br>00:06:39,000 –&gt; 00:06:46,000<br>So the biggest component of the delay is the propagation and packetization delay. That’s the fixed component.</p>
<p>74<br>00:06:46,000 –&gt; 00:06:53,000<br>So we actually know quite a bit about the shape of this line.</p>
<p>75<br>00:06:53,000 –&gt; 00:06:58,000<br>So the actual shape could look very different. I just made up this shape.</p>
<p>76<br>00:06:59,000 –&gt; 00:07:06,000<br>However, we do know a couple of things. First, the overall end to end delay can’t be less than the packetization and propagation delay.</p>
<p>77<br>00:07:06,000 –&gt; 00:07:13,000<br>There are lower bound. So this has a lower bound in the horizontal distance between the two here.</p>
<p>78<br>00:07:16,000 –&gt; 00:07:25,000<br>It also has an upper bound. So the buffers in the routers, the packet buffers here, they’re of finite size.</p>
<p>79<br>00:07:25,000 –&gt; 00:07:31,000<br>So there’s a maximum delay that any packet can experience going through one of those buffers.</p>
<p>80<br>00:07:31,000 –&gt; 00:07:38,000<br>So if we add up the maximum of each of these, add it to the packetization delay and the propagation delay, it’s going to represent an upper bound.</p>
<p>81<br>00:07:38,000 –&gt; 00:07:41,000<br>So we have a lower bound and we have an upper bound.</p>
<p>82<br>00:07:41,000 –&gt; 00:07:44,000<br>But the upper bound is not very useful because it can be very, very large.</p>
<p>83<br>00:07:44,000 –&gt; 00:07:48,000<br>In practice, these routers may have half a second of buffering.</p>
<p>84<br>00:07:48,000 –&gt; 00:07:55,000<br>So if we’re going through many hops, it would mean a ridiculous difference between the lower bound and the upper bound.</p>
<p>85<br>00:07:55,000 –&gt; 00:07:58,000<br>So that’s not much use to us.</p>
<p>86<br>00:08:03,000 –&gt; 00:08:09,000<br>We also know that the cumulative arrivals on the right hand side are non-decreasing.</p>
<p>87<br>00:08:09,000 –&gt; 00:08:14,000<br>In other words, this value is always increasing because it’s the cumulative number of bytes.</p>
<p>88<br>00:08:14,000 –&gt; 00:08:19,000<br>And obviously we can’t have a negative number of bytes show up.</p>
<p>89<br>00:08:19,000 –&gt; 00:08:28,000<br>Finally, one more thing that we know is because we know how fast or there is an upper bound on the rate of that last link,</p>
<p>90<br>00:08:28,000 –&gt; 00:08:35,000<br>it could be a hundred megabit per second link or a gigabit per second link, it tells us that the instantaneous arrival rate here,</p>
<p>91<br>00:08:35,000 –&gt; 00:08:40,000<br>the gradient of this line here, can’t exceed the data rate of that link.</p>
<p>92<br>00:08:41,000 –&gt; 00:08:50,000<br>Okay, so with all of those caveats, let’s look at what the client actually needs to do to make all of this work.</p>
<p>93<br>00:08:50,000 –&gt; 00:08:57,000<br>So this red line here shows the playback rate of the video to the user.</p>
<p>94<br>00:08:57,000 –&gt; 00:09:06,000<br>So what this tells us is that at this time here, it’s playing back the first byte that was sent by the server,</p>
<p>95<br>00:09:06,000 –&gt; 00:09:10,000<br>which is of course the first byte received by the receiver.</p>
<p>96<br>00:09:10,000 –&gt; 00:09:21,000<br>So if at any point we take a horizontal line across here, it will tell us the time that a particular byte was sent, received, and then played back.</p>
<p>97<br>00:09:21,000 –&gt; 00:09:33,000<br>What that means is that the horizontal distance here tells us, for example, in the horizontal distance here,</p>
<p>98<br>00:09:33,000 –&gt; 00:09:38,000<br>tells us how long a particular byte has been buffered.</p>
<p>99<br>00:09:38,000 –&gt; 00:09:46,000<br>So at any one time we can tell how long it’s sad in the playback buffer before it was played back to the receiver.</p>
<p>100<br>00:09:46,000 –&gt; 00:09:50,000<br>We also know how many bytes there are in the playback buffer.</p>
<p>101<br>00:09:50,000 –&gt; 00:09:54,000<br>It’s the vertical distance here at any one time.</p>
<p>102<br>00:09:54,000 –&gt; 00:09:57,000<br>It tells us what the occupancy of the playback buffer is.</p>
<p>103<br>00:09:57,000 –&gt; 00:10:00,000<br>So we can see that the playback buffer was very small to start with.</p>
<p>104<br>00:10:00,000 –&gt; 00:10:09,000<br>It accumulates, it accumulates, it accumulates, gets to a very large value here, then gets smaller as we fall behind.</p>
<p>105<br>00:10:09,000 –&gt; 00:10:11,000<br>Almost goes empty here.</p>
<p>106<br>00:10:11,000 –&gt; 00:10:15,000<br>We’re very lucky that there must have been some bytes that showed up late.</p>
<p>107<br>00:10:15,000 –&gt; 00:10:24,000<br>We just avoided underrunning the buffer, and then at some time we built up a little bit more, etc. as we go up here.</p>
<p>108<br>00:10:24,000 –&gt; 00:10:28,000<br>So we’re playing back at a constant one megabits per second.</p>
<p>109<br>00:10:28,000 –&gt; 00:10:31,000<br>That’s what’s being played back to the user.</p>
<p>110<br>00:10:31,000 –&gt; 00:10:33,000<br>So this is a good example.</p>
<p>111<br>00:10:33,000 –&gt; 00:10:40,000<br>We pick the right value, we waited long enough, we build up enough buffer, everything worked out, fine in the end.</p>
<p>112<br>00:10:40,000 –&gt; 00:10:46,000<br>So if we take a look inside the client, it looks roughly like this.</p>
<p>113<br>00:10:46,000 –&gt; 00:10:52,000<br>So the playback buffer is a buffer held in the memory of the client.</p>
<p>114<br>00:10:52,000 –&gt; 00:10:55,000<br>The client is picking the playback point.</p>
<p>115<br>00:10:55,000 –&gt; 00:11:03,000<br>This here, this is the point at which it’s reached, and that’s that dot that we see on the YouTube client.</p>
<p>116<br>00:11:03,000 –&gt; 00:11:13,000<br>After the bytes have been taken out of the playback buffer, they put into a video decoder to turn them back into video and then played out on the screen.</p>
<p>117<br>00:11:13,000 –&gt; 00:11:18,000<br>Okay, let’s look at an example of when things don’t quite work out fine.</p>
<p>118<br>00:11:18,000 –&gt; 00:11:24,000<br>So there’s the same example again, the bytes sent by the server on the left, received by the laptop on the right.</p>
<p>119<br>00:11:24,000 –&gt; 00:11:30,000<br>But in this particular case, we didn’t wait long enough before playing out the first byte.</p>
<p>120<br>00:11:30,000 –&gt; 00:11:39,000<br>You can see that here, we’ve waited a little less time from when the first byte was received until we play out that first byte.</p>
<p>121<br>00:11:39,000 –&gt; 00:11:42,000<br>And of course, once we start playing out the bytes, we’re committed.</p>
<p>122<br>00:11:42,000 –&gt; 00:11:45,000<br>We’ve got to play them out at one megabits per second.</p>
<p>123<br>00:11:45,000 –&gt; 00:11:49,000<br>Otherwise, we can’t keep putting the video on the screen.</p>
<p>124<br>00:11:49,000 –&gt; 00:11:53,000<br>So on this particular case here, everything looks fine to start with.</p>
<p>125<br>00:11:53,000 –&gt; 00:11:56,000<br>The buffer has a nice occupancy, nice occupancy, nice occupancy.</p>
<p>126<br>00:11:56,000 –&gt; 00:12:01,000<br>It gets smaller and smaller and smaller until eventually, at this point here, we have a problem.</p>
<p>127<br>00:12:01,000 –&gt; 00:12:07,000<br>The buffer goes empty, which means we’ve got no bytes to decode and put onto the screen.</p>
<p>128<br>00:12:07,000 –&gt; 00:12:12,000<br>So all of this area here is a time in which we’re in deficit.</p>
<p>129<br>00:12:12,000 –&gt; 00:12:13,000<br>This is not good.</p>
<p>130<br>00:12:13,000 –&gt; 00:12:15,000<br>What does the client do?</p>
<p>131<br>00:12:15,000 –&gt; 00:12:16,000<br>Well, we’ve all seen this before.</p>
<p>132<br>00:12:16,000 –&gt; 00:12:25,000<br>It has to make the buffer bigger and it does this by rebuffering, by freezing the screen, waiting for some bytes to accumulate, and so that it can continue.</p>
<p>133<br>00:12:25,000 –&gt; 00:12:26,000<br>Okay?</p>
<p>134<br>00:12:26,000 –&gt; 00:12:34,000<br>So if you’ve been watching this particular video right now over a slow link,</p>
<p>135<br>00:12:34,000 –&gt; 00:12:40,000<br>or if you’re a long way away and you have your packets are going through many routers,</p>
<p>136<br>00:12:40,000 –&gt; 00:12:43,000<br>you might experience a rebuffering event watching this video.</p>
<p>137<br>00:12:43,000 –&gt; 00:12:51,000<br>You can fix the problem by streaming at a slower rate, or just simply by downloading the video ahead of time.</p>
<p>138<br>00:12:51,000 –&gt; 00:12:56,000<br>So in summary, with a playback buffer, when we have packet switching, end-to-end delay is variable.</p>
<p>139<br>00:12:56,000 –&gt; 00:13:00,000<br>We use a playback buffer to absorb the variation.</p>
<p>140<br>00:13:00,000 –&gt; 00:13:05,000<br>We could just make the playback buffer very big, but then the video would be delayed at the start.</p>
<p>141<br>00:13:05,000 –&gt; 00:13:11,000<br>That was the time that we were waiting from the first byte to arrive until we played out onto the screen.</p>
<p>142<br>00:13:11,000 –&gt; 00:13:17,000<br>We could make the buffer bigger, but if we were to make that buffer bigger, then we would have to delay the starting point of the video,</p>
<p>143<br>00:13:17,000 –&gt; 00:13:21,000<br>which would be kind of annoying when we’re watching our videos.</p>
<p>144<br>00:13:21,000 –&gt; 00:13:24,000<br>So therefore, applications try to estimate the delay.</p>
<p>145<br>00:13:24,000 –&gt; 00:13:26,000<br>They try and estimate the delay from the server to the laptop.</p>
<p>146<br>00:13:26,000 –&gt; 00:13:33,000<br>Set the playback value, and then resize the buffer if the delay changes.</p>
<p>147<br>00:13:33,000 –&gt; 00:13:38,000<br>Okay, so now let’s go back to our original expression for the end-to-end delay.</p>
<p>148<br>00:13:38,000 –&gt; 00:13:43,000<br>So now we’ve seen that it has these three components to it,</p>
<p>149<br>00:13:43,000 –&gt; 00:13:47,000<br>packetization delay, propagation delay, and then the variable queuing delay,</p>
<p>150<br>00:13:47,000 –&gt; 00:13:55,000<br>and the queuing adds variable and unpredictable delay to the path and to the packets from end to end.</p>
<p>151<br>00:13:56,000 –&gt; 00:14:01,000<br>Okay, so in summary, end-to-end delay consists of three components.</p>
<p>152<br>00:14:01,000 –&gt; 00:14:07,000<br>The first two are fixed, propagation delay, which is the time that it takes for a bit to propagate over a link.</p>
<p>153<br>00:14:07,000 –&gt; 00:14:12,000<br>The packetization delay, which is the time that it takes to put a packet onto a link,</p>
<p>154<br>00:14:12,000 –&gt; 00:14:22,000<br>and then the queuing delay, which is variable, which is dictated by the time that a packet spends in the buffers in the routers along the path.</p>
<p>155<br>00:14:22,000 –&gt; 00:14:28,000<br>Some applications, as we saw, use playback buffers to absorb this variable queuing delay</p>
<p>156<br>00:14:28,000 –&gt; 00:14:33,000<br>to help the applications stream the video back to us at a fixed rate.</p>
<p>157<br>00:14:33,000 –&gt; 00:14:36,000<br>So this is the end of packet switching 2.</p>
<p>158<br>00:14:36,000 –&gt; 00:14:45,000<br>I will see you again in packet switching 3, where I’m going to tell you about a simple deterministic model that helps us understand this variable queuing delay.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>CS144 Network3 4PacketSwitching</div>
      <div>http://example.com/2025/10/23/CS144-network3-4PacketSwitching/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年10月23日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/10/23/CS144-networkP1017-7Wireless/" title="CS144 NetworkP1017 7Wireless">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">CS144 NetworkP1017 7Wireless</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/10/18/6S081-023/" title="操作系统工程 023-Final QA">
                        <span class="hidden-mobile">操作系统工程 023-Final QA</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
