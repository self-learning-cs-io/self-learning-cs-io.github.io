

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="100:00:00,000 –&gt; 00:00:05,000In this video, you’re going to be learning about TCP, the transmission control protocol, 200:00:05,000 –&gt; 00:00:09,000which is used by over 95% of all internet appli">
<meta property="og:type" content="article">
<meta property="og:title" content="CS144 NetworkP232 1TCPservicemodel">
<meta property="og:url" content="http://example.com/2025/10/23/CS144-networkP232-1TCPservicemodel/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="100:00:00,000 –&gt; 00:00:05,000In this video, you’re going to be learning about TCP, the transmission control protocol, 200:00:05,000 –&gt; 00:00:09,000which is used by over 95% of all internet appli">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-10-23T14:13:16.942Z">
<meta property="article:modified_time" content="2025-10-23T14:13:54.947Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>CS144 NetworkP232 1TCPservicemodel - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="CS144 NetworkP232 1TCPservicemodel"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-10-23 22:13" pubdate>
          2025年10月23日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          1.6k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          14 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">CS144 NetworkP232 1TCPservicemodel</h1>
            
            
              <div class="markdown-body">
                
                <p>1<br>00:00:00,000 –&gt; 00:00:05,000<br>In this video, you’re going to be learning about TCP, the transmission control protocol,</p>
<p>2<br>00:00:05,000 –&gt; 00:00:09,000<br>which is used by over 95% of all internet applications.</p>
<p>3<br>00:00:09,000 –&gt; 00:00:13,000<br>TCP is almost universally used because it provides the reliable, end-to-end,</p>
<p>4<br>00:00:13,000 –&gt; 00:00:18,000<br>bidirectional, byte stream service that almost all applications want.</p>
<p>5<br>00:00:18,000 –&gt; 00:00:21,000<br>TCP is an example of the transport layer.</p>
<p>6<br>00:00:21,000 –&gt; 00:00:26,000<br>When an application calls TCP, it hands its invites that it wants delivered to the other end.</p>
<p>7<br>00:00:26,000 –&gt; 00:00:31,000<br>TCP places these bytes into a TCP segment and then takes it from there.</p>
<p>8<br>00:00:31,000 –&gt; 00:00:36,000<br>TCP hands the segments to the IP layer, which encapsulates it into an IP datagram.</p>
<p>9<br>00:00:36,000 –&gt; 00:00:39,000<br>The IP addresses are added.</p>
<p>10<br>00:00:39,000 –&gt; 00:00:43,000<br>The IP datagram is handed in turn to the link layer, which builds the link frame,</p>
<p>11<br>00:00:43,000 –&gt; 00:00:50,000<br>adds the link address, for example, the Ethernet addresses, and then sits sends it onto the wire.</p>
<p>12<br>00:00:50,000 –&gt; 00:00:54,000<br>When two applications use TCP, they establish a two-way communication channel</p>
<p>13<br>00:00:54,000 –&gt; 00:00:57,000<br>between the TCP and P peers at both ends.</p>
<p>14<br>00:00:57,000 –&gt; 00:01:01,000<br>First, TCP establishes a communication channel from A to B.</p>
<p>15<br>00:01:01,000 –&gt; 00:01:04,000<br>Then, it establishes the channel from B to A.</p>
<p>16<br>00:01:04,000 –&gt; 00:01:07,000<br>We call the two-way communication a connection.</p>
<p>17<br>00:01:07,000 –&gt; 00:01:13,000<br>At both ends of the connection, TCP keeps a state machine to keep track of how the connection is doing.</p>
<p>18<br>00:01:13,000 –&gt; 00:01:16,000<br>We’ll see how the state machine works in a separate video.</p>
<p>19<br>00:01:17,000 –&gt; 00:01:22,000<br>The TCP connection is established using a three-way handshake between hosts A and B.</p>
<p>20<br>00:01:22,000 –&gt; 00:01:30,000<br>First of all, host A sends a message to B, indicating that the TCP layer at A wants to establish a connection with the TCP layer at B.</p>
<p>21<br>00:01:30,000 –&gt; 00:01:35,000<br>The message is called the Sin message, SYN, which is short for synchronize,</p>
<p>22<br>00:01:35,000 –&gt; 00:01:40,000<br>because A also sends along the base number it will use to identify bytes in the byte stream.</p>
<p>23<br>00:01:40,000 –&gt; 00:01:43,000<br>If it sends 0, then the numbers will start at 0.</p>
<p>24<br>00:01:43,000 –&gt; 00:01:47,000<br>If it sends a thousand, then they will start at 1,000.</p>
<p>25<br>00:01:47,000 –&gt; 00:01:50,000<br>B responds with what we call the Sin plus AC.</p>
<p>26<br>00:01:50,000 –&gt; 00:01:57,000<br>B signals an AC because B is a acknowledging A’s request and a green to establish the communication from A to B.</p>
<p>27<br>00:01:57,000 –&gt; 00:02:07,000<br>The TCP layer at B also sends a Sin back to A to indicate that the TCP layer at B wants to establish a connection with the TCP layer at A.</p>
<p>28<br>00:02:07,000 –&gt; 00:02:12,000<br>It sends a number two indicating the starting number for the byte stream in the reverse direction.</p>
<p>29<br>00:02:12,000 –&gt; 00:02:19,000<br>Finally, A responds with an AC to indicate that it is accepting the request for communication in the reverse direction.</p>
<p>30<br>00:02:19,000 –&gt; 00:02:25,000<br>The connection is now set up in both directions, they are now ready to start sending data to each other.</p>
<p>31<br>00:02:25,000 –&gt; 00:02:32,000<br>The hosts send data to each other as if it were from a continuous stream of bytes.</p>
<p>32<br>00:02:32,000 –&gt; 00:02:40,000<br>Assume time is increasing from left to right and the stream of bytes next to A represents the bytes it wants to send to B.</p>
<p>33<br>00:02:40,000 –&gt; 00:02:43,000<br>The stream of bytes might exist in advance.</p>
<p>34<br>00:02:43,000 –&gt; 00:02:48,000<br>For example, they are read from an HTML file describing a static web page.</p>
<p>35<br>00:02:48,000 –&gt; 00:02:53,000<br>Or it could be a stream being generated on the fly, for example from a video camera.</p>
<p>36<br>00:02:53,000 –&gt; 00:02:56,000<br>Either way, TCP sees it as a stream of bytes.</p>
<p>37<br>00:02:56,000 –&gt; 00:03:01,000<br>Data from the application on A is delivered to the application at B.</p>
<p>38<br>00:03:01,000 –&gt; 00:03:09,000<br>The TCP layers on A and B work together to make sure the stream of bytes is delivered correctly in order to the application at B.</p>
<p>39<br>00:03:10,000 –&gt; 00:03:14,000<br>The stream of bytes is delivered by TCP segments.</p>
<p>40<br>00:03:14,000 –&gt; 00:03:22,000<br>A puts bytes from the stream into a TCP segment, hands it to the IP layer which delivers it to B.</p>
<p>41<br>00:03:22,000 –&gt; 00:03:30,000<br>The TCP layer at B extracts the bytes to recreate the byte stream and delivers them to the application at B.</p>
<p>42<br>00:03:30,000 –&gt; 00:03:38,000<br>In practice, the TCP segment may need to be transmitted multiple times, in the case a segment is dropped along the way or if A doesn’t receive an acknowledgement.</p>
<p>43<br>00:03:39,000 –&gt; 00:03:42,000<br>The TCP segment could be as small as one byte.</p>
<p>44<br>00:03:42,000 –&gt; 00:03:51,000<br>For example, if you’re typing characters in an SSH session, each character is sent one at a time rather than waiting for the whole segment to fill up.</p>
<p>45<br>00:03:51,000 –&gt; 00:03:59,000<br>This isn’t very efficient when we have lots of data to send, so we can fill the TCP segment all the way up to a maximum IP data ground size.</p>
<p>46<br>00:03:59,000 –&gt; 00:04:04,000<br>When A and B have finished sending data to each other, they need to close the connection.</p>
<p>47<br>00:04:04,000 –&gt; 00:04:13,000<br>We say they tear down the connection, which means they tell each other they are closing the connection and both ends can clean up the state associated with the state machine.</p>
<p>48<br>00:04:13,000 –&gt; 00:04:20,000<br>The TCP layer at host A can close the connection by sending a thin message, which is short for finish.</p>
<p>49<br>00:04:20,000 –&gt; 00:04:27,000<br>Host B acknowledges that A no longer has data to send and stops looking for new data from A.</p>
<p>50<br>00:04:27,000 –&gt; 00:04:30,000<br>This closes down the data stream from A to B.</p>
<p>51<br>00:04:31,000 –&gt; 00:04:37,000<br>But B might still have new data to send to A and is not ready to close down the channel from B to A yet.</p>
<p>52<br>00:04:37,000 –&gt; 00:04:43,000<br>So the message from B to A carrying the AC can also carry new data from B to A.</p>
<p>53<br>00:04:43,000 –&gt; 00:04:48,000<br>B can keep sending new data to A as long as it needs to.</p>
<p>54<br>00:04:48,000 –&gt; 00:04:57,000<br>Sometime later, B finishes sending data to A and now sends its own thin to tell A they can close the connection.</p>
<p>55<br>00:04:57,000 –&gt; 00:05:02,000<br>Host A replies by sending an AC to acknowledge that the connection is now closed.</p>
<p>56<br>00:05:02,000 –&gt; 00:05:09,000<br>Because both directions have finished, the connection is now fully closed and the state can be safely removed.</p>
<p>57<br>00:05:09,000 –&gt; 00:05:14,000<br>Here is a table summarizing the services provided by TCP.</p>
<p>58<br>00:05:14,000 –&gt; 00:05:18,000<br>The first three are services TCP provides to the application.</p>
<p>59<br>00:05:18,000 –&gt; 00:05:25,000<br>As we just saw, it provides a reliable stream of bytes between two applications.</p>
<p>60<br>00:05:25,000 –&gt; 00:05:29,000<br>TCP uses four mechanisms to make the communication reliable.</p>
<p>61<br>00:05:29,000 –&gt; 00:05:33,000<br>In other words, to make sure the data is correctly delivered.</p>
<p>62<br>00:05:33,000 –&gt; 00:05:40,000<br>When a TCP layer receives data, it sends an acknowledgement pack to the sender to let it know the data arrived correctly.</p>
<p>63<br>00:05:40,000 –&gt; 00:05:43,000<br>Check sums detect corrupted data.</p>
<p>64<br>00:05:43,000 –&gt; 00:05:48,000<br>The TCP header carries a checksum covering the header and the data inside the segment.</p>
<p>65<br>00:05:48,000 –&gt; 00:05:52,000<br>The checksum is there to detect if the segment is corrupted along the way.</p>
<p>66<br>00:05:52,000 –&gt; 00:05:57,000<br>For example, by a bit error on the wire or by a memory fault inside a router.</p>
<p>67<br>00:05:57,000 –&gt; 00:06:00,000<br>Sequence numbers detect missing data.</p>
<p>68<br>00:06:00,000 –&gt; 00:06:06,000<br>Every segment’s header carries the sequence number in the stream of bytes of the first byte in the segment.</p>
<p>69<br>00:06:06,000 –&gt; 00:06:14,000<br>For example, if the two sides agree that the sequence starts at 1000, then the first segment will have a sequence number of 1000.</p>
<p>70<br>00:06:14,000 –&gt; 00:06:21,000<br>If the segment carries 500 bytes of data, then the next segment will carry the sequence number 1500.</p>
<p>71<br>00:06:22,000 –&gt; 00:06:28,000<br>If a segment gets lost, then the sequence number will be incorrect, and the TCP layer knows some data is missing.</p>
<p>72<br>00:06:28,000 –&gt; 00:06:36,000<br>It is possible that we’ll show up later, perhaps it took a longer path, or it might have gone missing, in which case the sender will need to resend the data.</p>
<p>73<br>00:06:36,000 –&gt; 00:06:40,000<br>Flow control prevents overrunning the receiver.</p>
<p>74<br>00:06:40,000 –&gt; 00:06:50,000<br>If host A is much faster than host B, then it’s possible for host A to completely overwhelm host B by sending data so fast that host B can’t keep up.</p>
<p>75<br>00:06:50,000 –&gt; 00:06:55,000<br>TCP prevents this from happening using something we call flow control.</p>
<p>76<br>00:06:55,000 –&gt; 00:07:00,000<br>In TCP, the receiver keeps telling the sender if it can keep sending.</p>
<p>77<br>00:07:00,000 –&gt; 00:07:05,000<br>Specifically, it tells the sender how much room it has in its buffers to accept new data.</p>
<p>78<br>00:07:05,000 –&gt; 00:07:10,000<br>If host B is falling behind, the space drops, possibly all the way to zero.</p>
<p>79<br>00:07:10,000 –&gt; 00:07:15,000<br>When it has more room, it tells A and it can send more data.</p>
<p>80<br>00:07:15,000 –&gt; 00:07:20,000<br>TCP delivers data to the application in the right sequence.</p>
<p>81<br>00:07:20,000 –&gt; 00:07:30,000<br>In other words, whatever sequence the data was delivered from the application to TCP at host A, this is the same order in which it is sent from TCP to the application at B.</p>
<p>82<br>00:07:30,000 –&gt; 00:07:38,000<br>If segments arrive at B out of order, the TCP layer re-sequences them to the correct order using the sequence number.</p>
<p>83<br>00:07:38,000 –&gt; 00:07:44,000<br>Finally, TCP is the same order in which it is sent from TCP to the application at B.</p>
<p>84<br>00:07:44,000 –&gt; 00:07:49,000<br>Finally, TCP provides a service to the whole network by controlling congestion.</p>
<p>85<br>00:07:49,000 –&gt; 00:07:55,000<br>TCP tries to divide up the network capacity equally among all the TCP connections using the network.</p>
<p>86<br>00:07:55,000 –&gt; 00:08:05,000<br>The congestion control mechanisms in TCP are very complicated and will devote a whole of unit 4 to studying congestion control.</p>
<p>87<br>00:08:05,000 –&gt; 00:08:12,000<br>The TCP segment header is much longer and more complicated than say the IP and Ethernet headers.</p>
<p>88<br>00:08:12,000 –&gt; 00:08:16,000<br>That is because a TCP connection is reliable.</p>
<p>89<br>00:08:16,000 –&gt; 00:08:25,000<br>In order to make the communication reliable, the two ends of the connection need to exchange more information so they know which bytes have arrived, which are missing and the status of the connection.</p>
<p>90<br>00:08:25,000 –&gt; 00:08:29,000<br>Here’s a quick summary of the most important fields in the TCP header.</p>
<p>91<br>00:08:29,000 –&gt; 00:08:34,000<br>You don’t need to remember the layout of the header, but you should learn what each field does.</p>
<p>92<br>00:08:34,000 –&gt; 00:08:39,000<br>If you need a reference, I’d recommend Wikipedia or the Chrosie and Ross textbook.</p>
<p>93<br>00:08:40,000 –&gt; 00:08:47,000<br>The destination port tells the TCP layer which application the bytes should be delivered to at the other end.</p>
<p>94<br>00:08:47,000 –&gt; 00:08:53,000<br>When a new connection starts up, the application tells TCP which service to open a connection with.</p>
<p>95<br>00:08:53,000 –&gt; 00:08:59,000<br>For example, if TCP is carrying web data, it uses port 80, which is the port number for TCP.</p>
<p>96<br>00:08:59,000 –&gt; 00:09:07,000<br>You’ll learn more about port numbers later, but if you’re curious, you can look up the well-known port numbers at the IANA that’s spelled I-A-N-A website.</p>
<p>97<br>00:09:07,000 –&gt; 00:09:10,000<br>Search for IANA port numbers.</p>
<p>98<br>00:09:10,000 –&gt; 00:09:14,000<br>You’ll find thousands of port numbers defined for different well-known services.</p>
<p>99<br>00:09:14,000 –&gt; 00:09:19,000<br>For example, when we open a connection to an SSH server, we use destination port 22.</p>
<p>100<br>00:09:19,000 –&gt; 00:09:24,000<br>For SMTP, the simple mail transfer protocol, we use port 23.</p>
<p>101<br>00:09:24,000 –&gt; 00:09:31,000<br>Using a well-known port number lets host B identify the application it should establish the connection with.</p>
<p>102<br>00:09:32,000 –&gt; 00:09:38,000<br>The source port tells the TCP layer at the other end which port it should use to send data back again.</p>
<p>103<br>00:09:38,000 –&gt; 00:09:50,000<br>In our example, when host B replies to host A, it should place host A’s source port number in the destination port field, so that host A’s TCP layer can deliver the data to the correct application.</p>
<p>104<br>00:09:50,000 –&gt; 00:10:00,000<br>When a new application starts, the initiator of the connection, in our case, host A, generates a unique source port number.</p>
<p>105<br>00:10:00,000 –&gt; 00:10:07,000<br>To differentiate the connection from any other connections between host A and B to the same service.</p>
<p>106<br>00:10:07,000 –&gt; 00:10:13,000<br>The sequence number indicates the position in the byte stream of the first byte in the TCP data field.</p>
<p>107<br>00:10:13,000 –&gt; 00:10:20,000<br>For example, if the initial sequence number is 1000 and this is the first segment, then the sequence number is 1000.</p>
<p>108<br>00:10:20,000 –&gt; 00:10:25,000<br>The acknowledgement sequence number tells the other end which byte we’re expecting next.</p>
<p>109<br>00:10:25,000 –&gt; 00:10:31,000<br>It also says that we’ve successfully received every byte up until the one before this byte number.</p>
<p>110<br>00:10:31,000 –&gt; 00:10:40,000<br>So for example, if the acknowledgement sequence number is 751, it means we’ve received every byte up to an including byte 750.</p>
<p>111<br>00:10:40,000 –&gt; 00:10:51,000<br>Notice that there are sequence numbers for both directions in every segment, this way TCPP backs acknowledgments on the data segments travelling in the other direction.</p>
<p>112<br>00:10:51,000 –&gt; 00:10:58,000<br>The 16 bits checksum is calculated over the entire header and data and helps the receiver detect corrupt data.</p>
<p>113<br>00:10:58,000 –&gt; 00:11:02,000<br>For example, bit errors on the wire or a faulty memory in a router.</p>
<p>114<br>00:11:02,000 –&gt; 00:11:08,000<br>You’ll learn more about error detection and checksums in a later video.</p>
<p>115<br>00:11:08,000 –&gt; 00:11:13,000<br>The header length field, the one on the far left, tells us how long the TCP header is.</p>
<p>116<br>00:11:13,000 –&gt; 00:11:18,000<br>The TCP options fields are, well, optional.</p>
<p>117<br>00:11:18,000 –&gt; 00:11:24,000<br>They carry extra new header fields that were thought of and added after the TCP standard was created.</p>
<p>118<br>00:11:24,000 –&gt; 00:11:30,000<br>The header length field tells us how many option fields are present. Usually there are none.</p>
<p>119<br>00:11:30,000 –&gt; 00:11:36,000<br>Finally, there are a bunch of flags used to signal information from one end of the connection to the other.</p>
<p>120<br>00:11:36,000 –&gt; 00:11:43,000<br>The act flag tells us that the acknowledgement sequence number is valid and we’re acknowledging all of the data up until this point.</p>
<p>121<br>00:11:43,000 –&gt; 00:11:49,000<br>The sin flag tells us that we are signaling a synchronize, which is part of the three-way handshake to set up a connection.</p>
<p>122<br>00:11:49,000 –&gt; 00:11:54,000<br>And the sin flag signals the closing of one direction of the connection.</p>
<p>123<br>00:11:54,000 –&gt; 00:12:03,000<br>Finally, the push flag, PSH, tells us the TCP layer at the other end to deliver the data immediately upon arrival, rather than wait for more data.</p>
<p>124<br>00:12:03,000 –&gt; 00:12:09,000<br>This is useful for sending short segments carrying time-critical data, such as a keystroke.</p>
<p>125<br>00:12:09,000 –&gt; 00:12:15,000<br>We don’t want the TCP layer to wait to accumulate many keystrokes before delivering them to the application.</p>
<p>126<br>00:12:15,000 –&gt; 00:12:22,000<br>A TCP connection is uniquely identified by five pieces of information in the TCP and IP headers.</p>
<p>127<br>00:12:22,000 –&gt; 00:12:32,000<br>The IP source and destination address uniquely identify the endpoints, and the IP protocol ID for TCP tells us the connection is TCP.</p>
<p>128<br>00:12:33,000 –&gt; 00:12:38,000<br>The TCP source and destination ports identify the application processes on the end hosts.</p>
<p>129<br>00:12:38,000 –&gt; 00:12:46,000<br>Together, at any instant, all five fields uniquely identify the TCP connection internet-wide.</p>
<p>130<br>00:12:46,000 –&gt; 00:12:50,000<br>Now, the unique ID only holds a few things hold.</p>
<p>131<br>00:12:50,000 –&gt; 00:12:57,000<br>First, we need to make sure Host A, the initiator of the connection, picks a unique source port ID.</p>
<p>132<br>00:12:57,000 –&gt; 00:13:05,000<br>We need to make sure it doesn’t accidentally pick the same source port number it already used with another connection to the same service on Host B.</p>
<p>133<br>00:13:05,000 –&gt; 00:13:12,000<br>Host A uses a simple method to minimise the chances. It increments the source port number for every new connection.</p>
<p>134<br>00:13:12,000 –&gt; 00:13:19,000<br>The field is 16 bits, so it takes 64k new connections before the new field grabs around.</p>
<p>135<br>00:13:20,000 –&gt; 00:13:31,000<br>There’s also a very slight danger that if Host A suddenly creates a lot of new connections to Host B, it might still wrap around and try to create two connections with the same global ID.</p>
<p>136<br>00:13:31,000 –&gt; 00:13:36,000<br>If this happened, the bytes from one connection might become confused with the bytes from another connection.</p>
<p>137<br>00:13:36,000 –&gt; 00:13:46,000<br>This could happen, for example, if a TCP segment somehow lived for a very long time in the network, stuck inside a router buffer or circulating in a temporary loop.</p>
<p>138<br>00:13:46,000 –&gt; 00:13:54,000<br>To reduce the chances of confusion, TCP connections initialise with a random initial sequence number to refer to bytes in the bytes stream.</p>
<p>139<br>00:13:54,000 –&gt; 00:13:59,000<br>While not totally foolproof, it does reduce the chances of confusion.</p>
<p>140<br>00:13:59,000 –&gt; 00:14:07,000<br>When Host A initiates the connection to B, it includes the initial sequence number it will use in the stream of bytes from A to B.</p>
<p>141<br>00:14:07,000 –&gt; 00:14:19,000<br>When B replies and initiates the connection from B to A, it supplies its own sequence number, initial sequence number from the stream of bytes from B to A.</p>
<p>142<br>00:14:22,000 –&gt; 00:14:33,000<br>To summarise how sequence numbers work, the sequence number in a segment from A to B includes the sequence number of the first byte, offset by the initial sequence number.</p>
<p>143<br>00:14:34,000 –&gt; 00:14:45,000<br>The acknowledgement sequence number in the segment from B back to A tells us which byte B is expecting next, offset by A’s initial sequence number.</p>
<p>144<br>00:14:47,000 –&gt; 00:14:50,000<br>Let’s summarise how TCP port numbers work.</p>
<p>145<br>00:14:50,000 –&gt; 00:14:57,000<br>Imagine the host that host B on the right offers two services, a web server and a mail server.</p>
<p>146<br>00:14:58,000 –&gt; 00:15:07,000<br>When the web client, for example a Chrome browser on host A, wants to request a page from the web server on B, it sends the data to TCP.</p>
<p>147<br>00:15:07,000 –&gt; 00:15:13,000<br>We’ll assume TCP has already established a connection with B, so now it just needs to send the data.</p>
<p>148<br>00:15:13,000 –&gt; 00:15:20,000<br>It creates a segment and uses destination port 80 to tell B it is requesting the data to be sent to the web server.</p>
<p>149<br>00:15:21,000 –&gt; 00:15:27,000<br>Host A uses a locally generated source port number for B to use when sending data and acknowledgments back again.</p>
<p>150<br>00:15:29,000 –&gt; 00:15:34,000<br>As usual, the TCP segment is encapsulated into an IP datagram and sent to B.</p>
<p>151<br>00:15:36,000 –&gt; 00:15:41,000<br>The IP and TCP headers carry the unique ID of the TCP connection internet-wide.</p>
<p>152<br>00:15:42,000 –&gt; 00:15:47,000<br>When the IP datagram arrives at B, the TCP segment is removed.</p>
<p>153<br>00:15:47,000 –&gt; 00:15:53,000<br>The TCP layer sees that the segment is for port 80 and sends the data to the web server.</p>
<p>154<br>00:15:54,000 –&gt; 00:15:56,000<br>The TCP sliding window.</p>
<p>155<br>00:15:57,000 –&gt; 00:16:00,000<br>You’ll learn about other TCP features in upcoming videos.</p>
<p>156<br>00:16:00,000 –&gt; 00:16:05,000<br>You’ll learn about window-based flow control to stop us from overwhelming the receiver.</p>
<p>157<br>00:16:06,000 –&gt; 00:16:11,000<br>You’ll learn about retransmission and timeouts and different mechanisms to accomplish it.</p>
<p>158<br>00:16:12,000 –&gt; 00:16:15,000<br>And you’ll learn about congestion control in Unit 4.</p>
<p>159<br>00:16:16,000 –&gt; 00:16:25,000<br>So, in summary, TCP provides in order reliable delivery of a stream of bytes between application processes.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>CS144 NetworkP232 1TCPservicemodel</div>
      <div>http://example.com/2025/10/23/CS144-networkP232-1TCPservicemodel/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年10月23日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/10/23/CS144-networkP262-4EndtoEndPrinciple/" title="CS144 NetworkP262 4EndtoEndPrinciple">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">CS144 NetworkP262 4EndtoEndPrinciple</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/10/23/CS144-networkP211-12TheInternetandIPRecap/" title="CS144 NetworkP211 12TheInternetandIPRecap">
                        <span class="hidden-mobile">CS144 NetworkP211 12TheInternetandIPRecap</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
