

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="title: CS144-networkP41-3TheIPservicemodel.md100:00:00,000 –&gt; 00:00:05,000Now that you’ve learned about the four-layer internet model, we’re going to focus on the network layer. 200:00:05,000 –&amp;gt">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2025/10/23/CS144-networkP41-3TheIPservicemodel/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="title: CS144-networkP41-3TheIPservicemodel.md100:00:00,000 –&gt; 00:00:05,000Now that you’ve learned about the four-layer internet model, we’re going to focus on the network layer. 200:00:05,000 –&amp;gt">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-10-23T00:14:54.455Z">
<meta property="article:modified_time" content="2025-10-23T00:16:17.179Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text=""></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-10-23 08:14" pubdate>
          2025年10月23日 早上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          1.8k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          15 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header"></h1>
            
            
              <div class="markdown-body">
                
                <hr>
<h2 id="title-CS144-networkP41-3TheIPservicemodel-md"><a href="#title-CS144-networkP41-3TheIPservicemodel-md" class="headerlink" title="title: CS144-networkP41-3TheIPservicemodel.md"></a>title: CS144-networkP41-3TheIPservicemodel.md</h2><p>1<br>00:00:00,000 –&gt; 00:00:05,000<br>Now that you’ve learned about the four-layer internet model, we’re going to focus on the network layer.</p>
<p>2<br>00:00:05,000 –&gt; 00:00:10,000<br>This is the most important layer of the internet. In fact, to many people, it is the internet.</p>
<p>3<br>00:00:10,000 –&gt; 00:00:16,000<br>Whenever we use the internet, we’re required to use the internet protocol to send and receive our packets.</p>
<p>4<br>00:00:16,000 –&gt; 00:00:20,000<br>You’ll remember that we say that each layer provides a service to the layer above.</p>
<p>5<br>00:00:20,000 –&gt; 00:00:25,000<br>In order to correctly use a layer, we need a good understanding of the service that it provides.</p>
<p>6<br>00:00:25,000 –&gt; 00:00:30,000<br>Therefore, in this video, I’m going to walk through the service provided by the internet protocol.</p>
<p>7<br>00:00:30,000 –&gt; 00:00:41,000<br>IP datagrams consist of a header and some data. When the transport layer has data to send, it hands a transport segment to the network layer below.</p>
<p>8<br>00:00:41,000 –&gt; 00:00:47,000<br>The network layer puts the transport segment inside a new IP datagram that it creates.</p>
<p>9<br>00:00:47,000 –&gt; 00:00:51,000<br>IP’s job is to deliver the datagram to the other end of the internet.</p>
<p>10<br>00:00:51,000 –&gt; 00:00:58,000<br>But first, the IP datagram has to make it over the first link to the first router.</p>
<p>11<br>00:00:58,000 –&gt; 00:01:07,000<br>So, IP sends the datagram to the link layer that puts it inside a link frame, such as an ethernet packet, and then ships it off to the first router.</p>
<p>12<br>00:01:07,000 –&gt; 00:01:12,000<br>The IP service can be characterised by four properties listed here.</p>
<p>13<br>00:01:12,000 –&gt; 00:01:18,000<br>It sends datagrams from end host to end host. It is unreliable, but makes the best effort to deliver the datagrams.</p>
<p>14<br>00:01:18,000 –&gt; 00:01:22,000<br>The network maintains no per-flow state associated with the datagrams.</p>
<p>15<br>00:01:22,000 –&gt; 00:01:27,000<br>Let’s take a look at each one of these in turn as listed in the table.</p>
<p>16<br>00:01:27,000 –&gt; 00:01:36,000<br>First, IP is a datagram service. When we ask IP to send some data for us, it creates a datagram and puts our data inside.</p>
<p>17<br>00:01:36,000 –&gt; 00:01:42,000<br>The datagram is a packet that is routed individually through the network based on the information in its header.</p>
<p>18<br>00:01:42,000 –&gt; 00:01:45,000<br>In other words, the datagram itself contained.</p>
<p>19<br>00:01:45,000 –&gt; 00:01:58,000<br>The header contains the IP address of the destination, which we abbreviate here as IPDA for IP destination address, and the forwarding decision at each router is based on this IPDA.</p>
<p>20<br>00:01:58,000 –&gt; 00:02:08,000<br>The datagram header also contains an IP source address, or IPSA, saying where the packet came from, so the receiver knows where to send any response.</p>
<p>21<br>00:02:09,000 –&gt; 00:02:17,000<br>Datagrams are routed hot by hot through the network from one router to the next, all the way from the IP source address to the IP destination address.</p>
<p>22<br>00:02:17,000 –&gt; 00:02:28,000<br>We’ll learn more about how routers work later, but for now, it’s enough to know that each router contains a forwarding table that tells it where to send packets next after it matches a given destination address.</p>
<p>23<br>00:02:28,000 –&gt; 00:02:37,000<br>The router doesn’t know the whole path. It simply uses the destination address to index into its own forwarding table so that it can forward the packet to the next hop along the path.</p>
<p>24<br>00:02:37,000 –&gt; 00:02:49,000<br>Hop by pop, step by step, the packet makes its way from the source to the destination using only the destination address in the datagram.</p>
<p>25<br>00:02:49,000 –&gt; 00:02:56,000<br>You’ll often hear the analogy made between how IP datagrams are routed and how letters are routed by the postal service.</p>
<p>26<br>00:02:56,000 –&gt; 00:03:04,000<br>It’s a good analogy. In the postal service, we put a letter into the mailbox with the address of the destination, and the letter is routed, invisibly to us.</p>
<p>27<br>00:03:05,000 –&gt; 00:03:09,000<br>Hop by hop from sorting office to sorting office until it reaches its destination.</p>
<p>28<br>00:03:09,000 –&gt; 00:03:17,000<br>Now the sender or the receiver know, or need to know, the path taken by the letters in the postal service, or by datagrams in the internet.</p>
<p>29<br>00:03:17,000 –&gt; 00:03:22,000<br>The IP service model provides a service which includes the routing to the destination.</p>
<p>30<br>00:03:22,000 –&gt; 00:03:33,000<br>The second aspect of the IP service model, and perhaps most surprisingly, is IP is unreliable.</p>
<p>31<br>00:03:33,000 –&gt; 00:03:41,000<br>IP makes no promise that packets will be delivered to the destination. They could be delivered late, out of sequence, or never delivered at all.</p>
<p>32<br>00:03:41,000 –&gt; 00:03:46,000<br>It’s possible that a packet will be duplicated along the way, for example, by a misbehaving router.</p>
<p>33<br>00:03:46,000 –&gt; 00:03:52,000<br>The key thing to remember is that IP is unreliable and makes no guarantees.</p>
<p>34<br>00:03:52,000 –&gt; 00:04:00,000<br>But it won’t drop datagrams arbitrarily just because it feels like it. That’s if you believe networks have feelings.</p>
<p>35<br>00:04:00,000 –&gt; 00:04:05,000<br>IP does make the promise to only drop datagrams if necessary.</p>
<p>36<br>00:04:05,000 –&gt; 00:04:11,000<br>For example, the packet queue in a router might fill up because of congestion, forcing the router to drop the next arriving packet.</p>
<p>37<br>00:04:12,000 –&gt; 00:04:18,000<br>IP won’t make any attempt to resend the data. In fact, IP doesn’t even tell the source that the packet was dropped.</p>
<p>38<br>00:04:18,000 –&gt; 00:04:25,000<br>Similarly, a faulty routing table might cause a packet to be sent to the wrong destination, or cause a packet to be duplicated by mistake.</p>
<p>39<br>00:04:25,000 –&gt; 00:04:30,000<br>IP doesn’t make any promises that these errors won’t happen, nor does it detect them when they do.</p>
<p>40<br>00:04:30,000 –&gt; 00:04:37,000<br>But IP does make the promise to only make these errors and drop packets when necessary.</p>
<p>41<br>00:04:37,000 –&gt; 00:04:42,000<br>In fact, the IP datagram service is very much like the basic postal service.</p>
<p>42<br>00:04:42,000 –&gt; 00:04:46,000<br>The basic postal service makes no promise that our letters will be delivered on time,</p>
<p>43<br>00:04:46,000 –&gt; 00:04:52,000<br>or that if we send two or three letters back to back on consecutive days, that they’ll be received in the order they were sent.</p>
<p>44<br>00:04:52,000 –&gt; 00:04:59,000<br>And it makes no promise that they’ll be delivered at all, unless we pay for a more expensive end-to-end service to guarantee delivery.</p>
<p>45<br>00:04:59,000 –&gt; 00:05:04,000<br>Really, when it comes down to it, IP is an extremely simple, minimal service.</p>
<p>46<br>00:05:04,000 –&gt; 00:05:07,000<br>It maintains no state at all related to a communication.</p>
<p>47<br>00:05:07,000 –&gt; 00:05:16,000<br>We say that a communication service is connectionless, because it doesn’t start by establishing some end-to-end state associated with a communication.</p>
<p>48<br>00:05:16,000 –&gt; 00:05:22,000<br>In other words, when we make a Skype call, lasting several minutes and consisting of many IP datagrams,</p>
<p>49<br>00:05:22,000 –&gt; 00:05:30,000<br>the IP layer maintains no knowledge of the call, and simply routes each datagram individually and independently of all the others.</p>
<p>50<br>00:05:34,000 –&gt; 00:05:37,000<br>You might be wondering why the IP service is so simple.</p>
<p>51<br>00:05:37,000 –&gt; 00:05:41,000<br>After all, it is the foundation of the entire internet.</p>
<p>52<br>00:05:41,000 –&gt; 00:05:46,000<br>Every communication of the internet uses must use the IP service.</p>
<p>53<br>00:05:46,000 –&gt; 00:05:52,000<br>Given how important the internet is, wouldn’t it have been better to make IP reliable?</p>
<p>54<br>00:05:52,000 –&gt; 00:05:57,000<br>After all, we did say that most applications want a reliable byte communication service.</p>
<p>55<br>00:05:57,000 –&gt; 00:06:03,000<br>There are several reasons the IP service model was designed to be so simple.</p>
<p>56<br>00:06:04,000 –&gt; 00:06:08,000<br>First, to keep the network simple, dumb, and minimal.</p>
<p>57<br>00:06:08,000 –&gt; 00:06:12,000<br>Faster, more streamlined, and lower cost to build and maintain.</p>
<p>58<br>00:06:12,000 –&gt; 00:06:18,000<br>It was believed that if the network is kept simple, with very few features and requirements,</p>
<p>59<br>00:06:18,000 –&gt; 00:06:22,000<br>then packets could be delivered very quickly and at low cost to the destination.</p>
<p>60<br>00:06:22,000 –&gt; 00:06:27,000<br>The thinking was that a simple network could be made to run very fast using dedicated hardware,</p>
<p>61<br>00:06:28,000 –&gt; 00:06:33,000<br>and given that the network is implemented by a large number of arousers scattered throughout the network across the world,</p>
<p>62<br>00:06:33,000 –&gt; 00:06:40,000<br>if they could be kept simple, then they are more likely to be reliable, more affordable, easier to maintain,</p>
<p>63<br>00:06:40,000 –&gt; 00:06:44,000<br>and will need to be upgraded less often.</p>
<p>64<br>00:06:44,000 –&gt; 00:06:47,000<br>Second is the end to end principle.</p>
<p>65<br>00:06:47,000 –&gt; 00:06:53,000<br>The end to end principle states that where possible, implement features in the end hosts.</p>
<p>66<br>00:06:54,000 –&gt; 00:07:00,000<br>In the design of communication systems such as the internet, there’s a well-known principle called the end to end principle</p>
<p>67<br>00:07:00,000 –&gt; 00:07:05,000<br>that says if you can correctly implement features at the end points, then you should.</p>
<p>68<br>00:07:05,000 –&gt; 00:07:14,000<br>We’ll study the end to end principle in more depth in later videos, but the basic idea is to place as much intelligence as possible at the end points,</p>
<p>69<br>00:07:14,000 –&gt; 00:07:17,000<br>in our case the source and destination computers.</p>
<p>70<br>00:07:17,000 –&gt; 00:07:22,000<br>This can have several advantages, such as making sure the feature is implemented correctly for the application,</p>
<p>71<br>00:07:22,000 –&gt; 00:07:27,000<br>and it’s easier to evolve and improve a feature if it’s implemented in software on end computers,</p>
<p>72<br>00:07:27,000 –&gt; 00:07:31,000<br>rather than baked into the hardware of the internet.</p>
<p>73<br>00:07:31,000 –&gt; 00:07:36,000<br>In the case of the internet, it was decided that features such as reliable communications and controlling congestion</p>
<p>74<br>00:07:36,000 –&gt; 00:07:42,000<br>should be done at the end points by the source and destination computers and not by the network.</p>
<p>75<br>00:07:42,000 –&gt; 00:07:47,000<br>At the time, it was quite a radical suggestion and very different design choice from the telephone system,</p>
<p>76<br>00:07:47,000 –&gt; 00:07:52,000<br>the largest existing network at the time, which was originally built on the idea of simple handsets</p>
<p>77<br>00:07:52,000 –&gt; 00:07:56,000<br>and a complicated feature rich network of telephone switches.</p>
<p>78<br>00:07:56,000 –&gt; 00:08:02,000<br>In later videos, we’ll be studying the end to end principle as one of the important architectural principles of communication systems.</p>
<p>79<br>00:08:02,000 –&gt; 00:08:05,000<br>We’ll see many examples of the end to end principle in action.</p>
<p>80<br>00:08:05,000 –&gt; 00:08:14,000<br>For example, when we study the transport layer, we’ll see how the end hosts build a reliable communication service over the unreliable IP network service.</p>
<p>81<br>00:08:18,000 –&gt; 00:08:27,000<br>A simple IP service also allows a variety of reliable or unreliable services to be built on top.</p>
<p>82<br>00:08:27,000 –&gt; 00:08:36,000<br>If IP was reliable, in other words, if any missing packets were retransmitted automatically, then it would not be ideal for some services.</p>
<p>83<br>00:08:36,000 –&gt; 00:08:43,000<br>For example, in real-time applications like a video chat, there might be no point in retransmitting lost data,</p>
<p>84<br>00:08:43,000 –&gt; 00:08:46,000<br>because it might arrive too late to be useful.</p>
<p>85<br>00:08:46,000 –&gt; 00:08:52,000<br>Instead, the application might choose to show a few blank pixels or use the pixels from the frame before.</p>
<p>86<br>00:08:52,000 –&gt; 00:08:59,000<br>By not providing any reliability guarantees, IP lets the application choose the reliability service it needs.</p>
<p>87<br>00:09:03,000 –&gt; 00:09:09,000<br>Finally, IP works over any link layer. IP makes very few assumptions about the link layer.</p>
<p>88<br>00:09:10,000 –&gt; 00:09:14,000<br>IP makes very little expectation at all of the link layer below.</p>
<p>89<br>00:09:14,000 –&gt; 00:09:18,000<br>The link could be wired or wireless and requires no retransmission or control of congestion.</p>
<p>90<br>00:09:18,000 –&gt; 00:09:25,000<br>Some people have said IP is so simple and makes so few assumptions about the underlying link layer that you could run IP over carrier pigeons.</p>
<p>91<br>00:09:25,000 –&gt; 00:09:28,000<br>In fact, there’s even an internet standard telling you how to do it.</p>
<p>92<br>00:09:29,000 –&gt; 00:09:36,000<br>Making IP run over any link layer made sense, because the internet was created specifically to interconnect existing networks.</p>
<p>93<br>00:09:37,000 –&gt; 00:09:39,000<br>In fact, that’s why it was called the internet.</p>
<p>94<br>00:09:44,000 –&gt; 00:09:52,000<br>In addition to the basic, unreliable, best-effort connectionless data-gram service, IP also provides a few other carefully chosen services.</p>
<p>95<br>00:09:52,000 –&gt; 00:09:59,000<br>The designers of IP tried very hard to find a balance between providing the bear minimum needed to make communications work,</p>
<p>96<br>00:09:59,000 –&gt; 00:10:04,000<br>while not providing such a bear bone service that it doesn’t really work at all.</p>
<p>97<br>00:10:05,000 –&gt; 00:10:10,000<br>I’m going to describe five features here, and you’ll learn about each one of these features in later videos.</p>
<p>98<br>00:10:10,000 –&gt; 00:10:17,000<br>So I won’t go into a lot of details here, but I will briefly describe each one so you can understand the scope of the complete IP service.</p>
<p>99<br>00:10:18,000 –&gt; 00:10:22,000<br>First, IP tries to prevent packets from looping forever.</p>
<p>100<br>00:10:22,000 –&gt; 00:10:33,000<br>Because IP routers forward packets hop by hop across the internet, it is possible for the forwarding table in a router to be wrong, causing a pocket packet to start looping round and around following the same path.</p>
<p>101<br>00:10:35,000 –&gt; 00:10:41,000<br>This is most likely to happen when the forwarding tables are changing, and they temporarily get into an inconsistent state.</p>
<p>102<br>00:10:41,000 –&gt; 00:10:46,000<br>Rather than try to prevent loops from ever happening, which would take a lot of complexity,</p>
<p>103<br>00:10:46,000 –&gt; 00:10:52,000<br>IP uses a very simple mechanism to catch and then delete packets that appear to be stuck in a loop.</p>
<p>104<br>00:10:52,000 –&gt; 00:10:57,000<br>To do this, IP simply adds a hop count field in the header of every data-gram.</p>
<p>105<br>00:10:58,000 –&gt; 00:11:01,000<br>It’s called the Time to Live or TTL field.</p>
<p>106<br>00:11:01,000 –&gt; 00:11:07,000<br>It starts out at a number like 128, and then it’s decremented by every router it passes through.</p>
<p>107<br>00:11:07,000 –&gt; 00:11:13,000<br>If it reaches zero, IP concludes that it must be stuck in a loop, and the router drops the data-gram.</p>
<p>108<br>00:11:13,000 –&gt; 00:11:16,000<br>It’s a simple mechanism, typical of IP.</p>
<p>109<br>00:11:16,000 –&gt; 00:11:23,000<br>It doesn’t guarantee that loops won’t happen. It just tries to limit the damage caused by a flood of endlessly looping packets in the network.</p>
<p>110<br>00:11:27,000 –&gt; 00:11:30,000<br>IP will fragment packets if they are too long.</p>
<p>111<br>00:11:32,000 –&gt; 00:11:34,000<br>IP is designed to run over any kind of link.</p>
<p>112<br>00:11:34,000 –&gt; 00:11:37,000<br>Most links have a limit on the size of the packets that they can carry.</p>
<p>113<br>00:11:37,000 –&gt; 00:11:42,000<br>For example, Ethernet can only carry packets shorter than 1,500 bytes.</p>
<p>114<br>00:11:42,000 –&gt; 00:11:50,000<br>If an application has more than 1,500 bytes to send, it has to be broken into 1,500 byte pieces before sending in an IP data-gram.</p>
<p>115<br>00:11:51,000 –&gt; 00:11:58,000<br>Now along the path towards the destination, a 1,500 byte data-gram might need to go over a link that can only carry smaller packets.</p>
<p>116<br>00:11:58,000 –&gt; 00:12:00,000<br>Let’s say 1,000 bytes long.</p>
<p>117<br>00:12:00,000 –&gt; 00:12:06,000<br>The router connecting the two links will fragment the data into two smaller data-grams.</p>
<p>118<br>00:12:06,000 –&gt; 00:12:14,000<br>IP provides some header fields that we’ll see in a minute to help the router fragment the data-gram into two self-contained IP data-grams,</p>
<p>119<br>00:12:14,000 –&gt; 00:12:19,000<br>while providing the information the in-host needs to correctly reassemble the data again.</p>
<p>120<br>00:12:21,000 –&gt; 00:12:28,000<br>IP uses a header check sum to reduce the chances of delivering a data-gram to the wrong destination.</p>
<p>121<br>00:12:28,000 –&gt; 00:12:35,000<br>IP includes a check sum field in the data-gram header to try and make sure that data-grams are delivered to the right location.</p>
<p>122<br>00:12:35,000 –&gt; 00:12:43,000<br>It could be quite a security problem if packets are accidentally and frequently sent to the wrong place because of a mistake by a router along the way.</p>
<p>123<br>00:12:44,000 –&gt; 00:12:49,000<br>Fourth, there are two versions of IP in used today.</p>
<p>124<br>00:12:49,000 –&gt; 00:12:53,000<br>IPv4, which is used today by over 90% of end hosts.</p>
<p>125<br>00:12:53,000 –&gt; 00:12:57,000<br>It uses the 32-bit addresses you’re probably familiar with.</p>
<p>126<br>00:12:57,000 –&gt; 00:13:06,000<br>Because we’re running out of IPv4 addresses, the internet is in a gradual transition to IPv6, which uses 128-bit addresses instead.</p>
<p>127<br>00:13:06,000 –&gt; 00:13:11,000<br>You’ll be learning about the details of IPv4 and IPv6 in later videos.</p>
<p>128<br>00:13:12,000 –&gt; 00:13:16,000<br>Finally, IP allows new fields to be added to the data-gram header.</p>
<p>129<br>00:13:17,000 –&gt; 00:13:20,000<br>In practice, this is a bit of a mixed blessing.</p>
<p>130<br>00:13:20,000 –&gt; 00:13:27,000<br>On the one hand, it allows new features to be added to the header that turn out to be important, but weren’t in the original standard.</p>
<p>131<br>00:13:27,000 –&gt; 00:13:36,000<br>On the other hand, these fields need processing, and so require extra features in the routers along the path, breaking the goal of a simple, dumb, minimal, forwarding path.</p>
<p>132<br>00:13:36,000 –&gt; 00:13:40,000<br>In practice, very few options are used or processed by the routers.</p>
<p>133<br>00:13:42,000 –&gt; 00:13:48,000<br>I’m now going to show you the IPv4 header and explain what all the fields do.</p>
<p>134<br>00:13:48,000 –&gt; 00:13:52,000<br>I don’t need you to remember where all the fields are.</p>
<p>135<br>00:13:52,000 –&gt; 00:14:02,000<br>I don’t remember all the locations myself, but I do want you to know what each field does, because it helps you understand the scope of the IP service model.</p>
<p>136<br>00:14:02,000 –&gt; 00:14:10,000<br>It should help cement your understanding and make it really clear that IP doesn’t do a lot. It’s a deliberately simple service.</p>
<p>137<br>00:14:11,000 –&gt; 00:14:15,000<br>Here’s a picture of an IPv4 header, which is the most common header in use today.</p>
<p>138<br>00:14:15,000 –&gt; 00:14:23,000<br>I’ve drawn it here in 32-bit words with bit 0, the first to be sent under the wire, up in the top left-hand corner.</p>
<p>139<br>00:14:23,000 –&gt; 00:14:29,000<br>The shaded portion is the IPv4 header. It’s followed by the data.</p>
<p>140<br>00:14:30,000 –&gt; 00:14:41,000<br>The most important fields in the IP header are the destination IP address, the source IP address, the protocol ID, that tells us what’s inside the data field.</p>
<p>141<br>00:14:41,000 –&gt; 00:14:49,000<br>Essentially, it allows the destination host to demultiplex arriving data, sending them to the correct code to process the packet.</p>
<p>142<br>00:14:49,000 –&gt; 00:14:56,000<br>If the protocol ID has the value 6, for example, then it tells us that the data contains a TCP segment.</p>
<p>143<br>00:14:57,000 –&gt; 00:15:04,000<br>So we can safely pass the datagram to the TCP code, and it will be able to pass the segment correctly.</p>
<p>144<br>00:15:04,000 –&gt; 00:15:14,000<br>The Internet Assign Numbers Authority, IANA, defines over 140 different values of protocol ID, representing different transport protocols.</p>
<p>145<br>00:15:14,000 –&gt; 00:15:23,000<br>The version field tells us which version of IP we’re using. Currently, the legal values are IPv4 and IPv6.</p>
<p>146<br>00:15:23,000 –&gt; 00:15:28,000<br>This header is an IPv4 header. We’ll see IPv6 headers in a later video.</p>
<p>147<br>00:15:28,000 –&gt; 00:15:35,000<br>The total packet length can be up to 64 kilobytes, including the header and all the data.</p>
<p>148<br>00:15:35,000 –&gt; 00:15:41,000<br>The time to live or TTL field helps us to prevent packets accidentally looping in the network forever.</p>
<p>149<br>00:15:41,000 –&gt; 00:15:48,000<br>Every router is required to decrement the TTL field. If it reaches 0, the router should drop the packet.</p>
<p>150<br>00:15:48,000 –&gt; 00:15:55,000<br>This way, when the source sends the packet with a fixed TTL value, it’s guaranteed to be destroyed by a router if it starts to travel in loops.</p>
<p>151<br>00:15:59,000 –&gt; 00:16:03,000<br>Sometimes, a packet is too long for the link it is about to be sent on.</p>
<p>152<br>00:16:03,000 –&gt; 00:16:12,000<br>The packet ID, flags and fragment offset all help routers to fragment IP packets into smaller self-contained datagrams, if need be.</p>
<p>153<br>00:16:12,000 –&gt; 00:16:15,000<br>We’ll learn how fragmentation works in a later video.</p>
<p>154<br>00:16:16,000 –&gt; 00:16:21,000<br>The type of service field gives a hint to routers about how important this packet is.</p>
<p>155<br>00:16:21,000 –&gt; 00:16:29,000<br>The header length tells us how big the header is. Some headers have optional extra fields to carry extra information.</p>
<p>156<br>00:16:29,000 –&gt; 00:16:39,000<br>Finally, a check sum is calculated over the whole header, so just in case the header is corrupted, we’re not likely to deliver a packet to the wrong destination by mistake.</p>
<p>157<br>00:16:40,000 –&gt; 00:16:47,000<br>In summary, IP is very important. We use it every time we send and receive packets in the internet.</p>
<p>158<br>00:16:48,000 –&gt; 00:16:59,000<br>IP provides a deliberately simple service. It is a simple, thumb, minimal service with four main features. It sends datagrams, hop by hop across the internet.</p>
<p>159<br>00:16:59,000 –&gt; 00:17:05,000<br>The service is unreliable and best effort. There’s no per-flow state making the protocol connectious.</p>
<p>160<br>00:17:06,000 –&gt; 00:17:15,000<br>At this point, you should feel comfortable with what the IP protocol is, what its service model is and how it fits into the internet for layer hierarchy.</p>
<p>161<br>00:17:15,000 –&gt; 00:17:21,000<br>If you have doubts, I suggest you re-watch this video and the one before it on the four layer model.</p>
<p>162<br>00:17:21,000 –&gt; 00:17:26,000<br>You’ll also find lots of good references about how IPv4 works.</p>
<p>163<br>00:17:26,000 –&gt; 00:17:33,000<br>Any good networking textbook will devote considerable space to explaining what IP is and why it was designed this way.</p>
<p>164<br>00:17:33,000 –&gt; 00:17:38,000<br>For example, chapter 4 of the sixth edition of Computer Networking a Top Down Approach by Currician Russ.</p>
<p>165<br>00:17:38,000 –&gt; 00:17:41,000<br>You’ll also find a brief explanation on Wikipedia.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div></div>
      <div>http://example.com/2025/10/23/CS144-networkP41-3TheIPservicemodel/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年10月23日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/10/23/CS144-networkP413-3PacketSwitching/" title="">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile"></span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/10/23/CS144-networkP403-2PacketSwitching/" title="">
                        <span class="hidden-mobile"></span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
