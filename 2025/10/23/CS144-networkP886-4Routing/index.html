

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="100:00:00,000 –&gt; 00:00:05,339Now that we’ve learned about the basics of routing, flooding, shortest paths, spanning trees, and so on, 200:00:05,339 –&gt; 00:00:12,780and we’ve also learned about th">
<meta property="og:type" content="article">
<meta property="og:title" content="CS144 NetworkP886 4Routing">
<meta property="og:url" content="http://example.com/2025/10/23/CS144-networkP886-4Routing/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="100:00:00,000 –&gt; 00:00:05,339Now that we’ve learned about the basics of routing, flooding, shortest paths, spanning trees, and so on, 200:00:05,339 –&gt; 00:00:12,780and we’ve also learned about th">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-10-23T14:13:16.959Z">
<meta property="article:modified_time" content="2025-10-23T14:13:54.956Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>CS144 NetworkP886 4Routing - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="CS144 NetworkP886 4Routing"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-10-23 22:13" pubdate>
          2025年10月23日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          1.6k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          13 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">CS144 NetworkP886 4Routing</h1>
            
            
              <div class="markdown-body">
                
                <p>1<br>00:00:00,000 –&gt; 00:00:05,339<br>Now that we’ve learned about the basics of routing, flooding, shortest paths, spanning trees, and so on,</p>
<p>2<br>00:00:05,339 –&gt; 00:00:12,780<br>and we’ve also learned about the distance vector protocol, Bellman-4 algorithm, the link state protocol, or Dijkstra’s shortest path path.</p>
<p>3<br>00:00:12,780 –&gt; 00:00:18,699<br>First, algorithm. In this video, I’m going to put it all together and tell you about the structure of the internet,</p>
<p>4<br>00:00:18,699 –&gt; 00:00:27,420<br>how hierarchical routing works about interior and exterior routing protocols, and the breakdown of the internet into autonomous systems.</p>
<p>5<br>00:00:28,420 –&gt; 00:00:36,920<br>I’m going to be talking about three main things. First of all, hierarchy and the decomposition of the internet into autonomous systems.</p>
<p>6<br>00:00:36,920 –&gt; 00:00:44,920<br>The second is, within those autonomous systems, how we use the distance vector and link state algorithms that we’ve already seen.</p>
<p>7<br>00:00:44,920 –&gt; 00:00:51,920<br>And the third one is the resulting structure of the internet. Let me start with the hierarchy.</p>
<p>8<br>00:00:51,920 –&gt; 00:00:59,920<br>When we learned about distance vector and link state algorithms, we were considering the network to be a single collection of routers.</p>
<p>9<br>00:00:59,920 –&gt; 00:01:07,420<br>This is really in practical. The internet’s made up of millions of routers into connecting over a billion different users.</p>
<p>10<br>00:01:07,420 –&gt; 00:01:12,420<br>And so simply for reasons of scale, we need to decompose routing into smaller sets.</p>
<p>11<br>00:01:12,420 –&gt; 00:01:20,920<br>So we do this for scale. With a large number of routers, the sheer scale of exchanging routing information</p>
<p>12<br>00:01:20,920 –&gt; 00:01:29,420<br>between the routers and keeping it up to date makes it too hard. I mean, imagine exchanging the link state information with a million other routers.</p>
<p>13<br>00:01:29,420 –&gt; 00:01:34,920<br>The network would just be flooded with updates all the time. And the distance vector algorithm would never converge.</p>
<p>14<br>00:01:34,920 –&gt; 00:01:44,920<br>So that decomposition takes place into different autonomous systems. And there’s an example shown here. This would be one autonomous system.</p>
<p>15<br>00:01:44,920 –&gt; 00:01:51,920<br>And this autonomous system contains different routers. That’s these.</p>
<p>16<br>00:01:51,920 –&gt; 00:01:56,920<br>This particular one has one exit point. And we’ll see the significance of that in a minute.</p>
<p>17<br>00:01:56,920 –&gt; 00:02:04,420<br>And within that autonomous system, the system is free to pick its own interior routing protocol.</p>
<p>18<br>00:02:04,420 –&gt; 00:02:10,420<br>In other words, to decide how packets are routed around within this autonomous system.</p>
<p>19<br>00:02:10,419 –&gt; 00:02:17,419<br>So this particular type of autonomous system is called a single exit or a stub autonomous system.</p>
<p>20<br>00:02:17,419 –&gt; 00:02:25,419<br>There’s another type of autonomous system called a multi-exit or multi-exit autonomous system. For example, this one here.</p>
<p>21<br>00:02:25,419 –&gt; 00:02:32,919<br>This is one where in this particular case there are three exit points. And again, it’s an autonomous system.</p>
<p>22<br>00:02:32,919 –&gt; 00:02:42,919<br>So they are free to determine the way in which packets are routed within that autonomous system using the interior routing protocol of their choice.</p>
<p>23<br>00:02:42,919 –&gt; 00:02:49,419<br>This is because they’re trying to, the internet was designed to give administrative autonomy.</p>
<p>24<br>00:02:49,419 –&gt; 00:02:57,919<br>The internet was built up by many different entities. And so an entity over here might be Stanford’s network.</p>
<p>25<br>00:02:57,919 –&gt; 00:03:07,919<br>Whereas this here might be, for example, a provider like AT&amp;T who is routing our packets to other networks.</p>
<p>26<br>00:03:07,919 –&gt; 00:03:15,419<br>And because of the different entities that grew up over time, and there are tens of thousands of them, all with their own individual goals and desires.</p>
<p>27<br>00:03:15,419 –&gt; 00:03:25,419<br>One of the original goals of the internet was to allow each organization to independently decide how it would run its own piece of the network, to allow it to organically grow.</p>
<p>28<br>00:03:25,419 –&gt; 00:03:33,419<br>And in many ways, this was a big factor in the success of the organic growth of the internet, particularly during the 1990s.</p>
<p>29<br>00:03:33,419 –&gt; 00:03:38,419<br>And allow each one to decide what routing protocol it would use inside its network.</p>
<p>30<br>00:03:38,419 –&gt; 00:03:47,419<br>So it means that, for example, at Stanford, we might use the interior routing protocol OSPF in order to route our packets.</p>
<p>31<br>00:03:47,419 –&gt; 00:03:54,419<br>Whereas inside AT&amp;T, they might use RIP or they might use another one that’s called ISIS.</p>
<p>32<br>00:03:54,419 –&gt; 00:04:03,419<br>It leads to local customization. It leads to differentiation. So AT&amp;T here might compete with Verizon here.</p>
<p>33<br>00:04:03,419 –&gt; 00:04:11,419<br>And they can differentiate and provide a different service. Hopefully for me, the end customer are better service as a result through competition amongst the operators.</p>
<p>34<br>00:04:11,419 –&gt; 00:04:20,419<br>And by allowing for local customization, it means the vendors of the routers can also offer different types of features and functionality.</p>
<p>35<br>00:04:20,420 –&gt; 00:04:30,420<br>And so it leads to competition amongst the route of vendors as well. So for all these reasons, the internet was divided into autonomous systems.</p>
<p>36<br>00:04:30,420 –&gt; 00:04:40,420<br>Autonomous systems or ASIs are the basic unit of hierarchy in the internet. Within an AS, the owner decides how routing is done.</p>
<p>37<br>00:04:40,420 –&gt; 00:04:50,420<br>And between ASIs, we must use BGP4. This is the Board of Gateway Protocol. And it’s defined by InternetRFC1771.</p>
<p>38<br>00:04:50,420 –&gt; 00:05:02,420<br>And this allows for a consistent method for all of the different ASIs to communicate. And we’ll be learning about BGP4 in a later video.</p>
<p>39<br>00:05:02,420 –&gt; 00:05:13,420<br>If you want to find an AS number, you can do this in a number of ways. One way to do it, actually the simplest is to just do a trace route to a particular destination with the minus a option.</p>
<p>40<br>00:05:13,420 –&gt; 00:05:19,420<br>And this should give you the AS numbers of the ones in between.</p>
<p>41<br>00:05:19,420 –&gt; 00:05:30,420<br>Most or many enterprises will have a single AS, for example, Stanford’s if you find it will be 32, 80 and T’s is 797.</p>
<p>42<br>00:05:30,420 –&gt; 00:05:44,420<br>Some enterprises choose to break down their own network into multiple autonomous systems, for example, Google has three that are reported and some networks even have dozens.</p>
<p>43<br>00:05:44,420 –&gt; 00:05:55,420<br>It’s a slightly more complicated way of finding it, but specifically querying would be this way. And that is to query using NetCat NC, if you perform this.</p>
<p>44<br>00:05:55,420 –&gt; 00:06:02,420<br>So it’s essentially going to this particular who is provider and then entering a particular IP address.</p>
<p>45<br>00:06:02,420 –&gt; 00:06:07,420<br>It will tell you the autonomous system that that IP address belongs to.</p>
<p>46<br>00:06:07,420 –&gt; 00:06:21,420<br>So if you wanted to find the AS number for Stanford, you would first do a DNS look up for Stanford.edu, find that in its a record, this is the primary address.</p>
<p>47<br>00:06:21,420 –&gt; 00:06:32,420<br>Then you can find the autonomous system for that particular IP address by doing this, by entering it here. And then that will return AS 32.</p>
<p>48<br>00:06:32,420 –&gt; 00:06:39,420<br>Let me show you a couple of examples of those right now. Let’s say I wanted to find the AS number for Stanford.</p>
<p>49<br>00:06:39,420 –&gt; 00:06:48,420<br>I could start by looking up the record for Stanford and we can see it here, the primary a record address.</p>
<p>50<br>00:06:48,420 –&gt; 00:07:00,420<br>And then I can do the look up to the using NetCat to the who is, this is just folks that provide a particular one that I like.</p>
<p>51<br>00:07:00,420 –&gt; 00:07:13,420<br>If I put in the address here for Stanford, and then we’ll see it returns the AS of 32 down here in the left hand corner for Stanford.</p>
<p>52<br>00:07:13,420 –&gt; 00:07:29,420<br>Similarly, if I wanted to find the AS numbers for the routers along and the networks along the path from my computer to say netflix.com, I could use the trust route minus, trace route, a root minus a option.</p>
<p>53<br>00:07:29,420 –&gt; 00:07:33,420<br>And here we go. Let’s look at this here.</p>
<p>54<br>00:07:33,420 –&gt; 00:07:44,420<br>So at the top we see or near the top we see the AS 32 corresponding to Stanford. Down the bottom we see the AS 2906 corresponding to netflix.</p>
<p>55<br>00:07:44,420 –&gt; 00:07:58,420<br>We’ll see one here which is AS 65534. This is basically saying that it’s a private address 10.33.0.2 because it begins with a 10 as a private IP address used inside Stanford.</p>
<p>56<br>00:07:58,420 –&gt; 00:08:14,420<br>So given it’s a private address, it’s not able to return an AS number. And in the middle here we see 2152 which is a scenic which is the California network that connects us to between Stanford and some outside providers.</p>
<p>57<br>00:08:14,420 –&gt; 00:08:23,420<br>Now we know the basic structure. Let’s look at the interior routing protocols. I’ve already mentioned RIP or the routing information protocol.</p>
<p>58<br>00:08:23,420 –&gt; 00:08:34,420<br>And this was the first widely used interior routing protocol in the internet. It uses distance vector in particular the distributed bellman fort algorithm.</p>
<p>59<br>00:08:34,420 –&gt; 00:08:51,420<br>It’s described by an internet RFC. This is actually version two of RIP which is the one most widely used. It sends updates every 30 seconds and will determine that a router has become unavailable if it hasn’t heard within 180 seconds or three minutes.</p>
<p>60<br>00:08:51,419 –&gt; 00:09:00,419<br>So there are no authentication for updates meaning that there are different needs and some security implications of using RIP.</p>
<p>61<br>00:09:00,419 –&gt; 00:09:17,419<br>RIP became popular to start with because it was originally in the BSD version of UNIX and there was a demon that was widely used, widely available for routers that were using RIP.</p>
<p>62<br>00:09:18,419 –&gt; 00:09:34,419<br>And that was pronounced Route D and you can find many references to this on the web. So it was widely used for many years. It’s used a little less now because of the convergence problems that people have found with RIP.</p>
<p>63<br>00:09:34,419 –&gt; 00:09:43,419<br>And it tends to have been mostly replaced by OSPF or ISIS which is very similar to OSPF.</p>
<p>64<br>00:09:44,419 –&gt; 00:09:53,419<br>So OSPF is defined in internet RFC 2328 and it’s a link state algorithm so link state updates are sent using flooding.</p>
<p>65<br>00:09:53,419 –&gt; 00:10:06,419<br>And just in case I didn’t say this before we use flooding because during the time that we’re trying to find the topology of the network we don’t know how to reach anyone so we don’t have any topology information.</p>
<p>66<br>00:10:06,419 –&gt; 00:10:14,419<br>And that’s why we’re flooding the link state information so we can’t route the link state information to every router because we don’t know the path.</p>
<p>67<br>00:10:14,419 –&gt; 00:10:25,419<br>So flooding is the simplest routing table free way of making sure that every router in the network finds out the link state.</p>
<p>68<br>00:10:25,419 –&gt; 00:10:35,419<br>So that’s why flooding is used. It runs Dijkstra’s algorithm as we know. The updates are all authenticated meaning that we’re sure that they belong to the router that we are communicating with.</p>
<p>69<br>00:10:36,419 –&gt; 00:10:45,419<br>Because some autonomous systems are very big it’s quite common to partition them down into areas so our own campus network here at Stanford is partitioned into OSPF areas.</p>
<p>70<br>00:10:45,419 –&gt; 00:10:53,419<br>It’s widely used it’s quite complex this is a gross simplification here but it gives us the basic ideas of how OSPF works.</p>
<p>71<br>00:10:54,419 –&gt; 00:11:06,419<br>So once we know how to route packets within an autonomous system it’s worth asking the question of how do we route them from within an autonomous system to a different autonomous system.</p>
<p>72<br>00:11:06,419 –&gt; 00:11:22,419<br>So how do they make it first out of the autonomous system? How does the interior routing protocol isn’t going to tell us directly how we exit from an autonomous system because it’s dealing with the addresses of routers that are outside of this autonomous system.</p>
<p>73<br>00:11:22,419 –&gt; 00:11:38,419<br>So there are already two cases that we need to think about. One is when we’re routing to a single exit point so this would be from a stub autonomous system that actually only has one exit point much easier in this case than in the more general case where where there are multiple exit points.</p>
<p>74<br>00:11:38,419 –&gt; 00:11:45,419<br>So if there’s only one exit point routers within the within the autonomous system can use what’s called default routing.</p>
<p>75<br>00:11:45,419 –&gt; 00:12:04,419<br>Each router knows all of the prefixes within its autonomous system so it knows all of the prefixes inside the autonomous system and packets for another autonomous system are sent to what’s called the default router and the default router is the board of gateway to the next autonomous system.</p>
<p>76<br>00:12:04,419 –&gt; 00:12:14,419<br>So it’s nice and simple. Essentially says if you see an address in a packet that you don’t know what to do with then just forward it to the default router.</p>
<p>77<br>00:12:14,419 –&gt; 00:12:27,419<br>And default routing means that the routing tables in the single exit AS is tend to be very small because each router only needs to hold the addresses for the prefixes within its autonomous system.</p>
<p>78<br>00:12:27,419 –&gt; 00:12:40,419<br>Otherwise it just forwards them out nice and easy. Life is more complicated when we need to route to multiple exit points so this would be in a transit autonomous system or one where there are multiple exit points.</p>
<p>79<br>00:12:41,419 –&gt; 00:12:53,419<br>This has actually become much more common in the last few years because nearly all sizeable enterprises like Stanford will connect at multiple exit points to different providers.</p>
<p>80<br>00:12:53,419 –&gt; 00:13:09,419<br>So we might provide we might connect to an educational backbone a research and education network and then we will connect to one or two commercial providers just in case one of them goes down one of them is temporarily unavailable one of them is perhaps too expensive for a particular reason.</p>
<p>81<br>00:13:09,419 –&gt; 00:13:20,419<br>It allows us to choose and have control so multi homing is very common now we need to choose for each outgoing packet which exit point it will take.</p>
<p>82<br>00:13:20,419 –&gt; 00:13:30,419<br>So the problem here is that each internal router must be told which exit point to use for a given destination prefix. This is the essence of the problem.</p>
<p>83<br>00:13:31,419 –&gt; 00:13:39,419<br>That means that when it sees a prefix which is not inside the autonomous system it has to know which exit point to use.</p>
<p>84<br>00:13:39,419 –&gt; 00:13:55,419<br>So this means it requires very large routing tables so that potentially routes to every prefix and so the routing tables in a autonomous system with multiple exit points tend to be very very big tens or hundreds of thousands of prefix entries.</p>
<p>85<br>00:13:56,419 –&gt; 00:14:05,419<br>This can actually be made a little simpler if the autonomous system uses what’s called hot potato routing.</p>
<p>86<br>00:14:05,419 –&gt; 00:14:17,419<br>Hot potato routing is when instead of making a smart choice in the best interest of the packet and its destination it simply sends to the closest exit point.</p>
<p>87<br>00:14:17,419 –&gt; 00:14:26,419<br>In other words it says for any given router it sends it to the exit point closest to it if it decides it’s not for within the autonomous system.</p>
<p>88<br>00:14:26,419 –&gt; 00:14:41,419<br>Hot potato routing is also seen as offloading somewhat a selfish act by the autonomous system because it’s offloading the packet as quickly as it can to become somebody else’s problem and is not very popular with its neighboring autonomous systems.</p>
<p>89<br>00:14:42,419 –&gt; 00:14:49,419<br>But it’s actually very widely used today in the internet for both commercial reasons and reasons of simplicity.</p>
<p>90<br>00:14:49,419 –&gt; 00:15:09,419<br>The more elaborate way would be to pick the exit which is closest to the destination or is on the lowest cost path to the eventual destination and that requires the dissemination of more information within the autonomous system in order to make that decision.</p>
<p>91<br>00:15:09,419 –&gt; 00:15:19,419<br>Now we’ve learned a little bit about how routing goes on within the autonomous system and now want to explain a little bit about the exterior routing protocol BGP4.</p>
<p>92<br>00:15:19,419 –&gt; 00:15:27,419<br>Every autonomous system in the internet must interconnect to other autonomous systems using BGP4.</p>
<p>93<br>00:15:27,419 –&gt; 00:15:33,419<br>Just like we’re required to use IP in order to deliver our packets that’s what the internet uses.</p>
<p>94<br>00:15:33,419 –&gt; 00:15:40,419<br>The thin waste of routing protocols is BGP4 in other words it’s the one that we must all use.</p>
<p>95<br>00:15:40,419 –&gt; 00:15:50,419<br>So I’m going to describe BGP4 in a separate video but I just wanted to tell you a little bit about the problems that BGP4 was designed to try and solve.</p>
<p>96<br>00:15:50,419 –&gt; 00:16:01,419<br>First of all it has a very different problem for an exterior routing protocol than for an interior routing protocol.</p>
<p>97<br>00:16:01,419 –&gt; 00:16:12,419<br>Specifically when we’re considering the topology the internet is a very complex mesh of different autonomous systems and has very little structure to it.</p>
<p>98<br>00:16:12,419 –&gt; 00:16:21,419<br>You’ve seen the picture which is the logo for this class and we’ll have seen that it’s a very unstructured interconnection mesh.</p>
<p>99<br>00:16:21,419 –&gt; 00:16:28,419<br>And so trying to exploit that any structure is not going to get us very far.</p>
<p>100<br>00:16:28,419 –&gt; 00:16:32,419<br>Each of the autonomous systems is autonomously controlled.</p>
<p>101<br>00:16:33,419 –&gt; 00:16:39,419<br>So they might define the link costs in very different ways. So it’s not possible to find lowest cost paths.</p>
<p>102<br>00:16:39,419 –&gt; 00:16:47,419<br>We’re simply going to have to find a set of paths based on the number of autonomous systems that they pass through.</p>
<p>103<br>00:16:47,419 –&gt; 00:16:55,419<br>Another thing that we need to consider is trust. When we’re going between autonomous systems we’ll find that some autonomous systems aren’t willing to trust others.</p>
<p>104<br>00:16:55,419 –&gt; 00:17:02,419<br>Perhaps they don’t trust them to advertise good routes. EG they might be a competitor.</p>
<p>105<br>00:17:02,419 –&gt; 00:17:11,420<br>Or they may want to protect the privacy of their traffic. So they might not want to send traffic through another autonomous system.</p>
<p>106<br>00:17:11,420 –&gt; 00:17:15,420<br>For example it might be a warring nation.</p>
<p>107<br>00:17:15,420 –&gt; 00:17:22,420<br>Another reason that or another thing that BGP4 was set out to solve was the question of independent policies.</p>
<p>108<br>00:17:22,420 –&gt; 00:17:29,420<br>So different autonomous systems have different objectives. Some might try to route over the fewest hops.</p>
<p>109<br>00:17:29,420 –&gt; 00:17:36,420<br>They may prefer one provider over another. They might have a lower cost arrangement with one provider compared to another.</p>
<p>110<br>00:17:36,420 –&gt; 00:17:43,420<br>So they have local policies that they perhaps don’t want to share with others. And in general these policies are kept secret.</p>
<p>111<br>00:17:43,420 –&gt; 00:17:52,420<br>And so BGP4 is designed to work in a way that will allow for that policy to be a local private matter for the autonomous system.</p>
<p>112<br>00:17:52,420 –&gt; 00:17:59,420<br>So we’ll see BGP4 in more detail in a different video.</p>
<p>113<br>00:17:59,420 –&gt; 00:18:08,420<br>Finally I want to just tell you a little bit about the structure of the internet as we’ve seen it so far.</p>
<p>114<br>00:18:08,420 –&gt; 00:18:17,420<br>So first at the top level there are what we would all recognize as internet service providers.</p>
<p>115<br>00:18:17,420 –&gt; 00:18:25,420<br>They might be companies like AT&amp;T. They might be in Japan. It might be NTT.</p>
<p>116<br>00:18:25,420 –&gt; 00:18:34,420<br>There’s about a dozen of these. What are so called tier one tier one ISPs.</p>
<p>117<br>00:18:34,420 –&gt; 00:18:41,420<br>And they are defined as ISPs that are fully mesh interconnected with each other.</p>
<p>118<br>00:18:41,420 –&gt; 00:18:47,420<br>And who peer each other without charging each other. It’s called settlement free peering.</p>
<p>119<br>00:18:47,420 –&gt; 00:18:55,420<br>In other words there’s no money that goes across this interface between them.</p>
<p>120<br>00:18:55,420 –&gt; 00:19:08,420<br>They then connect down to what are called regional ISPs which might correspond to a state or a county or a region of a country.</p>
<p>121<br>00:19:08,420 –&gt; 00:19:18,420<br>And those in turn connect to below them to what are called the access ISPs.</p>
<p>122<br>00:19:18,420 –&gt; 00:19:23,420<br>So there would be many access ISPs along the bottom here.</p>
<p>123<br>00:19:23,420 –&gt; 00:19:34,420<br>And these would be the ones that we connect to as users. So users are down below these access ISPs down here.</p>
<p>124<br>00:19:34,420 –&gt; 00:19:39,420<br>And they will connect up here. And an access ISP might connect to multiple regional ISPs.</p>
<p>125<br>00:19:39,420 –&gt; 00:19:45,420<br>And the regional ISPs will generally connect to multiple tier one ISPs.</p>
<p>126<br>00:19:45,420 –&gt; 00:19:54,420<br>So this hierarchy is one in which there’s a well-defined relationship between each of these entities.</p>
<p>127<br>00:19:54,420 –&gt; 00:20:04,420<br>So in general, up above is the provider and below is the customer.</p>
<p>128<br>00:20:04,420 –&gt; 00:20:10,420<br>So the provider is providing service to the customer. And that goes on down all the way down.</p>
<p>129<br>00:20:10,420 –&gt; 00:20:17,420<br>So in going down this is the provider and this is the customer. And generally the provider will charge the customer.</p>
<p>130<br>00:20:17,420 –&gt; 00:20:24,420<br>So in other words, in order to send packets from the regional to the tier, their money is charged, a settlement charge.</p>
<p>131<br>00:20:24,420 –&gt; 00:20:29,420<br>Generally they keep track of all the data that’s sent over there over some period like a month.</p>
<p>132<br>00:20:29,420 –&gt; 00:20:33,420<br>And then they will settle after that time. So there would be money charged in that direction.</p>
<p>133<br>00:20:33,420 –&gt; 00:20:38,420<br>But there’s no money going in this direction across here.</p>
<p>134<br>00:20:39,420 –&gt; 00:20:46,420<br>So in order to save money, it’s quite common for the regional ISPs to have connections across here.</p>
<p>135<br>00:20:46,420 –&gt; 00:20:53,420<br>So that the packets between access ISPs, if there’s a lot of traffic, it can actually go through the regional ISP without going to the tier one.</p>
<p>136<br>00:20:53,420 –&gt; 00:20:59,420<br>And therefore they don’t need to pay for that.</p>
<p>137<br>00:20:59,420 –&gt; 00:21:02,420<br>So this is the basic internet infrastructure.</p>
<p>138<br>00:21:02,420 –&gt; 00:21:10,420<br>Tier one ISPs, about a dozen of them around the world. And then regional ISPs generally within a country or within the region of a country.</p>
<p>139<br>00:21:10,420 –&gt; 00:21:17,420<br>And then access ISPs to the ones that we connect to in order to get access to the internet.</p>
<p>140<br>00:21:20,420 –&gt; 00:21:24,420<br>So in summary, the internet consists of multiple autonomous systems.</p>
<p>141<br>00:21:24,420 –&gt; 00:21:27,420<br>ASS is each are managed independently.</p>
<p>142<br>00:21:27,420 –&gt; 00:21:32,420<br>And ASS runs its own interior routing protocol. In other words, it chooses the one that it will run.</p>
<p>143<br>00:21:32,420 –&gt; 00:21:38,420<br>And in the case of stub ASS, they use simple default router. And so they’re very simple.</p>
<p>144<br>00:21:38,420 –&gt; 00:21:45,420<br>ASS with multiple exit points must decide the best exit to use when routing packets to other autonomous systems.</p>
<p>145<br>00:21:45,420 –&gt; 00:21:52,420<br>ASS must connect to each other using the BGP4 protocol, which we’re going to learn about in a future video.</p>
<p>146<br>00:21:54,420 –&gt; 00:21:56,420<br>That’s the end of this video.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>CS144 NetworkP886 4Routing</div>
      <div>http://example.com/2025/10/23/CS144-networkP886-4Routing/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年10月23日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/10/23/CS144-networkP876-3Routing/" title="CS144 NetworkP876 3Routing">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">CS144 NetworkP876 3Routing</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/10/23/CS144-networkP815-10DNS3/" title="CS144 NetworkP815 10DNS3">
                        <span class="hidden-mobile">CS144 NetworkP815 10DNS3</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
