

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="100:00:00,000 –&gt; 00:00:06,000Now we’re going to look at binary heaps, which is an ingenious and very simple data structure 200:00:06,000 –&gt; 00:00:10,000that’s going to help us implement all the">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2025/10/23/P35Part18-04_binary-heaps/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="100:00:00,000 –&gt; 00:00:06,000Now we’re going to look at binary heaps, which is an ingenious and very simple data structure 200:00:06,000 –&gt; 00:00:10,000that’s going to help us implement all the">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-10-23T14:29:08.678Z">
<meta property="article:modified_time" content="2025-10-23T14:31:18.813Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text=""></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-10-23 22:29" pubdate>
          2025年10月23日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          1.7k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          14 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header"></h1>
            
            
              <div class="markdown-body">
                
                <p>1<br>00:00:00,000 –&gt; 00:00:06,000<br>Now we’re going to look at binary heaps, which is an ingenious and very simple data structure</p>
<p>2<br>00:00:06,000 –&gt; 00:00:10,000<br>that’s going to help us implement all the priority queue operations quickly.</p>
<p>3<br>00:00:10,000 –&gt; 00:00:17,000<br>So the idea of a binary heap is based on the idea of a complete binary tree.</p>
<p>4<br>00:00:17,000 –&gt; 00:00:24,000<br>So a complete binary tree, well first of all a binary tree is either empty or it’s a node with links to left and right binary tree.</p>
<p>5<br>00:00:24,000 –&gt; 00:00:26,000<br>So that’s an example of a binary tree.</p>
<p>6<br>00:00:27,000 –&gt; 00:00:33,000<br>A complete binary tree is one that’s perfectly balanced except possibly for the bottom level.</p>
<p>7<br>00:00:33,000 –&gt; 00:00:42,000<br>So there might be a few nodes on the bottom level and one lower than the bottom level, but otherwise all the levels are full.</p>
<p>8<br>00:00:42,000 –&gt; 00:00:45,000<br>We’ll see how that looks in just a second.</p>
<p>9<br>00:00:45,000 –&gt; 00:00:55,000<br>The property of a complete tree is that the height of a complete tree with n nodes is the biggest integer less than log base 2 of n.</p>
<p>10<br>00:00:55,000 –&gt; 00:01:09,000<br>And that’s really easy to convince yourself that that’s true because the height, if we add nodes one at a time, going from left to right on the bottom level, say, the height only increases when n is a power of 2.</p>
<p>11<br>00:01:10,000 –&gt; 00:01:13,000<br>A complete binary tree is actually happening in nature.</p>
<p>12<br>00:01:13,000 –&gt; 00:01:22,000<br>Here’s an example of one that goes one, two, three, four levels at least.</p>
<p>13<br>00:01:22,000 –&gt; 00:01:26,000<br>So 16 bushes at the end there.</p>
<p>14<br>00:01:26,000 –&gt; 00:01:37,000<br>All right, now the way we’re going to use complete binary trees to implement priority cues is to first of all associate information with each node.</p>
<p>15<br>00:01:37,000 –&gt; 00:01:39,000<br>We’ll put our keys in the nodes.</p>
<p>16<br>00:01:39,000 –&gt; 00:01:43,000<br>And also we’re going to represent it with an array.</p>
<p>17<br>00:01:43,000 –&gt; 00:01:51,000<br>So when we start putting the keys in the nodes, we’re going to impose one more condition that’s called heap ordering.</p>
<p>18<br>00:01:52,000 –&gt; 00:02:01,000<br>And the idea is that the parent’s key is going to be no smaller than its children’s key for that’s true for every node in the tree.</p>
<p>19<br>00:02:01,000 –&gt; 00:02:06,000<br>The array representation, all we do is we put, we start with indices at one.</p>
<p>20<br>00:02:06,000 –&gt; 00:02:11,000<br>It’s a little less calculation that way we leave a of zero empty.</p>
<p>21<br>00:02:11,000 –&gt; 00:02:13,000<br>And then we just take the nodes in level order.</p>
<p>22<br>00:02:13,000 –&gt; 00:02:23,000<br>So first we put the root, then we put the two nodes on the first level going left from right, and then all the nodes on the third level going from left to right and so forth.</p>
<p>23<br>00:02:23,000 –&gt; 00:02:30,000<br>This is interesting because we can draw the tree to get more intuition about what’s happening.</p>
<p>24<br>00:02:30,000 –&gt; 00:02:34,000<br>But in the actual data structure representation, we don’t need any links at all.</p>
<p>25<br>00:02:34,000 –&gt; 00:02:36,000<br>It’s just an array.</p>
<p>26<br>00:02:36,000 –&gt; 00:02:42,000<br>The way that we move around the tree is by doing arithmetic on the indices.</p>
<p>27<br>00:02:42,000 –&gt; 00:02:45,000<br>So let’s look at a few properties of binary heap.</p>
<p>28<br>00:02:45,000 –&gt; 00:02:53,000<br>So that’s complete binary trees represented in array with keys in the nodes satisfying the heap order property.</p>
<p>29<br>00:02:53,000 –&gt; 00:02:58,000<br>Well, first thing is that a of one is the largest key.</p>
<p>30<br>00:02:58,000 –&gt; 00:03:04,000<br>It’s larger than the keys that is two children and they’re larger than theirs and so forth.</p>
<p>31<br>00:03:04,000 –&gt; 00:03:08,000<br>So it’s the largest key in the data structure.</p>
<p>32<br>00:03:08,000 –&gt; 00:03:14,000<br>The other thing is as I just mentioned, you can use the array in the seeds to move through the tree.</p>
<p>33<br>00:03:14,000 –&gt; 00:03:23,000<br>For example, if the node is at position k, index k in the array, then its parent is at k over two.</p>
<p>34<br>00:03:23,000 –&gt; 00:03:25,000<br>And that’s integer divide.</p>
<p>35<br>00:03:25,000 –&gt; 00:03:30,000<br>So the parents of say h and g are both n.</p>
<p>36<br>00:03:30,000 –&gt; 00:03:33,000<br>10 g’s at 11 ends at 5.</p>
<p>37<br>00:03:33,000 –&gt; 00:03:38,000<br>So both of those are 10 over 2, 11 over 2, integer divide is 5.</p>
<p>38<br>00:03:38,000 –&gt; 00:03:45,000<br>And going the other way, it’s easy to see that the children of the node at k are 2k and 2k plus 1.</p>
<p>39<br>00:03:45,000 –&gt; 00:03:49,000<br>So we don’t need explicit links at all to represent these data structures.</p>
<p>40<br>00:03:49,000 –&gt; 00:03:53,000<br>We can just use array indices.</p>
<p>41<br>00:03:53,000 –&gt; 00:03:59,000<br>So that’s the basic setup of the invariant that we want to maintain in this data structure.</p>
<p>42<br>00:03:59,000 –&gt; 00:04:11,000<br>And now what we’re going to do is take a look at just a couple of different scenarios that we violate that invariant temporarily and then fix it.</p>
<p>43<br>00:04:11,000 –&gt; 00:04:17,000<br>And that’s going to give us the flexibility that we need to implement priority queue operations.</p>
<p>44<br>00:04:17,000 –&gt; 00:04:26,000<br>So one scenario shown here is if for whatever reason a child’s key becomes larger than its parent’s key.</p>
<p>45<br>00:04:26,000 –&gt; 00:04:37,000<br>So in this case, we have an example where t, the node t here is value changes and it becomes larger than its parent key piece.</p>
<p>46<br>00:04:37,000 –&gt; 00:04:42,000<br>So the heap order condition is satisfied everywhere except at this node.</p>
<p>47<br>00:04:42,000 –&gt; 00:04:45,000<br>Well, it’s easy to fix this one.</p>
<p>48<br>00:04:45,000 –&gt; 00:04:51,000<br>All we do is exchange the key in the child with the key in the parent.</p>
<p>49<br>00:04:51,000 –&gt; 00:04:56,000<br>After that exchange, then that would have t up here and p down here.</p>
<p>50<br>00:04:56,000 –&gt; 00:05:03,000<br>Then the heap order condition is satisfied at that node because the parent was smaller, so that one’s smaller.</p>
<p>51<br>00:05:03,000 –&gt; 00:05:09,000<br>And the southern is still smaller, so t is after its exchange, that here will be bigger than both its children.</p>
<p>52<br>00:05:09,000 –&gt; 00:05:16,000<br>But the heap condition will be violated because t is still smaller than s, so we have to do it again, exchange it with s.</p>
<p>53<br>00:05:16,000 –&gt; 00:05:26,000<br>So we move up the tree exchanging the larger key with its smaller parent until we get to a point where it’s larger than both its children.</p>
<p>54<br>00:05:26,000 –&gt; 00:05:33,000<br>That’s restoring the heap order along a path from the place where it’s violated to the root.</p>
<p>55<br>00:05:33,000 –&gt; 00:05:45,000<br>You can think of that as kind of like the well-known Peter principle where a node gets promoted to a level where it finally can’t be better than its boss.</p>
<p>56<br>00:05:45,000 –&gt; 00:05:49,000<br>It’s a level of its maximum incompetence.</p>
<p>57<br>00:05:49,000 –&gt; 00:05:55,000<br>And implementing that in code is really easy. We call that the swim operation swims up to the top.</p>
<p>58<br>00:05:55,000 –&gt; 00:06:16,000<br>And if we have a node at index k and we know the heap condition is violated there, as long as we’re not at the root and k’s parent k over 2 is less than a of k, then we just exchange it with its parent and move up.</p>
<p>59<br>00:06:16,000 –&gt; 00:06:23,000<br>That’s the swim operation to eliminate a violation when a key value increases.</p>
<p>60<br>00:06:23,000 –&gt; 00:06:30,000<br>So for example, this gives us a way to insert a new element into a heap.</p>
<p>61<br>00:06:30,000 –&gt; 00:06:40,000<br>What we do is we add a new node at the end of the heap. So that’s one position over. The thing is, remember, represented in array, 1, 2, 3, and so forth.</p>
<p>62<br>00:06:40,000 –&gt; 00:06:49,000<br>So the next empty position in the array, there’s a place to put a new node. And then we just declare that that’s part of the heap.</p>
<p>63<br>00:06:49,000 –&gt; 00:07:03,000<br>And that node, well, if it’s less than its parent, we’re fine. But in general, we have to check whether the heap condition is violated and exchange it with its parent as long as it’s smaller. And that’s just perform the swim operation.</p>
<p>64<br>00:07:03,000 –&gt; 00:07:14,000<br>So if the end is the number of items in the heap to find to be in the heap, we’re going to increment it, store our new key there there and then perform the swim operation.</p>
<p>65<br>00:07:14,000 –&gt; 00:07:27,000<br>So that’s a quick implementation of the insert operation. And notice since it just going from bottom to top in the heap, it takes at most 1 plus log base 2 event compares.</p>
<p>66<br>00:07:27,000 –&gt; 00:07:32,000<br>Now there’s another scenario where a key becomes smaller.</p>
<p>67<br>00:07:32,000 –&gt; 00:07:39,000<br>So for whatever reason a parent becomes a key decreases, it might become smaller than one or both of its children.</p>
<p>68<br>00:07:39,000 –&gt; 00:07:51,000<br>In this case, the value at position 2 has changed to h for whatever reason. And that’s smaller in this case than both its children.</p>
<p>69<br>00:07:51,000 –&gt; 00:08:00,000<br>So how do we fix that violation? Well, that one’s also easy. We figure out which of the children is larger, in this case it’s the s.</p>
<p>70<br>00:08:00,000 –&gt; 00:08:14,000<br>And we exchange that one with the one that’s violating the condition. So that’s moving the smaller key down. After that exchange, then s is in position 2 and it’s bigger than both p and h.</p>
<p>71<br>00:08:14,000 –&gt; 00:08:26,000<br>And the heap condition is only violated again where h is sitting. And again, we keep going until getting to the bottom or getting to a place where both children are smaller.</p>
<p>72<br>00:08:26,000 –&gt; 00:08:41,000<br>And that’s maybe a little bit what happens when a new boss is hired from the outside and then the two subordinates struggle to take over that position and then the boss would get the motive to its level of competence.</p>
<p>73<br>00:08:41,000 –&gt; 00:08:54,000<br>And again, that level of flexibility. Here’s the implementation of it. And again, it’s quite straightforward using the index arithmetic to move around in the heap.</p>
<p>74<br>00:08:54,000 –&gt; 00:09:06,000<br>If we’re, and that’s called the sync operation because we’re going down in the heap for a position k, then what we need to worry about is the nodes at 2k and 2k plus 1.</p>
<p>75<br>00:09:06,000 –&gt; 00:09:18,000<br>And the first thing to check is find out which one’s bigger. It’s either 2k or 2k plus 1. And so say j accordingly. So that’s j now is after this statement is the larger the two children.</p>
<p>76<br>00:09:18,000 –&gt; 00:09:30,000<br>Don’t forget to check that we’re going off the end of the heap. And then if the k is not less than either one of those, then we’re done.</p>
<p>77<br>00:09:30,000 –&gt; 00:09:44,000<br>If it is, then we exchange with the larger the two children and move down the heap. Again, just a few lines of code to eliminate the violation when a key value in a heap decreases.</p>
<p>78<br>00:09:44,000 –&gt; 00:09:56,000<br>And that one we’re going to use to implement delete the maximum in a heap. So delete the maximum we have to do two things. One thing is the size of the heap is going to go down by one.</p>
<p>79<br>00:09:56,000 –&gt; 00:10:10,000<br>The other thing is return the maximum. While we know the one that we want to return is the one at the root. So we’ll save that value away to return to the client.</p>
<p>80<br>00:10:10,000 –&gt; 00:10:22,000<br>And then since it has to go down by one, the place to get the to remove the element from the heap is at the end of the array because it’s now going to have to not occupy that position.</p>
<p>81<br>00:10:22,000 –&gt; 00:10:33,000<br>So we take that element and replace the root with it. So move the H up and actually put the root value there just exchange them, but it’s no longer in the heap.</p>
<p>82<br>00:10:33,000 –&gt; 00:10:47,000<br>Now that element which went from the bottom to the top is most likely going to violate the heap order. It’s going to be smaller than one of its both of its children. So we do a sink.</p>
<p>83<br>00:10:47,000 –&gt; 00:11:02,000<br>Now in this case to implement the delete max, we save away that value at the root in max and we eliminate lortering by nulling out that vacated position, then return the max value.</p>
<p>84<br>00:11:02,000 –&gt; 00:11:16,000<br>So that’s an implement implementation of the delete max operation for a heap using sink where a key value that decreases go down goes down in the heat.</p>
<p>85<br>00:11:16,000 –&gt; 00:11:31,000<br>So let’s just take a look at what happens with a real heap with the demo when we do these things and you’ll have a good feeling for how this data structure works.</p>
<p>86<br>00:11:31,000 –&gt; 00:11:46,000<br>So we’re starting at some point where we have these 10 keys in a heap and it’s heap ordered. So we’ve drawn the data structure with the links. So we have an intuition for what’s going on.</p>
<p>87<br>00:11:46,000 –&gt; 00:11:55,000<br>But all the program sees is the array and gray at the bottom where it tees in position one, P and R, position two and three and so forth.</p>
<p>88<br>00:11:55,000 –&gt; 00:12:02,000<br>So now suppose we’re supposed to add s. So to add it to the heap, that’s going to go in the position at the end.</p>
<p>89<br>00:12:02,000 –&gt; 00:12:11,000<br>And then now we’ve added it to the heap by just incrementing n and putting it in there. But now we have to bring the heap order back into condition.</p>
<p>90<br>00:12:11,000 –&gt; 00:12:21,000<br>And so that’s going to, that key is larger than its parents. So we’re going to swim it up, exchange it with its parent as long as it’s smaller than its parent.</p>
<p>91<br>00:12:21,000 –&gt; 00:12:28,000<br>So first thing it goes up, exchange with the s. It’s still bigger than p. So we exchange it with the p.</p>
<p>92<br>00:12:28,000 –&gt; 00:12:36,000<br>And now we’re done because s is not bigger than t and the heap order condition is now satisfied everywhere in the heap.</p>
<p>93<br>00:12:36,000 –&gt; 00:12:42,000<br>So with just two exchanges, we insert that new element into the heap in this case.</p>
<p>94<br>00:12:42,000 –&gt; 00:12:54,000<br>And now suppose the next operation is remove the maximum. So we’re going to take t and we’re going to exchange it with the last element and then declare that to be no longer part of the heap.</p>
<p>95<br>00:12:54,000 –&gt; 00:13:03,000<br>So now we have to bring the heap order back because it might be violated at the root.</p>
<p>96<br>00:13:03,000 –&gt; 00:13:12,000<br>So now we invoke the sink where we exchange that node with the larger of its two children until we find a place where it’s larger than both its children.</p>
<p>97<br>00:13:12,000 –&gt; 00:13:21,000<br>So s is the larger of the two children, R and S. And now h is still smaller than both its children. So we promote the larger which is p.</p>
<p>98<br>00:13:21,000 –&gt; 00:13:28,000<br>Now h has no right child just a left child and it’s larger than that one. So we’re finished with that operation.</p>
<p>99<br>00:13:28,000 –&gt; 00:13:38,000<br>We’ve removed the maximum and we still have our data structure heap ordered and our n keys stored in the first n positions in the array.</p>
<p>100<br>00:13:38,000 –&gt; 00:13:49,000<br>Let’s remove the maximum again. Again we take it out by exchanging this time g with the root and then decrease the size of the heap by one.</p>
<p>101<br>00:13:49,000 –&gt; 00:13:59,000<br>Just take that out. Now the node at the root violates the heap order. So we have to exchange it with the largest of its two children. In this case that’s R.</p>
<p>102<br>00:13:59,000 –&gt; 00:14:10,000<br>Again g is not larger than its two children. So we have to exchange it with the larger of the two that’s O. And now we’re done. We’ve removed the largest again.</p>
<p>103<br>00:14:10,000 –&gt; 00:14:29,000<br>Now suppose we insert S back into the heap. So that’s adding it at the end violates the heap order. Exchange it with the parent who’s smaller and keep doing until we get to a place where it’s larger than its two children.</p>
<p>104<br>00:14:29,000 –&gt; 00:14:47,000<br>In this case S goes all the way up to the root and it’s all heap ordered again. So that’s a little survey of some operations on a heap and you can see how every operation is done with just a few exchanges along the path from the bottom to the top or the top to the bottom.</p>
<p>105<br>00:14:47,000 –&gt; 00:14:55,000<br>Okay, here’s the complete Java implementation of a priority queue using the binary heap data structure.</p>
<p>106<br>00:14:55,000 –&gt; 00:15:08,000<br>It’s actually not so different from the elementary implementations that we looked at in the last section. Our representation is an array of keys and a size. That’s the number of items in the heap.</p>
<p>107<br>00:15:08,000 –&gt; 00:15:25,000<br>For simplicity, we’ll show the code where the client gives the capacity of the heap. We can use resizing array in an industrial strength implementation. The same that we did for stacks and other data structures where we use arrays.</p>
<p>108<br>00:15:25,000 –&gt; 00:15:42,000<br>So we’ll build a new array of keys and we have to use an ugly ugly cast because we can’t have generic arrays in Java. And that’s so it’s comparable and we need one more than the capacity to handle this thing where we don’t use position zero.</p>
<p>109<br>00:15:42,000 –&gt; 00:15:53,000<br>So the priority queue operations is being certain del max that we just showed in the previous slides is into is just checking whether n is equal to zero.</p>
<p>110<br>00:15:53,000 –&gt; 00:16:06,000<br>We have the swim and sink functions that we showed earlier and then we have helper functions less in exchange that access the array directly so that the code doesn’t have to accident directly.</p>
<p>111<br>00:16:06,000 –&gt; 00:16:12,000<br>That’s a complete implementation of priority cues in Java.</p>
<p>112<br>00:16:12,000 –&gt; 00:16:21,000<br>And this is this implementation by itself is extremely significant because it’s really very simple.</p>
<p>113<br>00:16:21,000 –&gt; 00:16:37,000<br>The optimal representation of the data and only a little arithmetic with array indices. But as you can see by looking at this table, it gives us a way to implement priority cues where both operations are guaranteed to happen in log in time.</p>
<p>114<br>00:16:37,000 –&gt; 00:16:57,000<br>Now experts have worked to come up with improvements on this and there are slight improvements possible. We can make the heap d way rather than just two way and depending on the frequency of execution of the insert and del max operations that might work out better.</p>
<p>115<br>00:16:57,000 –&gt; 00:17:11,000<br>There’s an advanced data structure called a Fibonacci heap where inserts are done in constant time and del max done in log in time on average over all the operations.</p>
<p>116<br>00:17:11,000 –&gt; 00:17:23,000<br>That one’s generally too complicated to use in practice. But still again using theory as a guide maybe there’s a way to to decrease costs a little bit from binary heaps.</p>
<p>117<br>00:17:23,000 –&gt; 00:17:36,000<br>And of course we cannot get down to having constant time for all operations. Why? Well we can sort with the heap by inserting all the elements and then deleting the maximum and getting a sort done.</p>
<p>118<br>00:17:36,000 –&gt; 00:17:44,000<br>And that would be linear time if we had this kind of variation, if we had constant time operations for both in certain del max.</p>
<p>119<br>00:17:44,000 –&gt; 00:17:54,000<br>And for certain applications we can get close to constant time for one of the other operations and that will be useful in different implementations.</p>
<p>120<br>00:17:54,000 –&gt; 00:18:10,000<br>Now there’s an important consideration that we have to bring up related to the programming language. And this is a more general consideration than usually we would bring into focus and algorithms.</p>
<p>121<br>00:18:10,000 –&gt; 00:18:19,000<br>But it’s worthwhile mentioning we’re assuming that the client doesn’t get to change the keys while they’re on the prior to queue.</p>
<p>122<br>00:18:19,000 –&gt; 00:18:28,000<br>And it’s better not to assume that it’s better to arrange for that in our implementations by using keys that are immutable whose values don’t change.</p>
<p>123<br>00:18:28,000 –&gt; 00:18:40,000<br>There’s many reason that immutable keys are that programming languages provide the capability to build immutable keys. And this is a fine example of one.</p>
<p>124<br>00:18:40,000 –&gt; 00:18:54,000<br>So and we’ll talk more about that in a minute. The other things that we didn’t talk about the implementation should throw an exception if the client tries to delete from an empty priority queue.</p>
<p>125<br>00:18:54,000 –&gt; 00:19:08,000<br>And we should have a no argument constructor and use a resizing array to account for gradual growth and shrinkage in an industrial strength implementation.</p>
<p>126<br>00:19:08,000 –&gt; 00:19:19,000<br>Usually we provide two implementations, one that’s max oriented, one that’s min oriented so that nobody gets confused and they’re the same except less and greater switched.</p>
<p>127<br>00:19:19,000 –&gt; 00:19:38,000<br>And we’ll see later on there’s times when we want to expand the API and provide other operations like removing an arbitrary item from the priority queue or give the client in the API the capability of changing the priority of an item.</p>
<p>128<br>00:19:38,000 –&gt; 00:19:50,000<br>Our sync and swim methods are good for making this happen but we’ll delay these implementations until we need them in a more complicated algorithm.</p>
<p>129<br>00:19:50,000 –&gt; 00:20:00,000<br>So what about immutability? So in every thing in Java is implemented as a data type, a set of values and operations on those values.</p>
<p>130<br>00:20:00,000 –&gt; 00:20:14,000<br>And the idea of immutable data type is you can’t change the value once it’s created. So that’s kind of like when you create a literal value to be assigned to an integer, it has that value.</p>
<p>131<br>00:20:14,000 –&gt; 00:20:33,000<br>So here’s an example, say using the data type for vectors might be a way to implement vectors. So we put the word final to means that instance methods can’t be overridden.</p>
<p>132<br>00:20:33,000 –&gt; 00:20:50,000<br>And not only that instance variables are private, they can’t be seen from the outside and they don’t change. And so a constructor for an immutable vector data type, it might take an array as its argument.</p>
<p>133<br>00:20:50,000 –&gt; 00:21:08,000<br>And that array has got value stored in it, say, of bubbles and those can change. But what immutable implementation would do would be to copy those values into the local data array instance variable.</p>
<p>134<br>00:21:08,000 –&gt; 00:21:19,000<br>And then those values are not going to change and the instance methods won’t change them and the client can’t change them. So that value stays the same.</p>
<p>135<br>00:21:19,000 –&gt; 00:21:31,000<br>Lots of implementations, data type implementations in Java are immutable, like strings immutable when you create a string that value doesn’t change.</p>
<p>136<br>00:21:31,000 –&gt; 00:21:43,000<br>If you want a new string, you have to create a new string using concatenation or some other operation. And the same with the wrapper types like integer and double or color and lots of things.</p>
<p>137<br>00:21:43,000 –&gt; 00:21:56,000<br>Whereas on the other hand, sometimes the whole purpose of a data type is to maintain a changing value, like a good example as a counter or a stack.</p>
<p>138<br>00:21:56,000 –&gt; 00:22:04,000<br>So you wouldn’t put those things on a priority queue because the value is changing. But the other ones you would.</p>
<p>139<br>00:22:04,000 –&gt; 00:22:17,000<br>So the advantages of immutability, and again, maybe this isn’t the place to really sell those advantages more for a programming language course, is that it really simplifies debugging.</p>
<p>140<br>00:22:17,000 –&gt; 00:22:28,000<br>We can be, have more confidence that our priority queue operations are going to work correctly if we know that the type of data that’s on the priority queue is immutable.</p>
<p>141<br>00:22:28,000 –&gt; 00:22:40,000<br>If the client can change the values, how do we know that the heap order operation is preserved? If we want the client to be able to change the values, we’re going to provide methods for that purpose, as I just mentioned.</p>
<p>142<br>00:22:40,000 –&gt; 00:22:52,000<br>And there’s many other reasons that people use immutable data types. There is a disadvantage that you have to create a new object for every data type value.</p>
<p>143<br>00:22:52,000 –&gt; 00:22:59,000<br>But for a lot of applications that disadvantage is not viewed to be significant compared to the advantages.</p>
<p>144<br>00:22:59,000 –&gt; 00:23:10,000<br>Here’s a quote from one of Java’s architect, Josh Block. Classes should be immutable unless there’s a very good reason to make them mutable.</p>
<p>145<br>00:23:10,000 –&gt; 00:23:21,000<br>If a class cannot be made immutable, you should still limit its mutability as much as possible. In many programmers, live by that kind of preset.</p>
<p>146<br>00:23:21,000 –&gt; 00:23:31,000<br>So that’s a basic implementation of priority queues using the heap data structure represented as an array.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div></div>
      <div>http://example.com/2025/10/23/P35Part18-04_binary-heaps/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年10月23日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/10/23/P36Part18-05_heapsort/" title="">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile"></span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/10/23/P32Part17-04_duplicate-keys/" title="">
                        <span class="hidden-mobile"></span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
