

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="100:00:00,000 –&gt; 00:00:10,000In this video, we’re going to talk about subtyping, another important idea in cool and other object-oriented languages. 200:00:14,000 –&gt; 00:00:19,000Let’s begin by t">
<meta property="og:type" content="article">
<meta property="og:title" content="CS143 P61Week509 07 A+Subtyping">
<meta property="og:url" content="http://example.com/2025/10/25/CS143%20P61Week509-07-A+Subtyping/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="100:00:00,000 –&gt; 00:00:10,000In this video, we’re going to talk about subtyping, another important idea in cool and other object-oriented languages. 200:00:14,000 –&gt; 00:00:19,000Let’s begin by t">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-10-25T07:38:14.407Z">
<meta property="article:modified_time" content="2025-10-25T07:40:49.224Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>CS143 P61Week509 07 A+Subtyping - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="CS143 P61Week509 07 A+Subtyping"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-10-25 15:38" pubdate>
          2025年10月25日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          650 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          6 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">CS143 P61Week509 07 A+Subtyping</h1>
            
            
              <div class="markdown-body">
                
                <p>1<br>00:00:00,000 –&gt; 00:00:10,000<br>In this video, we’re going to talk about subtyping, another important idea in cool and other object-oriented languages.</p>
<p>2<br>00:00:14,000 –&gt; 00:00:19,000<br>Let’s begin by taking a look at the typing rule for let with initialization.</p>
<p>3<br>00:00:19,000 –&gt; 00:00:22,000<br>So last time we looked at the let rule but didn’t have the initializer,</p>
<p>4<br>00:00:22,000 –&gt; 00:00:26,000<br>and so let’s just see how adding the initializer right here changes things.</p>
<p>5<br>00:00:27,000 –&gt; 00:00:33,000<br>So what’s going to happen here? Well, first of all, notice that the body of the rule is almost the same.</p>
<p>6<br>00:00:33,000 –&gt; 00:00:40,000<br>So we type check E1 in an environment where x has type T0, the type it’s declared to have in the let,</p>
<p>7<br>00:00:40,000 –&gt; 00:00:46,000<br>and all the other variables have whatever type, so it gives them, and we get out some type T1,</p>
<p>8<br>00:00:46,000 –&gt; 00:00:51,000<br>and that will be the type of the whole thing. So this piece right here is exactly the same as before.</p>
<p>9<br>00:00:52,000 –&gt; 00:00:57,000<br>So what’s new is this line where we type check the initializer.</p>
<p>10<br>00:00:57,000 –&gt; 00:01:03,000<br>And so how does that work? Well, first of all, under the assumptions, oh, we type check E0 and we get some type T0.</p>
<p>11<br>00:01:03,000 –&gt; 00:01:10,000<br>And now this is really an aside from the main point, but notice that we use the environment, oh, in particular x,</p>
<p>12<br>00:01:10,000 –&gt; 00:01:14,000<br>the new definition of x is not available in E0.</p>
<p>13<br>00:01:15,000 –&gt; 00:01:23,000<br>So if E0 uses the name x, that means it uses the name of some other x that’s defined outside of the let,</p>
<p>14<br>00:01:23,000 –&gt; 00:01:29,000<br>because we didn’t include this definition of x in the environment for type checking E0.</p>
<p>15<br>00:01:29,000 –&gt; 00:01:35,000<br>All right, now, but the main point, the thing I want to point out on this slide, is that E0 here has type T0,</p>
<p>16<br>00:01:35,000 –&gt; 00:01:40,000<br>which is exactly the same type as x. And that’s a requirement of this rule.</p>
<p>17<br>00:01:40,000 –&gt; 00:01:50,000<br>It says that E0 has to have the same type as x. And that’s actually fairly weak, because there’s really no problem if E0 has a type,</p>
<p>18<br>00:01:50,000 –&gt; 00:01:58,000<br>which is a subtype of T0. T0 can hold any subtype of T0, and that would be absolutely fine.</p>
<p>19<br>00:01:58,000 –&gt; 00:02:07,000<br>But here we’ve limited ourselves to only allowing initializers that exactly match the type of x.</p>
<p>20<br>00:02:07,000 –&gt; 00:02:12,000<br>So we can do better if we introduce the subtyping relation on classes.</p>
<p>21<br>00:02:12,000 –&gt; 00:02:22,000<br>And the most obvious form of subtyping is that if x is a class, and it inherits directly from y, meaning there’s a line in the code that says x inherits from y,</p>
<p>22<br>00:02:22,000 –&gt; 00:02:32,000<br>then x should be a subtype of y. And furthermore, this relationship is transitive. So if x is a subtype of y, and y is a subtype of z, then x is a subtype of z.</p>
<p>23<br>00:02:32,000 –&gt; 00:02:38,000<br>And finally, as you might expect, it’s also reflexive. So every class is a subtype of itself.</p>
<p>24<br>00:02:38,000 –&gt; 00:02:44,000<br>And using subtyping, we can write out a better version of the let rule with initialization.</p>
<p>25<br>00:02:44,000 –&gt; 00:02:52,000<br>So once again, the part of the rule that deals with the body of the let is exactly the same as before. So let’s not look at that.</p>
<p>26<br>00:02:52,000 –&gt; 00:02:57,000<br>And now what we’re going to do is we’re going to type check E0, and we get some type T0 out.</p>
<p>27<br>00:02:57,000 –&gt; 00:03:03,000<br>And then T0 now is only required to be a subtype of t. So this line here is another hypothesis.</p>
<p>28<br>00:03:03,000 –&gt; 00:03:09,000<br>And it just says that T0 has to be a subtype of t. And what is t? Well, t is now the type that x is declared to be.</p>
<p>29<br>00:03:09,000 –&gt; 00:03:19,000<br>So this allows E0 to have a type that’s different from the type of x. And the only issue here is that more programs will type check with this rule in the previous one.</p>
<p>30<br>00:03:19,000 –&gt; 00:03:25,000<br>The previous rule we had was certainly correct. Any program that compiled with that rule would run correctly.</p>
<p>31<br>00:03:25,000 –&gt; 00:03:34,000<br>But this is a more permissive and still correct rule. More programs will compile and type check correctly using this rule.</p>
<p>32<br>00:03:34,000 –&gt; 00:03:43,000<br>Subtyping shows up in a number of places in the cool type system. Here’s the rule for assignment, which is in many ways similar to the rule for let.</p>
<p>33<br>00:03:43,000 –&gt; 00:03:49,000<br>So how does an assignment work? Well, on the left hand side is a variable. On the right hand side is an expression.</p>
<p>34<br>00:03:49,000 –&gt; 00:03:55,000<br>We’re going to evaluate the expression and assign whatever value we get back to the variable on the left hand side.</p>
<p>35<br>00:03:55,000 –&gt; 00:04:03,000<br>And so what how is this type check? Well, first of all, we have to look up the type of x in the environment. And we discovered has some type T0.</p>
<p>36<br>00:04:03,000 –&gt; 00:04:08,000<br>And then we type check E1 in the same environment. So this set of variables here is not changing.</p>
<p>37<br>00:04:08,000 –&gt; 00:04:15,000<br>And so we type check E1 environment. Oh, and we get some type T1. And now what has to be true for this assignment to be correct?</p>
<p>38<br>00:04:15,000 –&gt; 00:04:25,000<br>Well, it has to be possible for x to hold the value of type T1. So x is type T0 has to be a super type, as we bigger than the type of T1.</p>
<p>39<br>00:04:25,000 –&gt; 00:04:32,000<br>So if this constraint is satisfied, then the assignment is correct.</p>
<p>40<br>00:04:32,000 –&gt; 00:04:41,000<br>Another example that uses subtyping is the rule for attribute initialization, which except for the scope of identifiers is very, very similar to the rule for normal assignment.</p>
<p>41<br>00:04:41,000 –&gt; 00:04:52,000<br>So recall what a class looks like. You can declare a class in cool. And it has at the top level some set of attributes and methods.</p>
<p>42<br>00:04:53,000 –&gt; 00:05:03,000<br>And what does an attribute definition look like? Well, it looks like one of these things. It’s a variable declared to have some type. And it can have an initializer on the right hand side.</p>
<p>43<br>00:05:03,000 –&gt; 00:05:15,000<br>And so in what environment then is this initializer type check? Well, it’s a type check in this special environment of sub C, which just consists of the types of all the attributes that are declared in class C.</p>
<p>44<br>00:05:15,000 –&gt; 00:05:29,000<br>So that means we have to make a pass over the class definition, pull out all the attribute definitions, all the names of the variables and their types, build an environment that records all that information, and then we can type check the initializer.</p>
<p>45<br>00:05:29,000 –&gt; 00:05:35,000<br>Because remember, the initializer for an attribute can refer to any of the attributes of the class.</p>
<p>46<br>00:05:35,000 –&gt; 00:05:52,000<br>So let’s take a look at how this works. First, we look up the type of X in the environment that some type T zero. Now we type check E1 in the same environment that some type T1. And then just as with assignment, T1 needs to be a subset or a sub type of the type T zero.</p>
<p>47<br>00:05:53,000 –&gt; 00:06:05,000<br>Now we come to another interesting example, how we type check and if then else. And the important thing about if then else is that when we’re doing type checking, we don’t know which branch is going to be taken.</p>
<p>48<br>00:06:05,000 –&gt; 00:06:18,000<br>We don’t know whether the program is going to execute E1 or E2. And in general, actually this if statement may or this if expression may execute multiple times during a run of the program. And sometimes it may execute E1 other times it may execute E2.</p>
<p>49<br>00:06:19,000 –&gt; 00:06:29,000<br>And so what that means that the resulting type of an if then else is either the type of E1 or the type of E2. And we don’t know at compile time which one is going to be.</p>
<p>50<br>00:06:29,000 –&gt; 00:06:39,000<br>So the best we can do is to say the type of the entire if then else is the smallest super type larger than the type of either E1 or E2.</p>
<p>51<br>00:06:39,000 –&gt; 00:06:51,000<br>The need to compute an upper bound over two or more types comes up often enough that we’re going to give the operation a special name. We’ll call it the love or least upper bound of X and Y.</p>
<p>52<br>00:06:51,000 –&gt; 00:06:58,000<br>And the least upper bound of X and Y is going to be Z if Z is an upper bound. So meaning it’s bigger than both X and Y.</p>
<p>53<br>00:06:58,000 –&gt; 00:07:11,000<br>And also if it is the least among all possible upper bound. So what this line here says that if there is some other Z prime that’s bigger than X and Y well then Z has to be smaller than Z prime.</p>
<p>54<br>00:07:11,000 –&gt; 00:07:25,000<br>So Z is the least. It is the smallest of all the possible upper bounds of X and Y. And in cool and in most obvict oriented languages, the least upper bound of two types is just their least common ancestor in the inheritance tree.</p>
<p>55<br>00:07:25,000 –&gt; 00:07:35,000<br>So typically inheritance tree is rooted at object or some similarly named class that incorporates that includes all the possible classes of the program.</p>
<p>56<br>00:07:35,000 –&gt; 00:07:52,000<br>And then there’s some kind of a hierarchy which is a tree that descends from object. And if I want to find the least upper bound of two types say this type and this type, I just have to walk back through the tree until I find their least common ancestor.</p>
<p>57<br>00:07:52,000 –&gt; 00:07:59,000<br>So in this case, if I pick these two types out of my tree, this would be the least upper bound of those two types.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>CS143 P61Week509 07 A+Subtyping</div>
      <div>http://example.com/2025/10/25/CS143 P61Week509-07-A+Subtyping/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年10月25日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/10/25/CS143%20P66Week610-01-A+Static+vs+Dynamic+Typing/" title="CS143 P66Week610 01 A+Static+vs+Dynamic+Typing">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">CS143 P66Week610 01 A+Static+vs+Dynamic+Typing</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/10/25/CS143%20P60Week509-06-B+Type+Environments/" title="CS143 P60Week509 06 B+Type+Environments">
                        <span class="hidden-mobile">CS143 P60Week509 06 B+Type+Environments</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
