

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="100:00:00,000 –&gt; 00:00:02,000Good evening, good night for every yard. 200:00:02,000 –&gt; 00:00:04,000Let’s get started. 300:00:04,000 –&gt; 00:00:09,000So today I want to talk a little bit about t">
<meta property="og:type" content="article">
<meta property="og:title" content="MIT6824 P11Lecture11 ChainReplication">
<meta property="og:url" content="http://example.com/2025/10/25/MIT6824%20P11Lecture11-ChainReplication/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="100:00:00,000 –&gt; 00:00:02,000Good evening, good night for every yard. 200:00:02,000 –&gt; 00:00:04,000Let’s get started. 300:00:04,000 –&gt; 00:00:09,000So today I want to talk a little bit about t">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-10-25T05:03:39.798Z">
<meta property="article:modified_time" content="2025-10-25T05:03:39.800Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>MIT6824 P11Lecture11 ChainReplication - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="MIT6824 P11Lecture11 ChainReplication"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-10-25 13:03" pubdate>
          2025年10月25日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          12k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          102 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">MIT6824 P11Lecture11 ChainReplication</h1>
            
            
              <div class="markdown-body">
                
                <p>1<br>00:00:00,000 –&gt; 00:00:02,000<br>Good evening, good night for every yard.</p>
<p>2<br>00:00:02,000 –&gt; 00:00:04,000<br>Let’s get started.</p>
<p>3<br>00:00:04,000 –&gt; 00:00:09,000<br>So today I want to talk a little bit about the chain replication paper</p>
<p>4<br>00:00:09,000 –&gt; 00:00:12,000<br>I signed for today from 2004.</p>
<p>5<br>00:00:12,000 –&gt; 00:00:14,000<br>Before diving into the paper,</p>
<p>6<br>00:00:14,000 –&gt; 00:00:17,000<br>a couple of quick logistic things.</p>
<p>7<br>00:00:17,000 –&gt; 00:00:19,000<br>Just want to remind you of.</p>
<p>8<br>00:00:19,000 –&gt; 00:00:24,000<br>One is we have a quiz on first day.</p>
<p>9<br>00:00:24,000 –&gt; 00:00:28,000<br>And you know, the instructions of the topics that actually being covered</p>
<p>10<br>00:00:28,000 –&gt; 00:00:30,000<br>are the quizzes are on the schedule page.</p>
<p>11<br>00:00:30,000 –&gt; 00:00:35,000<br>We’ll try to send out an announcement of the outside with more details about</p>
<p>12<br>00:00:35,000 –&gt; 00:00:38,000<br>exactly how we’ll do the quiz.</p>
<p>13<br>00:00:38,000 –&gt; 00:00:41,000<br>It’s going to be a great scope.</p>
<p>14<br>00:00:41,000 –&gt; 00:00:46,000<br>And it’s basically during class hours or any minutes.</p>
<p>15<br>00:00:46,000 –&gt; 00:00:49,000<br>And more details to follow.</p>
<p>16<br>00:00:49,000 –&gt; 00:00:55,000<br>The second thing I want to remind people of is projects.</p>
<p>17<br>00:00:56,000 –&gt; 00:01:01,000<br>If you would like to do a project instead of lat 4.</p>
<p>18<br>00:01:01,000 –&gt; 00:01:05,000<br>Then you can do so.</p>
<p>19<br>00:01:05,000 –&gt; 00:01:10,000<br>But you submit a proposal for a project and just a couple paragraphs.</p>
<p>20<br>00:01:10,000 –&gt; 00:01:12,000<br>To.</p>
<p>21<br>00:01:12,000 –&gt; 00:01:15,000<br>Through to submission website so that we can give you feedback and sort of tell you</p>
<p>22<br>00:01:15,000 –&gt; 00:01:20,000<br>whether this project actually appropriate for a final project in 8 to 4.</p>
<p>23<br>00:01:20,000 –&gt; 00:01:22,000<br>If you’re just planning to do lat 4,</p>
<p>24<br>00:01:22,000 –&gt; 00:01:25,000<br>there’s absolutely nothing you have to do at all.</p>
<p>25<br>00:01:25,000 –&gt; 00:01:36,000<br>Any questions about these sort of two logistical points.</p>
<p>26<br>00:01:36,000 –&gt; 00:01:37,000<br>Okay.</p>
<p>27<br>00:01:37,000 –&gt; 00:01:42,000<br>Then let me move on to one other point that I wanted to bring up,</p>
<p>28<br>00:01:42,000 –&gt; 00:01:45,000<br>which is the sort of a correction.</p>
<p>29<br>00:01:45,000 –&gt; 00:01:48,000<br>From.</p>
<p>30<br>00:01:48,000 –&gt; 00:01:53,000<br>I’m going to start with a lecture a little while ago.</p>
<p>31<br>00:01:53,000 –&gt; 00:02:00,000<br>We walked through the go code for the raft implementation of two A and two B that I had.</p>
<p>32<br>00:02:00,000 –&gt; 00:02:04,000<br>And we talked a little bit about the go defer statement.</p>
<p>33<br>00:02:04,000 –&gt; 00:02:09,000<br>And I mentioned that you can actually have the defer statement inside of a basic walk.</p>
<p>34<br>00:02:09,000 –&gt; 00:02:11,000<br>And that is correct.</p>
<p>35<br>00:02:11,000 –&gt; 00:02:14,000<br>And I think of Miss maybe it was Philip who asked the question,</p>
<p>36<br>00:02:14,000 –&gt; 00:02:18,000<br>and I think that they get executed and I answered that question incorrectly.</p>
<p>37<br>00:02:18,000 –&gt; 00:02:22,000<br>The first statement gets executed at the point it gets you return out of the function,</p>
<p>38<br>00:02:22,000 –&gt; 00:02:24,000<br>not your turn out of the basic block.</p>
<p>39<br>00:02:24,000 –&gt; 00:02:26,000<br>And so my my apologies.</p>
<p>40<br>00:02:26,000 –&gt; 00:02:30,000<br>It cost any confusion.</p>
<p>41<br>00:02:30,000 –&gt; 00:02:38,000<br>Any questions about the back clarification.</p>
<p>42<br>00:02:38,000 –&gt; 00:02:39,000<br>Okay.</p>
<p>43<br>00:02:39,000 –&gt; 00:02:40,000<br>Good.</p>
<p>44<br>00:02:40,000 –&gt; 00:02:43,000<br>So I’m going to talk about the topics and really the top two technical talks.</p>
<p>45<br>00:02:43,000 –&gt; 00:02:46,000<br>I want to talk to you about today is the zookeeper box,</p>
<p>46<br>00:02:46,000 –&gt; 00:02:49,000<br>which I didn’t get to finish the last time.</p>
<p>47<br>00:02:49,000 –&gt; 00:02:53,000<br>And then I’ll talk about chain replication.</p>
<p>48<br>00:02:53,000 –&gt; 00:02:54,000<br>All right.</p>
<p>49<br>00:02:54,000 –&gt; 00:02:58,000<br>So both for chain replication and zookeeper,</p>
<p>50<br>00:02:58,000 –&gt; 00:03:03,000<br>again, we’re sort of still in the same context as before.</p>
<p>51<br>00:03:03,000 –&gt; 00:03:08,000<br>Namely, we’re doing, you know, replicated state machines.</p>
<p>52<br>00:03:08,000 –&gt; 00:03:11,000<br>Just a usual diagram.</p>
<p>53<br>00:03:11,000 –&gt; 00:03:14,000<br>You know, we have a service, you know, that runs on some,</p>
<p>54<br>00:03:14,000 –&gt; 00:03:20,000<br>you know, replication library like you know, zap or raft.</p>
<p>55<br>00:03:20,000 –&gt; 00:03:23,000<br>We have clients talking to the service,</p>
<p>56<br>00:03:23,000 –&gt; 00:03:26,000<br>example, in the case of, you know, a zookeeper,</p>
<p>57<br>00:03:26,000 –&gt; 00:03:28,000<br>might actually send a create call.</p>
<p>58<br>00:03:28,000 –&gt; 00:03:32,000<br>You know, zookeeper internally has some state, you know, some z-notes,</p>
<p>59<br>00:03:32,000 –&gt; 00:03:35,000<br>you know, that are hanging off in the form of a tree.</p>
<p>60<br>00:03:35,000 –&gt; 00:03:38,000<br>And so when an operation comes in, you know, zookeeper, you know,</p>
<p>61<br>00:03:38,000 –&gt; 00:03:42,000<br>forwards that operation, basically, to the raft,</p>
<p>62<br>00:03:42,000 –&gt; 00:03:45,000<br>zap library, it does some chatting back and forth.</p>
<p>63<br>00:03:45,000 –&gt; 00:03:48,000<br>And to get a majority of the service to accept, you know,</p>
<p>64<br>00:03:48,000 –&gt; 00:03:49,000<br>that command.</p>
<p>65<br>00:03:49,000 –&gt; 00:03:52,000<br>And then at some point, you know, once it’s accepted,</p>
<p>66<br>00:03:52,000 –&gt; 00:03:55,000<br>it comes out, the service, you know, applies the operation.</p>
<p>67<br>00:03:55,000 –&gt; 00:03:57,000<br>And sends a response back to the client.</p>
<p>68<br>00:03:57,000 –&gt; 00:04:00,000<br>And so the same story of replicated state machine,</p>
<p>69<br>00:04:00,000 –&gt; 00:04:02,000<br>if you start all the replicated state machine,</p>
<p>70<br>00:04:02,000 –&gt; 00:04:05,000<br>you start in the same state, you apply the same operation in the same order,</p>
<p>71<br>00:04:05,000 –&gt; 00:04:07,000<br>then you will end up in the same state.</p>
<p>72<br>00:04:07,000 –&gt; 00:04:11,000<br>And so any of the machines can take over if necessary.</p>
<p>73<br>00:04:11,000 –&gt; 00:04:13,000<br>Now, one of the things that was cool about,</p>
<p>74<br>00:04:13,000 –&gt; 00:04:16,000<br>or interesting about zookeeper is that, you know,</p>
<p>75<br>00:04:16,000 –&gt; 00:04:20,000<br>read operations can be served from any service,</p>
<p>76<br>00:04:20,000 –&gt; 00:04:23,000<br>or for any of the peers or any of the one of the service.</p>
<p>77<br>00:04:23,000 –&gt; 00:04:26,000<br>And this allows you to keep it extremely high performance,</p>
<p>78<br>00:04:26,000 –&gt; 00:04:30,000<br>you know, because they can actually scale the number of read operations</p>
<p>79<br>00:04:30,000 –&gt; 00:04:32,000<br>with the number of servers.</p>
<p>80<br>00:04:32,000 –&gt; 00:04:37,000<br>As a flip side of that, you know, zookeeper actually gave up on,</p>
<p>81<br>00:04:37,000 –&gt; 00:04:50,000<br>in that particular scenario, gave up on linearizability.</p>
<p>82<br>00:04:50,000 –&gt; 00:04:52,000<br>Because we know from, you know, for example, in a raft,</p>
<p>83<br>00:04:52,000 –&gt; 00:04:57,000<br>you know, you can’t actually arbitrary server reads from any server.</p>
<p>84<br>00:04:57,000 –&gt; 00:05:00,000<br>Because of that, you have not seen the latest updates yet.</p>
<p>85<br>00:05:00,000 –&gt; 00:05:04,000<br>And so in case of zookeeper that is true too.</p>
<p>86<br>00:05:04,000 –&gt; 00:05:09,000<br>And so read operations are not, you know,</p>
<p>87<br>00:05:09,000 –&gt; 00:05:11,000<br>or the operation that zookeepers define,</p>
<p>88<br>00:05:11,000 –&gt; 00:05:14,000<br>so they don’t provide the linearizable interference.</p>
<p>89<br>00:05:14,000 –&gt; 00:05:17,000<br>But nevertheless, you know, we saw that actually is,</p>
<p>90<br>00:05:17,000 –&gt; 00:05:19,000<br>it provides a slightly different sort of correctness guarantee,</p>
<p>91<br>00:05:19,000 –&gt; 00:05:21,000<br>then linearizability.</p>
<p>92<br>00:05:21,000 –&gt; 00:05:25,000<br>And that actually correctness guarantee is useful.</p>
<p>93<br>00:05:25,000 –&gt; 00:05:28,000<br>And useful enough to be able to write actually programs.</p>
<p>94<br>00:05:28,000 –&gt; 00:05:32,000<br>And the particular set of programs that zookeeper</p>
<p>95<br>00:05:32,000 –&gt; 00:05:40,000<br>is focusing on is what they call configuration or coordination.</p>
<p>96<br>00:05:40,000 –&gt; 00:05:52,000<br>Programs.</p>
<p>97<br>00:05:52,000 –&gt; 00:05:55,000<br>And so the definitively, think about it is that a lot of systems</p>
<p>98<br>00:05:55,000 –&gt; 00:05:58,000<br>that we’ve looked at in the past, they typically have, you know,</p>
<p>99<br>00:05:58,000 –&gt; 00:06:03,000<br>some replication story and then they have a coordinator or a master</p>
<p>100<br>00:06:03,000 –&gt; 00:06:05,000<br>that sort of coordinates the group.</p>
<p>101<br>00:06:05,000 –&gt; 00:06:09,000<br>And zookeepers really intended, you know, for as a server,</p>
<p>102<br>00:06:09,000 –&gt; 00:06:13,000<br>you know, for that kind of, you know, master or coordinator role.</p>
<p>103<br>00:06:13,000 –&gt; 00:06:17,000<br>And it provides a bunch of primitives, you know, to make that dual.</p>
<p>104<br>00:06:17,000 –&gt; 00:06:21,000<br>And the two, you know, we talked a little bit about the atomic increment last week.</p>
<p>105<br>00:06:21,000 –&gt; 00:06:26,000<br>And with some of the other servers and one of the sort of finish off, you know,</p>
<p>106<br>00:06:26,000 –&gt; 00:06:29,000<br>talking about blocks.</p>
<p>107<br>00:06:29,000 –&gt; 00:06:33,000<br>One because there were a lot of questions about it and two that actually is quite interesting.</p>
<p>108<br>00:06:33,000 –&gt; 00:06:36,000<br>And there’s sort of two different rocket limitations.</p>
<p>109<br>00:06:36,000 –&gt; 00:06:40,000<br>And the first one to talk about the simple one, namely where,</p>
<p>110<br>00:06:40,000 –&gt; 00:06:42,000<br>let me just write down the pseudo code.</p>
<p>111<br>00:06:42,000 –&gt; 00:06:45,000<br>And then we can talk about it in a little bit in detail.</p>
<p>112<br>00:06:45,000 –&gt; 00:06:49,000<br>So the pseudo code for.</p>
<p>113<br>00:06:49,000 –&gt; 00:06:52,000<br>The block was something like this, you know,</p>
<p>114<br>00:06:52,000 –&gt; 00:07:01,000<br>acquire in an infinite loop, you know, try to create the lock file.</p>
<p>115<br>00:07:01,000 –&gt; 00:07:11,000<br>Oh, name it LF and set the federal to true.</p>
<p>116<br>00:07:11,000 –&gt; 00:07:16,000<br>And we’ll talk about that in second, why, you know, if the create succeeds.</p>
<p>117<br>00:07:16,000 –&gt; 00:07:28,000<br>Then, you know, the that process where that client was the first one to create that file and basically successfully gets the lock and so it breaks out of the for loop and returns.</p>
<p>118<br>00:07:28,000 –&gt; 00:07:35,000<br>If the client did not, you know, we able to create a file, then it calls exists.</p>
<p>119<br>00:07:35,000 –&gt; 00:07:42,000<br>And the call to exist is not really for, you know, see if it exists or not because, you know, we know it doesn’t exist.</p>
<p>120<br>00:07:42,000 –&gt; 00:07:48,000<br>And then we can see the two set of watch.</p>
<p>121<br>00:07:48,000 –&gt; 00:07:55,000<br>And the idea is that, you know, the watch will go off if actually the file disappears.</p>
<p>122<br>00:07:55,000 –&gt; 00:08:10,000<br>And if it disappears and you know, the client will get a notification is so basically, we’re going to be doing here is just wait for that notification.</p>
<p>123<br>00:08:10,000 –&gt; 00:08:17,000<br>And then the release is very simple.</p>
<p>124<br>00:08:17,000 –&gt; 00:08:26,000<br>The release basically is does nothing else than sending the delete operation to the zookeeper service, you know, for the for the lock file.</p>
<p>125<br>00:08:26,000 –&gt; 00:08:28,000<br>So LF in this case.</p>
<p>126<br>00:08:28,000 –&gt; 00:08:44,000<br>And so what does that do? Well, if the delete, you know, sent to the zookeeper service, you know, the zookeeper service, the performs the deed operation that will actually let the that make the file would go away that will fire the watch.</p>
<p>127<br>00:08:44,000 –&gt; 00:08:53,000<br>And so every client that actually is waiting, you know, for the notification will get a notification and then they go retry.</p>
<p>128<br>00:08:53,000 –&gt; 00:08:58,000<br>You know, one of them will be successful on the retry will get the lock file or create the lock file and then proceed.</p>
<p>129<br>00:08:58,000 –&gt; 00:09:07,000<br>And then the others ones, you know, we’ll go back into their call exists and going to wait for a notification.</p>
<p>130<br>00:09:07,000 –&gt; 00:09:22,000<br>And the zookeeper semantics, you know, are good enough, you know, the strong, the linear, the linearized ability for right operations, plus, you know, the rules for when notifications go off are strong enough that basically this actually implements a faithful lock.</p>
<p>131<br>00:09:22,000 –&gt; 00:09:27,000<br>We’re only one client. If there are many clients at the same time trying to get the lock only one will get it.</p>
<p>132<br>00:09:27,000 –&gt; 00:09:35,000<br>And you know, one the release is done or when the file has been deleted, only one in the next round will get it.</p>
<p>133<br>00:09:35,000 –&gt; 00:09:37,000<br>And so that’s sort of cool.</p>
<p>134<br>00:09:37,000 –&gt; 00:09:46,000<br>And it’s interesting that you could build, you know, sort of sort of sort of disfundational primitive using the primitives that zookeeper offers.</p>
<p>135<br>00:09:46,000 –&gt; 00:10:01,000<br>And you see here, both the role of the watch and then there’s the second role for the elephant, you know, the, and federal is there because what happens if a client fails to crash before calls release.</p>
<p>136<br>00:10:01,000 –&gt; 00:10:14,000<br>And the semantics of the federal file is that the zookeeper service will, if it decides that the client has crashed and will do the operation, it will remove the file on behalf of the client.</p>
<p>137<br>00:10:14,000 –&gt; 00:10:28,000<br>So even if the clients fails or crashes, the zookeeper serves the site, you know, at some point the client is done and then that will remove this file lock F, which will cause notifications to be sent to the clients that actually are waiting for it.</p>
<p>138<br>00:10:28,000 –&gt; 00:10:36,000<br>So it’s a cool set of primitives to build in a powerful abstraction that can be useful in applications.</p>
<p>139<br>00:10:36,000 –&gt; 00:10:45,000<br>One downside of this particular implementation is that has what’s called a hurting effect.</p>
<p>140<br>00:10:45,000 –&gt; 00:10:53,000<br>And then, you know, let’s say you have a thousand clients, the owner, the, the lock file or make the lock file acquired the lock.</p>
<p>141<br>00:10:53,000 –&gt; 00:11:00,000<br>Now one is going to succeed and 9999 are going to call exists and wait for a notification.</p>
<p>142<br>00:11:00,000 –&gt; 00:11:11,000<br>And then when the first client deletes the file or releases the file lock, 9999 are going to try to actually acquire the lock.</p>
<p>143<br>00:11:11,000 –&gt; 00:11:16,000<br>And of course, only one is going to succeed and then 9998 are going to be sitting for notification.</p>
<p>144<br>00:11:16,000 –&gt; 00:11:24,000<br>But you know, this, you know, every sort of random design, it’s a huge amount of traffic.</p>
<p>145<br>00:11:24,000 –&gt; 00:11:35,000<br>And you know, basically bombarding the zookeeper surface, right? Because 9999, we do it again and you know, all the one are going to fail.</p>
<p>146<br>00:11:35,000 –&gt; 00:11:40,000<br>So that’s a little bit of an undesirable property is just hurting effect.</p>
<p>147<br>00:11:40,000 –&gt; 00:11:51,000<br>And it’s a real problem in practice, you know, both on small scale multi core machines as well, of course, in a setting like this, where you know, messages are not free.</p>
<p>148<br>00:11:51,000 –&gt; 00:12:01,000<br>So it’s interesting that actually zookeeper provides enough primitives that you could actually do quite a bit better that you can actually build a lock that doesn’t have suffer from the hurting effect.</p>
<p>149<br>00:12:01,000 –&gt; 00:12:09,000<br>So a better lock.</p>
<p>150<br>00:12:09,000 –&gt; 00:12:13,000<br>And it’s interesting. Let me pull up the.</p>
<p>151<br>00:12:13,000 –&gt; 00:12:22,000<br>Shoot a code for this, which is in the paper, so we can look at it and discuss, you know, why you know this lock is better.</p>
<p>152<br>00:12:22,000 –&gt; 00:12:38,000<br>And particularly what we’ll see is that this lock is better because basically there’s no, there’s no retry where all clients that didn’t succeed to getting the lock will retry to try to get instead, you know, basically the all the clients are sort of form of line.</p>
<p>153<br>00:12:38,000 –&gt; 00:12:41,000<br>And they get the log one by one.</p>
<p>154<br>00:12:41,000 –&gt; 00:12:48,000<br>And the way, you know, that you can program that using zookeeper primitives is in this particular pseudo code.</p>
<p>155<br>00:12:48,000 –&gt; 00:12:52,000<br>And there are a couple differences there, compare to the previous one.</p>
<p>156<br>00:12:52,000 –&gt; 00:12:56,000<br>First of all, the.</p>
<p>157<br>00:12:56,000 –&gt; 00:13:03,000<br>There’s an additional flag, you know, past to create, namely sequential, which basically means that every.</p>
<p>158<br>00:13:03,000 –&gt; 00:13:17,000<br>These files are created. The box file is created, but it will be created as, you know, the first one will be log zero, then the next one will be lock one, etc.</p>
<p>159<br>00:13:17,000 –&gt; 00:13:29,000<br>So we have like, you know, a thousand clients rushing, you know, to the service directly to require the walk, basically a thousand files will be created, all numbered from zero to 9999.</p>
<p>160<br>00:13:29,000 –&gt; 00:13:40,000<br>And then, so I’ll succeed in creating a file, the creative returns actually the number that you got.</p>
<p>161<br>00:13:40,000 –&gt; 00:13:47,000<br>So the client zero, if the first client gets no lock craze log zero, then it will get a zero back.</p>
<p>162<br>00:13:47,000 –&gt; 00:13:50,000<br>And the second one get a one back, etc.</p>
<p>163<br>00:13:50,000 –&gt; 00:14:00,000<br>Then, you know, the pseudo code basically ask you to get all the children in that directory under which, you know, these files are created. And so in this case, maybe that would be a thousand.</p>
<p>164<br>00:14:00,000 –&gt; 00:14:03,000<br>Children, a thousand zero notes.</p>
<p>165<br>00:14:03,000 –&gt; 00:14:11,000<br>And then you can just look at the end and see if you’re in, you know, in this case, zero is the low Z note is see.</p>
<p>166<br>00:14:11,000 –&gt; 00:14:14,000<br>And if that’s the case, that means you got the lock.</p>
<p>167<br>00:14:14,000 –&gt; 00:14:21,000<br>And so that makes totally sense, correct? The first line gets actually zero back all the other clients have a higher number because they’re going to be numbered.</p>
<p>168<br>00:14:21,000 –&gt; 00:14:32,000<br>And so the first client will succeed in getting it and all the other ones what they’re going to do is they’re going to look at, they’re going to find the p, you know, the number that is right in front of them.</p>
<p>169<br>00:14:32,000 –&gt; 00:14:43,000<br>So, for example, if this is client that got back, you know, lock 10, it’s going to look, you know, for zero nine, you know, lock nine and basically put a watch on that file.</p>
<p>170<br>00:14:43,000 –&gt; 00:14:55,000<br>So this means that every client will have a watch basically on its predecessor. So it’s going to see that sort of all the clients form a line.</p>
<p>171<br>00:14:55,000 –&gt; 00:15:01,000<br>And then the client is going to wait for that notification to go off.</p>
<p>172<br>00:15:01,000 –&gt; 00:15:09,000<br>And so that means, for example, when client zero, you know, we got the zero back, you know, releases the lock will delete in.</p>
<p>173<br>00:15:09,000 –&gt; 00:15:13,000<br>This will get a notification to go off for the file one.</p>
<p>174<br>00:15:13,000 –&gt; 00:15:25,000<br>And so the client is actually waiting for that particular notification, then we’ll run, but it’s the only one that runs and it will succeed.</p>
<p>175<br>00:15:25,000 –&gt; 00:15:34,000<br>And so here we see, you know, this is sometimes these are types of locks are called ticket locks in multi core programming, if you’re familiar with them.</p>
<p>176<br>00:15:34,000 –&gt; 00:15:43,000<br>And they have sort of the same, the sort of the same idea of sort of ticket locks is actually sort of building into this using zookeeper primitives.</p>
<p>177<br>00:15:43,000 –&gt; 00:15:52,000<br>And again, what is interesting about it is that, you know, these primitives are powerful enough that you can actually build these kind of locks.</p>
<p>178<br>00:15:52,000 –&gt; 00:15:58,000<br>So we’re going to have this.</p>
<p>179<br>00:15:58,000 –&gt; 00:16:07,000<br>Okay, I want to make one more comment, you know, about these locks before moving on to chain replication, we have a question in the chat.</p>
<p>180<br>00:16:07,000 –&gt; 00:16:09,000<br>Yeah, okay, much the question in the chat.</p>
<p>181<br>00:16:09,000 –&gt; 00:16:18,000<br>What is the watch for online for good, go back on this for line for.</p>
<p>182<br>00:16:18,000 –&gt; 00:16:21,000<br>I think that’s the question.</p>
<p>183<br>00:16:21,000 –&gt; 00:16:27,000<br>Well, that watch my comment of the watch is actually should go with you know line five.</p>
<p>184<br>00:16:27,000 –&gt; 00:16:30,000<br>So there’s no watch online for right.</p>
<p>185<br>00:16:30,000 –&gt; 00:16:40,000<br>Line for just finds P, you know, the number that’s right before you know you’re in.</p>
<p>186<br>00:16:40,000 –&gt; 00:16:44,000<br>If that doesn’t answer the question, please, if you’ll come back later at this fine.</p>
<p>187<br>00:16:44,000 –&gt; 00:16:46,000<br>So we have another question.</p>
<p>188<br>00:16:46,000 –&gt; 00:16:54,000<br>Yeah, this is going actually I think back a few slides, but how does zookeeper determined that the client has failed and thus release the ephemeral lock.</p>
<p>189<br>00:16:54,000 –&gt; 00:16:58,000<br>I think it’s just like partitions for a moment.</p>
<p>190<br>00:16:58,000 –&gt; 00:17:01,000<br>Yeah, so that could be happened.</p>
<p>191<br>00:17:01,000 –&gt; 00:17:04,000<br>So the client might actually sort of the client has a session, right?</p>
<p>192<br>00:17:04,000 –&gt; 00:17:07,000<br>We have the zookeeper service.</p>
<p>193<br>00:17:07,000 –&gt; 00:17:13,000<br>And the client needs to actually do zookeeper and the client basically saying heartbeat to each other.</p>
<p>194<br>00:17:13,000 –&gt; 00:17:18,000<br>And you have the zookeeper service doesn’t hear from the client for a little while.</p>
<p>195<br>00:17:18,000 –&gt; 00:17:22,000<br>Then it just decides the client is down in the closest to session.</p>
<p>196<br>00:17:22,000 –&gt; 00:17:27,000<br>And so the client can try to send messages on the session, but the session is just close is gone.</p>
<p>197<br>00:17:27,000 –&gt; 00:17:35,000<br>In any files that were created in the ephemeral info, ephemeral files that were created during that section are basically deleted.</p>
<p>198<br>00:17:35,000 –&gt; 00:17:47,000<br>And so if the network reconvenes or heals, then the client will try to send messages over that session and basically the zookeeper service will say like, oh, that session doesn’t exist anymore.</p>
<p>199<br>00:17:47,000 –&gt; 00:17:51,000<br>You got to retry or restart a new session.</p>
<p>200<br>00:17:51,000 –&gt; 00:17:54,000<br>Got it. Thank you.</p>
<p>201<br>00:17:54,000 –&gt; 00:18:01,000<br>Okay, good. So there’s one important point about these what I call zealocks, where zookeeper locks.</p>
<p>202<br>00:18:01,000 –&gt; 00:18:10,000<br>And that is they’re not the same or have similar semantic as it like the locks that you were using or go locks or mute textures.</p>
<p>203<br>00:18:10,000 –&gt; 00:18:19,000<br>And sort of an important point to realize, even though they’re different, we’ll see in a second, they’re still useful, but they’re not as strong as the sort of the go locks.</p>
<p>204<br>00:18:19,000 –&gt; 00:18:24,000<br>In particular, the case is that there’s interesting is like when the lock holder fails.</p>
<p>205<br>00:18:24,000 –&gt; 00:18:33,000<br>Or basically zookeepers decides that lock head holder has failed, correct? That’s what we just discussed.</p>
<p>206<br>00:18:33,000 –&gt; 00:18:43,000<br>Then it is possible that we’re going to see some intermediate state.</p>
<p>207<br>00:18:43,000 –&gt; 00:18:49,000<br>And remember like what the whole rule about locks is like, you know, it’s a critical section, you know, you’re some invariant is true.</p>
<p>208<br>00:18:49,000 –&gt; 00:18:57,000<br>And while you’re going through the critical section, something that invariant might not be true, but then at the end, you can reestablish the barrier.</p>
<p>209<br>00:18:57,000 –&gt; 00:19:06,000<br>In here, it’s the case like you required lock, client requires lock, does some steps. And then you know, maybe zookeeper decides that the client is decided to climb this crash.</p>
<p>210<br>00:19:06,000 –&gt; 00:19:14,000<br>And basically revokes lock, but you know, the state, you know, the system might actually be some intermediate state for which you’re not interviewing was not true.</p>
<p>211<br>00:19:14,000 –&gt; 00:19:22,000<br>So it’s not the case that basically these logs guarantee at the density of a critical section.</p>
<p>212<br>00:19:22,000 –&gt; 00:19:29,000<br>So what they do what they use will for.</p>
<p>213<br>00:19:29,000 –&gt; 00:19:34,000<br>Yes, for some other purposes.</p>
<p>214<br>00:19:34,000 –&gt; 00:19:44,000<br>So we have to sort of to primary use cases one, I think is leader election.</p>
<p>215<br>00:19:44,000 –&gt; 00:19:53,000<br>So basically, when we have a set of clients that need to select the leader among them, you know, we can all try to basically create the lock file.</p>
<p>216<br>00:19:53,000 –&gt; 00:19:57,000<br>One of them succeed. That’s basically down to come to leader.</p>
<p>217<br>00:19:57,000 –&gt; 00:20:02,000<br>So to clean up any intermediate state, possibly necessary.</p>
<p>218<br>00:20:02,000 –&gt; 00:20:11,000<br>Or, you know, do these atomic updates using the ready trick where basically you do a bunch of rights, you know, to some file, but then you expose the file only at the very end.</p>
<p>219<br>00:20:11,000 –&gt; 00:20:17,000<br>And that way make a set of rights actually more transactional.</p>
<p>220<br>00:20:17,000 –&gt; 00:20:20,000<br>So that’s one use case for these kind of locks.</p>
<p>221<br>00:20:20,000 –&gt; 00:20:28,000<br>And use cases what I will call soft locks.</p>
<p>222<br>00:20:28,000 –&gt; 00:20:36,000<br>The way to think about it is that let’s say we have a worker in like in the map reduce style and the map.</p>
<p>223<br>00:20:36,000 –&gt; 00:20:44,000<br>And we want to basically arrange that, you know, every work actually, particular map tasks only once.</p>
<p>224<br>00:20:44,000 –&gt; 00:20:52,000<br>And one way to do that would be basically take a walk out, you know, for that particular input file run, you know, the computation.</p>
<p>225<br>00:20:52,000 –&gt; 00:20:57,000<br>And then once the map is done, then you release the lock file.</p>
<p>226<br>00:20:57,000 –&gt; 00:21:05,000<br>So this will cause only one map or two in the common case to execute a particular task.</p>
<p>227<br>00:21:05,000 –&gt; 00:21:11,000<br>And that’s exactly sort of what we want, but of course, you know, if the map will fail, then the walk will be released.</p>
<p>228<br>00:21:11,000 –&gt; 00:21:16,000<br>And then, you know, we might execute it the second time it’s crystal many else will try to require a block.</p>
<p>229<br>00:21:16,000 –&gt; 00:21:20,000<br>And so in that case, you know, for the case of map produce, that’s perfectly fine, right?</p>
<p>230<br>00:21:20,000 –&gt; 00:21:25,000<br>It’s okay if the task gets executed twice.</p>
<p>231<br>00:21:25,000 –&gt; 00:21:30,000<br>It happens twice.</p>
<p>232<br>00:21:30,000 –&gt; 00:21:38,000<br>In some ways, what it really is, it’s more a performance optimization that in a usual case, you want to take a one of that, it actually is executed only once.</p>
<p>233<br>00:21:38,000 –&gt; 00:21:42,000<br>But, you know, if there’s a failure, it might be the case that you’re executing a map job twice.</p>
<p>234<br>00:21:42,000 –&gt; 00:21:48,000<br>And it’s not painting, you know, and the map produce men’s if you set up in such a way that actually that is, that’s okay.</p>
<p>235<br>00:21:48,000 –&gt; 00:21:53,000<br>And so in those cases, these sort of locks are really useful to.</p>
<p>236<br>00:21:53,000 –&gt; 00:21:56,000<br>So many questions about this, that the.</p>
<p>237<br>00:21:56,000 –&gt; 00:22:05,000<br>Disperspective for a locks, you know, that does you keep a watch or not exactly like the go locks and, you know, just important thing to keep in mind.</p>
<p>238<br>00:22:05,000 –&gt; 00:22:08,000<br>Yeah, go ahead, Alexandra, I guess.</p>
<p>239<br>00:22:08,000 –&gt; 00:22:17,000<br>Yeah, I had a question you said that one of the differences is that in in Z locks, the.</p>
<p>240<br>00:22:17,000 –&gt; 00:22:25,000<br>If the server holding the lock dies, then the lock can be revoked, but.</p>
<p>241<br>00:22:25,000 –&gt; 00:22:31,000<br>Does that still happen if you don’t pass them, because there’s that flag.</p>
<p>242<br>00:22:31,000 –&gt; 00:22:33,000<br>Called yeah, FMR.</p>
<p>243<br>00:22:33,000 –&gt; 00:22:34,000<br>Yeah, FMR.</p>
<p>244<br>00:22:34,000 –&gt; 00:22:36,000<br>Yeah, it happens with the FMR.</p>
<p>245<br>00:22:36,000 –&gt; 00:22:43,000<br>Right. So can we just like emulate the go logs by not passing the FMR.</p>
<p>246<br>00:22:43,000 –&gt; 00:22:46,000<br>Okay, good one would happen then.</p>
<p>247<br>00:22:46,000 –&gt; 00:22:51,000<br>So you create basically a persistent file, the client dies.</p>
<p>248<br>00:22:51,000 –&gt; 00:22:54,000<br>You said that lock.</p>
<p>249<br>00:22:54,000 –&gt; 00:22:59,000<br>And so the lock will keep on existing and nobody will release it.</p>
<p>250<br>00:22:59,000 –&gt; 00:23:02,000<br>And we have a deathlock.</p>
<p>251<br>00:23:02,000 –&gt; 00:23:07,000<br>Because the one person that could release it is dead.</p>
<p>252<br>00:23:07,000 –&gt; 00:23:09,000<br>Or crashed.</p>
<p>253<br>00:23:09,000 –&gt; 00:23:14,000<br>And in fact, this is like why I get FMR or part is there.</p>
<p>254<br>00:23:14,000 –&gt; 00:23:17,000<br>Is it actually the only.</p>
<p>255<br>00:23:17,000 –&gt; 00:23:21,000<br>The only person to cover these it because anyone can delete that file, right?</p>
<p>256<br>00:23:21,000 –&gt; 00:23:24,000<br>Could you have a word like our background like.</p>
<p>257<br>00:23:24,000 –&gt; 00:23:33,000<br>But that would break, but that would break, you know, maybe the other client is still running and also still thinks it holds the lock.</p>
<p>258<br>00:23:33,000 –&gt; 00:23:34,000<br>Sure.</p>
<p>259<br>00:23:34,000 –&gt; 00:23:36,000<br>You guys are getting a sort of addition.</p>
<p>260<br>00:23:36,000 –&gt; 00:23:39,000<br>So you’re this is the consensus problem all over again.</p>
<p>261<br>00:23:39,000 –&gt; 00:23:41,000<br>Right.</p>
<p>262<br>00:23:41,000 –&gt; 00:23:45,000<br>And you know, we.</p>
<p>263<br>00:23:45,000 –&gt; 00:23:48,000<br>So this is sort of a clean way to get most of it.</p>
<p>264<br>00:23:48,000 –&gt; 00:23:51,000<br>But not all of it, if you will.</p>
<p>265<br>00:23:51,000 –&gt; 00:23:56,000<br>And I think you know, if you want to make things atomic across a number of, you know, a set of rights atomic.</p>
<p>266<br>00:23:56,000 –&gt; 00:24:02,000<br>You basically use this trick of.</p>
<p>267<br>00:24:02,000 –&gt; 00:24:11,000<br>Basically, the ready trick where you do a bunch of rights and then you expose them at the same time.</p>
<p>268<br>00:24:11,000 –&gt; 00:24:14,000<br>Could you explain those soft locks again?</p>
<p>269<br>00:24:14,000 –&gt; 00:24:19,000<br>Okay, soft locks means that basically an operation can happen twice.</p>
<p>270<br>00:24:19,000 –&gt; 00:24:28,000<br>And so in the common case, if there’s no crash, it will happen once, you know, because the client will take a walk out will do the operation, release.</p>
<p>271<br>00:24:28,000 –&gt; 00:24:42,000<br>And, but if they’re client failed halfway through, for example, then the lock would be automatically released by zookeeper and then maybe a second, you know, client will execute the same math test.</p>
<p>272<br>00:24:42,000 –&gt; 00:24:47,000<br>And the case of literal election, I was intermediate state that could get exposed here.</p>
<p>273<br>00:24:47,000 –&gt; 00:24:49,000<br>It’s is that first, yeah.</p>
<p>274<br>00:24:49,000 –&gt; 00:24:55,000<br>I guess in the pure leader election, it would be no intermediate state, but typically the leader will create a configuration file, right?</p>
<p>275<br>00:24:55,000 –&gt; 00:25:00,000<br>As we saw in zookeeper, we’re, you know, using the ready trick.</p>
<p>276<br>00:25:00,000 –&gt; 00:25:05,000<br>I see. And so you just write the whole file and then convert it to me.</p>
<p>277<br>00:25:05,000 –&gt; 00:25:06,000<br>Yep.</p>
<p>278<br>00:25:06,000 –&gt; 00:25:07,000<br>Thank you.</p>
<p>279<br>00:25:07,000 –&gt; 00:25:12,000<br>Sorry, could you explain what the ready trick is?</p>
<p>280<br>00:25:12,000 –&gt; 00:25:16,000<br>I was hoping not to because I think we talked about last night.</p>
<p>281<br>00:25:16,000 –&gt; 00:25:17,000<br>Sorry.</p>
<p>282<br>00:25:17,000 –&gt; 00:25:26,000<br>So maybe we, you can hold that question and we’ll I’m happy to do that in the lecture again.</p>
<p>283<br>00:25:26,000 –&gt; 00:25:36,000<br>Because otherwise, I have a little time to actually talk about the chain replication.</p>
<p>284<br>00:25:36,000 –&gt; 00:25:41,000<br>Any other last minutes, questions.</p>
<p>285<br>00:25:41,000 –&gt; 00:25:49,000<br>Let me set the stage where chain replication a little bit and then I will also come back to zookeeper in some sense.</p>
<p>286<br>00:25:49,000 –&gt; 00:25:55,000<br>And basically turns out there’s sort of two common approaches to build replicated state machines.</p>
<p>287<br>00:25:55,000 –&gt; 00:25:58,000<br>And we really haven’t called out these two approaches.</p>
<p>288<br>00:25:58,000 –&gt; 00:26:03,000<br>We’ve seen them, but I really talked explicitly about them. I want to do this in this time explicitly.</p>
<p>289<br>00:26:03,000 –&gt; 00:26:08,000<br>Because there’s some interesting observations to be made.</p>
<p>290<br>00:26:08,000 –&gt; 00:26:15,000<br>Approaches to building replicated state machines.</p>
<p>291<br>00:26:15,000 –&gt; 00:26:25,000<br>And the first one is the one we basically have seen in the labs, which is you run all operations.</p>
<p>292<br>00:26:25,000 –&gt; 00:26:30,000<br>You know, you know, route raft.</p>
<p>293<br>00:26:30,000 –&gt; 00:26:38,000<br>Raffed or you keep a raft or you know, access, whatever, you know, consensus, you know, distribute consensus algorithm that you’re using.</p>
<p>294<br>00:26:38,000 –&gt; 00:26:41,000<br>And so this is sort of like the key value store.</p>
<p>295<br>00:26:41,000 –&gt; 00:26:42,000<br>Right.</p>
<p>296<br>00:26:42,000 –&gt; 00:26:45,000<br>And last three were, you know, you do put a good operation.</p>
<p>297<br>00:26:45,000 –&gt; 00:26:48,000<br>You run all the putting get operations through raft.</p>
<p>298<br>00:26:48,000 –&gt; 00:26:53,000<br>And, you know, the service is basically update, you know, the key value store state as they.</p>
<p>299<br>00:26:53,000 –&gt; 00:26:56,000<br>Operations are coming in on the apply channel.</p>
<p>300<br>00:26:56,000 –&gt; 00:27:01,000<br>And, you know, and basically we have our replicated state issue.</p>
<p>301<br>00:27:01,000 –&gt; 00:27:06,000<br>So this is sort of like how lab free works.</p>
<p>302<br>00:27:06,000 –&gt; 00:27:12,000<br>It turns out that style or basically raft is used to also run all the operations.</p>
<p>303<br>00:27:12,000 –&gt; 00:27:14,000<br>It’s actually not that common.</p>
<p>304<br>00:27:14,000 –&gt; 00:27:18,000<br>We’ll see some other designs later in semester to do that too. Like the standard does it.</p>
<p>305<br>00:27:18,000 –&gt; 00:27:34,000<br>But it’s not actually completely the standard approach or the more common approach actually is to have a configuration server like zookeeper.</p>
<p>306<br>00:27:34,000 –&gt; 00:27:42,000<br>Service and the configuration service itself internally, you know, like you use access raft or.</p>
<p>307<br>00:27:42,000 –&gt; 00:27:44,000<br>And we have the same data or whatever.</p>
<p>308<br>00:27:44,000 –&gt; 00:27:53,000<br>And really the configuration services really place the role of the coordinator or the master like the GFS master.</p>
<p>309<br>00:27:53,000 –&gt; 00:28:02,000<br>And in addition to basically having configuration service that is actually implemented using, you know, one of these raft patches algorithms.</p>
<p>310<br>00:28:02,000 –&gt; 00:28:13,000<br>And then you actually run a primary backup replication.</p>
<p>311<br>00:28:13,000 –&gt; 00:28:21,000<br>And so we can think about GFS or that we saw early in the semester has that sort of structure right in the GFS that was a master.</p>
<p>312<br>00:28:21,000 –&gt; 00:28:26,000<br>And that basically determined, you know, which set of service hold the particular chunk.</p>
<p>313<br>00:28:26,000 –&gt; 00:28:41,000<br>And then the replica chunk group basically actually to the primary backup replication one of the chunks was the primary and the other ones were the backups and they basically had a protocol that they use for primary backup replication.</p>
<p>314<br>00:28:41,000 –&gt; 00:28:49,000<br>And you can think about VM PT in a similar style where configuration server is basically a test and set server, you know, which basically recorded who was actually the primary.</p>
<p>315<br>00:28:49,000 –&gt; 00:28:55,000<br>And then the primary and the backup have a protocol to basically send, you know, channel operation down the channel.</p>
<p>316<br>00:28:55,000 –&gt; 00:29:03,000<br>And so that the primary and backup is sort of roughly in sync and implement a replicate state and sheet.</p>
<p>317<br>00:29:03,000 –&gt; 00:29:11,000<br>And this approach tends to be sort of the more common approach.</p>
<p>318<br>00:29:11,000 –&gt; 00:29:15,000<br>Although, you know, the approach number one also happens.</p>
<p>319<br>00:29:15,000 –&gt; 00:29:20,000<br>One way one way to think about this is that, you know,</p>
<p>320<br>00:29:20,000 –&gt; 00:29:29,000<br>if the raft state like for example, our key value server in left free would be gigantic, you know, how new to mind of this state, you know, terabytes of the key value server.</p>
<p>321<br>00:29:29,000 –&gt; 00:29:35,000<br>Would draft be very good match for that kind of application.</p>
<p>322<br>00:29:35,000 –&gt; 00:29:39,000<br>Or what is the risk.</p>
<p>323<br>00:29:39,000 –&gt; 00:29:48,000<br>Or the potential problem.</p>
<p>324<br>00:29:48,000 –&gt; 00:29:54,000<br>And so, you know, we flush the log very often. So maybe that could be problematic.</p>
<p>325<br>00:29:54,000 –&gt; 00:30:00,000<br>That could be problematic. Yeah. Like what is the, what’s the size of the checkpoint.</p>
<p>326<br>00:30:00,000 –&gt; 00:30:05,000<br>If our key value server is really big.</p>
<p>327<br>00:30:05,000 –&gt; 00:30:08,000<br>It’s linear in the size of the key values to work.</p>
<p>328<br>00:30:08,000 –&gt; 00:30:15,000<br>Yeah, so it’s good also be gigantic. Right. So if any, you know, if any time the checkpoint has to be sent, you know, that’s going to be a big checkpoint.</p>
<p>329<br>00:30:15,000 –&gt; 00:30:19,000<br>And sort of like raft is not really sort of set up, you know, to do.</p>
<p>330<br>00:30:19,000 –&gt; 00:30:26,000<br>And so the primary is going to communicate, you know, the new primary is going to communicate these snapshots if you didn’t lock to D, you know, to the backups.</p>
<p>331<br>00:30:26,000 –&gt; 00:30:28,000<br>Then you know, they’re going to be big.</p>
<p>332<br>00:30:28,000 –&gt; 00:30:35,000<br>And so you often want to maybe a little bit more clever plan to sort of synchronize, you know, re synchronize new servers.</p>
<p>333<br>00:30:35,000 –&gt; 00:30:42,000<br>And so one reason that basically often these things are split into two different pieces where it is the configuration server.</p>
<p>334<br>00:30:42,000 –&gt; 00:30:51,000<br>So basically small turn to state. And then you’re a primary backup plan that actually, you know, may replicate huge amount of data.</p>
<p>335<br>00:30:51,000 –&gt; 00:30:55,000<br>And so this is why one reason you see sort of both approaches.</p>
<p>336<br>00:30:55,000 –&gt; 00:30:58,000<br>Does that make sense?</p>
<p>337<br>00:30:58,000 –&gt; 00:31:00,000<br>I’ll come back to that at the end of the lecture again.</p>
<p>338<br>00:31:00,000 –&gt; 00:31:03,000<br>But it’s important to keep this in mind.</p>
<p>339<br>00:31:03,000 –&gt; 00:31:08,000<br>So what approach or what benefits does one give over two?</p>
<p>340<br>00:31:08,000 –&gt; 00:31:10,000<br>You don’t have to have two of them.</p>
<p>341<br>00:31:10,000 –&gt; 00:31:16,000<br>Right. And one, you basically have raft, you run the operation forward fruit and then just the configuration for you to.</p>
<p>342<br>00:31:16,000 –&gt; 00:31:20,000<br>So everything is in a single single component.</p>
<p>343<br>00:31:20,000 –&gt; 00:31:31,000<br>And here in number two, we have two components. You know, we have a configuration service that includes raft and we have a primary backup scheme.</p>
<p>344<br>00:31:31,000 –&gt; 00:31:37,000<br>So maybe we’ll come, we’ll come earlier as I talk about chain replication.</p>
<p>345<br>00:31:37,000 –&gt; 00:31:45,000<br>Yeah, I had, I had really quick question. So like essentially for tool, I guess would like what the advantage be that you have like.</p>
<p>346<br>00:31:45,000 –&gt; 00:31:49,000<br>It’s consensus reached through the leader. And the leader never fails, right?</p>
<p>347<br>00:31:49,000 –&gt; 00:31:58,000<br>Like, yeah. So the, the, the adventure to is that as we’ll see in a second in chain replication is there’s sort of a separate process that takes care of the configuration park.</p>
<p>348<br>00:31:58,000 –&gt; 00:32:03,000<br>And you don’t have to worry about it in terms of your primary backup replication scheme.</p>
<p>349<br>00:32:03,000 –&gt; 00:32:11,000<br>And that just decides like in GFS, that’s sort of like the master, it just decides about a year to set the server for this particular replica group.</p>
<p>350<br>00:32:11,000 –&gt; 00:32:17,000<br>And the backup primary backup protocol doesn’t have to think about this.</p>
<p>351<br>00:32:17,000 –&gt; 00:32:18,000<br>Thanks.</p>
<p>352<br>00:32:18,000 –&gt; 00:32:32,000<br>And so, like, and this is a good introduction to chain replication because the chain replication is exactly not sort of a primary backup replication scheme for approach to.</p>
<p>353<br>00:32:32,000 –&gt; 00:32:43,000<br>And now this to say that, you know, chain replication just assumes there is a very, a configuration service.</p>
<p>354<br>00:32:43,000 –&gt; 00:32:47,000<br>I think they called the master process in the paper.</p>
<p>355<br>00:32:47,000 –&gt; 00:32:51,000<br>Then chain replication cells, there’s a couple of cool properties.</p>
<p>356<br>00:32:51,000 –&gt; 00:32:54,000<br>One read operations.</p>
<p>357<br>00:32:54,000 –&gt; 00:32:57,000<br>Or as they call them query operations.</p>
<p>358<br>00:32:57,000 –&gt; 00:33:02,000<br>Involved only one server.</p>
<p>359<br>00:33:02,000 –&gt; 00:33:07,000<br>Namely the tail. That’s we’ve seen the second.</p>
<p>360<br>00:33:07,000 –&gt; 00:33:14,000<br>Another nice property about chain replication that has a very simple recovery plan.</p>
<p>361<br>00:33:14,000 –&gt; 00:33:20,000<br>And we’re going to talk about all these in more detail in the second.</p>
<p>362<br>00:33:20,000 –&gt; 00:33:27,000<br>And then something that you started having you, you appreciate to give the fact, you know, how complicated can be wrapped.</p>
<p>363<br>00:33:27,000 –&gt; 00:33:31,000<br>And it provides actually strong.</p>
<p>364<br>00:33:31,000 –&gt; 00:33:35,000<br>A strong properties, namely linearizability.</p>
<p>365<br>00:33:35,000 –&gt; 00:33:43,000<br>If we were to put in the get operations, I finally just a lot of people ask this, you know, there’s actually a reasonable influential design.</p>
<p>366<br>00:33:43,000 –&gt; 00:33:47,000<br>And it’s used by quite a number of systems.</p>
<p>367<br>00:33:47,000 –&gt; 00:33:50,000<br>So this is a useful practice.</p>
<p>368<br>00:33:50,000 –&gt; 00:33:54,000<br>And this is a, so I’m going to talk about each of these components in a little bit more detail.</p>
<p>369<br>00:33:54,000 –&gt; 00:34:01,000<br>And then we’ll come back to this sort of approach one for just approach to.</p>
<p>370<br>00:34:01,000 –&gt; 00:34:07,000<br>So in terms of an overview.</p>
<p>371<br>00:34:07,000 –&gt; 00:34:11,000<br>So, you know, there’s an overview.</p>
<p>372<br>00:34:11,000 –&gt; 00:34:18,000<br>You sort of delay of the land, you know, there is a master process.</p>
<p>373<br>00:34:18,000 –&gt; 00:34:24,000<br>Or configuration service.</p>
<p>374<br>00:34:24,000 –&gt; 00:34:30,000<br>And basically keep track, you know, which server is going to belong to a particular chain.</p>
<p>375<br>00:34:30,000 –&gt; 00:34:37,000<br>So S1, S2, S3, you know, basically have the record of a genius who the head is and who the tap.</p>
<p>376<br>00:34:37,000 –&gt; 00:34:40,000<br>And so that’s a configuration service.</p>
<p>377<br>00:34:40,000 –&gt; 00:34:50,000<br>And here we do actually have our servers, you know, S1, S2, S3.</p>
<p>378<br>00:34:50,000 –&gt; 00:35:00,000<br>And one of them is the head, typically the one with a smaller number and one is the tail.</p>
<p>379<br>00:35:00,000 –&gt; 00:35:03,000<br>And so we have the clients.</p>
<p>380<br>00:35:03,000 –&gt; 00:35:09,000<br>The client may talk to the configuration server, we’re in, you know, who actually is part of the chain.</p>
<p>381<br>00:35:09,000 –&gt; 00:35:13,000<br>And then a sense of right request to the head.</p>
<p>382<br>00:35:13,000 –&gt; 00:35:16,000<br>So this is the protocol and chain replication.</p>
<p>383<br>00:35:16,000 –&gt; 00:35:20,000<br>The right request always goes to the head.</p>
<p>384<br>00:35:20,000 –&gt; 00:35:26,000<br>And what the head does, the head basically pushes, you know, the head actually applies the operation on its state.</p>
<p>385<br>00:35:26,000 –&gt; 00:35:31,000<br>And maybe it has a disk associated with it, you know, where, whatever source key value server on it.</p>
<p>386<br>00:35:31,000 –&gt; 00:35:38,000<br>And then it sends the update, you know, there’s all the operation down the chain.</p>
<p>387<br>00:35:38,000 –&gt; 00:35:42,000<br>And then it’s in five order and reliably.</p>
<p>388<br>00:35:42,000 –&gt; 00:35:52,000<br>So S1 will send the update to S2, you know, S2 have a Zone disk, apply the operation word state change to its state.</p>
<p>389<br>00:35:52,000 –&gt; 00:35:59,000<br>Once it actually supplied it, you know, it will forward it to the last node in the chain.</p>
<p>390<br>00:35:59,000 –&gt; 00:36:06,000<br>Because there are only three nodes in this particular chain, you could have changed that are longer, you know, if you want more availability.</p>
<p>391<br>00:36:06,000 –&gt; 00:36:14,000<br>So last note, it gets the message or this state change, it applies to you know, its state.</p>
<p>392<br>00:36:14,000 –&gt; 00:36:21,000<br>And then this is in charge actually sending a acknowledgement back to the client.</p>
<p>393<br>00:36:21,000 –&gt; 00:36:26,000<br>So it’s the tail who sends the acknowledgement back.</p>
<p>394<br>00:36:26,000 –&gt; 00:36:39,000<br>One way to think about this is that when the tail, in this case, as free, you know, actually applies the state change, that’s sort of the commit point.</p>
<p>395<br>00:36:39,000 –&gt; 00:36:45,000<br>And the reason that this is the commit point is because subsequent reads always come from the tail.</p>
<p>396<br>00:36:45,000 –&gt; 00:36:48,000<br>So if anybody or any other client.</p>
<p>397<br>00:36:48,000 –&gt; 00:36:52,000<br>You know, there’s a read operation, they always go to the tail.</p>
<p>398<br>00:36:52,000 –&gt; 00:36:56,000<br>And the tail basically responds immediately back to it.</p>
<p>399<br>00:36:56,000 –&gt; 00:37:02,000<br>So read operations go to the tail. So here was client one, here’s client two, client two, there’s a read operation.</p>
<p>400<br>00:37:02,000 –&gt; 00:37:07,000<br>It goes to the tail, the tail responds and that’s it.</p>
<p>401<br>00:37:07,000 –&gt; 00:37:11,000<br>And so there’s a couple of things that are one that sort of point out.</p>
<p>402<br>00:37:11,000 –&gt; 00:37:16,000<br>And one of the interesting points out is that the read operations just involve one server.</p>
<p>403<br>00:37:16,000 –&gt; 00:37:25,000<br>And like if you remember from lap three or if you progress, we started doing lap three read operations actually involve.</p>
<p>404<br>00:37:25,000 –&gt; 00:37:32,000<br>In our implementation read operation go through the raft log and all that kind of stuff.</p>
<p>405<br>00:37:32,000 –&gt; 00:37:43,000<br>The paper discusses an optimization, but the read operation always goes to the leader and the leader first has to, you know, contact the majority of the service before it to execute the operation local.</p>
<p>406<br>00:37:43,000 –&gt; 00:37:50,000<br>So what you see here is that the read operations actually go through complete so that the to a different server from right operation.</p>
<p>407<br>00:37:50,000 –&gt; 00:37:55,000<br>So the reading and right workload is actually spread at least over two servers.</p>
<p>408<br>00:37:55,000 –&gt; 00:38:01,000<br>Furthermore, the read operation involves only one server. There’s never doesn’t have to talk to any other server.</p>
<p>409<br>00:38:01,000 –&gt; 00:38:11,000<br>So I can just respond to me and we’ll see a little bit later on why this is actually important or why this is actually what further optimization is this is a lapse.</p>
<p>410<br>00:38:11,000 –&gt; 00:38:24,000<br>And so the commit point is really, you know, the point that the right actually happens at the tail end because at that point, the right operation is visible to readers and not before any other point.</p>
<p>411<br>00:38:24,000 –&gt; 00:38:36,000<br>This is also, you know, provides this linearizability. So it’s pretty easy to see that in the case of no crashes, you know, this scheme guarantees or linearizability because the rights are all applied in some total order at the head.</p>
<p>412<br>00:38:36,000 –&gt; 00:38:45,000<br>And when the tail receives, you know, that update, it’s sort of, it’s the commit point it what’s respond to the client and sends a request back.</p>
<p>413<br>00:38:45,000 –&gt; 00:38:53,000<br>If that same client immediately does a read operation, it will go to the tail and it will observe the last change.</p>
<p>414<br>00:38:53,000 –&gt; 00:38:58,000<br>So certainly within a single client basically all operations are totally ordered.</p>
<p>415<br>00:38:58,000 –&gt; 00:39:05,000<br>It’s pretty easy to see that the inclined, if client to start to read operation after, you know, clients one operation has finished.</p>
<p>416<br>00:39:05,000 –&gt; 00:39:16,000<br>And when it’s finished, when the tail has responded. So any read operation that starts after a right operation will observe, you know, the last or the result of the most recent right.</p>
<p>417<br>00:39:16,000 –&gt; 00:39:23,000<br>And so it’s pretty easy to sort of get an intuition here that this is going to get provided with linearizability.</p>
<p>418<br>00:39:23,000 –&gt; 00:39:34,000<br>So what I’d like to do now is actually take a quick breakout room section and we’re going to let you to discuss the question that wasn’t a posting lecture.</p>
<p>419<br>00:39:34,000 –&gt; 00:39:51,000<br>You know, what could go wrong or like would a brain linearizability if instead of having the tail respond to the client, have the head respond to the client immediately after it has received, you know, the right request.</p>
<p>420<br>00:39:51,000 –&gt; 00:40:01,000<br>And maybe that’s a good topic sort of to debate a little bit and if you want to go in any other direction to talk about the chain replication for your welcome, but maybe that’s something to start with.</p>
<p>421<br>00:40:01,000 –&gt; 00:40:11,000<br>So let’s take a five minute breakout room and then we’ll do this and I think let me see Jose are you going to do it.</p>
<p>422<br>00:40:11,000 –&gt; 00:40:13,000<br>Yeah.</p>
<p>423<br>00:40:13,000 –&gt; 00:40:18,000<br>Do I have to make you something or I don’t think it’s necessary.</p>
<p>424<br>00:40:18,000 –&gt; 00:40:25,000<br>I think it’s zoom changed should should be possible.</p>
<p>425<br>00:40:25,000 –&gt; 00:40:32,000<br>Oh, yeah.</p>
<p>426<br>00:40:32,000 –&gt; 00:40:33,000<br>Yep.</p>
<p>427<br>00:40:33,000 –&gt; 00:40:35,000<br>Yeah.</p>
<p>428<br>00:41:03,000 –&gt; 00:41:05,000<br>Yeah.</p>
<p>429<br>00:41:33,000 –&gt; 00:41:35,000<br>Yeah.</p>
<p>430<br>00:41:35,000 –&gt; 00:41:36,000<br>Yeah.</p>
<p>431<br>00:41:36,000 –&gt; 00:41:37,000<br>Yeah.</p>
<p>432<br>00:41:37,000 –&gt; 00:41:38,000<br>Yeah.</p>
<p>433<br>00:41:38,000 –&gt; 00:41:39,000<br>Yeah.</p>
<p>434<br>00:41:39,000 –&gt; 00:41:40,000<br>Yeah.</p>
<p>435<br>00:41:40,000 –&gt; 00:41:41,000<br>Yeah.</p>
<p>436<br>00:41:41,000 –&gt; 00:41:42,000<br>Yeah.</p>
<p>437<br>00:41:42,000 –&gt; 00:41:43,000<br>Yeah.</p>
<p>438<br>00:41:43,000 –&gt; 00:41:44,000<br>Yeah.</p>
<p>439<br>00:41:44,000 –&gt; 00:41:45,000<br>Yeah.</p>
<p>440<br>00:41:45,000 –&gt; 00:41:46,000<br>Yeah.</p>
<p>441<br>00:41:46,000 –&gt; 00:41:47,000<br>Yeah.</p>
<p>442<br>00:41:47,000 –&gt; 00:41:48,000<br>Yeah.</p>
<p>443<br>00:41:48,000 –&gt; 00:41:49,000<br>Yeah.</p>
<p>444<br>00:41:49,000 –&gt; 00:41:50,000<br>Yeah.</p>
<p>445<br>00:41:50,000 –&gt; 00:41:51,000<br>Yeah.</p>
<p>446<br>00:41:51,000 –&gt; 00:41:52,000<br>Yeah.</p>
<p>447<br>00:41:52,000 –&gt; 00:41:53,000<br>Yeah.</p>
<p>448<br>00:41:53,000 –&gt; 00:41:54,000<br>Yeah.</p>
<p>449<br>00:41:54,000 –&gt; 00:41:55,000<br>Yeah.</p>
<p>450<br>00:41:55,000 –&gt; 00:41:56,000<br>Yeah.</p>
<p>451<br>00:41:56,000 –&gt; 00:41:57,000<br>Yeah.</p>
<p>452<br>00:41:57,000 –&gt; 00:41:58,000<br>Yeah.</p>
<p>453<br>00:41:58,000 –&gt; 00:41:59,000<br>Yeah.</p>
<p>454<br>00:41:59,000 –&gt; 00:42:00,000<br>Yeah.</p>
<p>455<br>00:42:00,000 –&gt; 00:42:01,000<br>Yeah.</p>
<p>456<br>00:42:01,000 –&gt; 00:42:02,000<br>Yeah.</p>
<p>457<br>00:42:02,000 –&gt; 00:42:03,000<br>Yeah.</p>
<p>458<br>00:42:03,000 –&gt; 00:42:04,000<br>Yeah.</p>
<p>459<br>00:42:04,000 –&gt; 00:42:05,000<br>Yeah.</p>
<p>460<br>00:42:05,000 –&gt; 00:42:06,000<br>Yeah.</p>
<p>461<br>00:42:06,000 –&gt; 00:42:07,000<br>Yeah.</p>
<p>462<br>00:42:07,000 –&gt; 00:42:08,000<br>Yeah.</p>
<p>463<br>00:42:08,000 –&gt; 00:42:09,000<br>Yeah.</p>
<p>464<br>00:42:09,000 –&gt; 00:42:10,000<br>Yeah.</p>
<p>465<br>00:42:10,000 –&gt; 00:42:11,000<br>Yeah.</p>
<p>466<br>00:42:11,000 –&gt; 00:42:12,000<br>Yeah.</p>
<p>467<br>00:42:12,000 –&gt; 00:42:13,000<br>Yeah.</p>
<p>468<br>00:42:13,000 –&gt; 00:42:14,000<br>Yeah.</p>
<p>469<br>00:42:14,000 –&gt; 00:42:15,000<br>Yeah.</p>
<p>470<br>00:42:15,000 –&gt; 00:42:16,000<br>Yeah.</p>
<p>471<br>00:42:16,000 –&gt; 00:42:17,000<br>Yeah.</p>
<p>472<br>00:42:17,000 –&gt; 00:42:18,000<br>Yeah.</p>
<p>473<br>00:42:18,000 –&gt; 00:42:19,000<br>Yeah.</p>
<p>474<br>00:42:19,000 –&gt; 00:42:20,000<br>Yeah.</p>
<p>475<br>00:42:20,000 –&gt; 00:42:21,000<br>Yeah.</p>
<p>476<br>00:42:21,000 –&gt; 00:42:22,000<br>Yeah.</p>
<p>477<br>00:42:22,000 –&gt; 00:42:23,000<br>Yeah.</p>
<p>478<br>00:42:23,000 –&gt; 00:42:24,000<br>Yeah.</p>
<p>479<br>00:42:24,000 –&gt; 00:42:25,000<br>Yeah.</p>
<p>480<br>00:42:32,000 –&gt; 00:42:33,000<br>Yeah.</p>
<p>481<br>00:42:33,000 –&gt; 00:42:34,000<br>Yeah.</p>
<p>482<br>00:42:34,000 –&gt; 00:42:35,000<br>Yeah.</p>
<p>483<br>00:42:35,000 –&gt; 00:42:36,000<br>Yeah.</p>
<p>484<br>00:42:36,000 –&gt; 00:42:37,000<br>Yeah.</p>
<p>485<br>00:42:37,000 –&gt; 00:42:38,000<br>Yeah.</p>
<p>486<br>00:42:38,000 –&gt; 00:42:39,000<br>Yeah.</p>
<p>487<br>00:42:39,000 –&gt; 00:42:40,000<br>Yeah.</p>
<p>488<br>00:42:40,000 –&gt; 00:42:41,000<br>Yeah.</p>
<p>489<br>00:42:41,000 –&gt; 00:42:42,000<br>Yeah.</p>
<p>490<br>00:42:42,000 –&gt; 00:42:43,000<br>Yeah.</p>
<p>491<br>00:42:43,000 –&gt; 00:42:44,000<br>Yeah.</p>
<p>492<br>00:42:44,000 –&gt; 00:42:45,000<br>Yeah.</p>
<p>493<br>00:42:45,000 –&gt; 00:42:46,000<br>Yeah.</p>
<p>494<br>00:42:46,000 –&gt; 00:42:47,000<br>Yeah.</p>
<p>495<br>00:42:47,000 –&gt; 00:42:48,000<br>Yeah.</p>
<p>496<br>00:42:48,000 –&gt; 00:42:49,000<br>Yeah.</p>
<p>497<br>00:42:49,000 –&gt; 00:42:50,000<br>Yeah.</p>
<p>498<br>00:42:50,000 –&gt; 00:42:51,000<br>Yeah.</p>
<p>499<br>00:42:51,000 –&gt; 00:42:52,000<br>Yeah.</p>
<p>500<br>00:42:52,000 –&gt; 00:42:53,000<br>Yeah.</p>
<p>501<br>00:42:53,000 –&gt; 00:42:54,000<br>Yeah.</p>
<p>502<br>00:42:54,000 –&gt; 00:42:55,000<br>Yeah.</p>
<p>503<br>00:42:55,000 –&gt; 00:42:56,000<br>Yeah.</p>
<p>504<br>00:42:56,000 –&gt; 00:42:57,000<br>Yeah.</p>
<p>505<br>00:42:57,000 –&gt; 00:42:58,000<br>Yeah.</p>
<p>506<br>00:42:58,000 –&gt; 00:42:59,000<br>Yeah.</p>
<p>507<br>00:42:59,000 –&gt; 00:43:00,000<br>Yeah.</p>
<p>508<br>00:43:00,000 –&gt; 00:43:01,000<br>Yeah.</p>
<p>509<br>00:43:01,000 –&gt; 00:43:02,000<br>Yeah.</p>
<p>510<br>00:43:02,000 –&gt; 00:43:03,000<br>Yeah.</p>
<p>511<br>00:43:03,000 –&gt; 00:43:04,000<br>Yeah.</p>
<p>512<br>00:43:04,000 –&gt; 00:43:05,000<br>Yeah.</p>
<p>513<br>00:43:05,000 –&gt; 00:43:06,000<br>Yeah.</p>
<p>514<br>00:43:06,000 –&gt; 00:43:07,000<br>Yeah.</p>
<p>515<br>00:43:07,000 –&gt; 00:43:08,000<br>Yeah.</p>
<p>516<br>00:43:08,000 –&gt; 00:43:09,000<br>Yeah.</p>
<p>517<br>00:43:09,000 –&gt; 00:43:10,000<br>Yeah.</p>
<p>518<br>00:43:10,000 –&gt; 00:43:11,000<br>Yeah.</p>
<p>519<br>00:43:11,000 –&gt; 00:43:12,000<br>Yeah.</p>
<p>520<br>00:43:12,000 –&gt; 00:43:13,000<br>Yeah.</p>
<p>521<br>00:43:13,000 –&gt; 00:43:14,000<br>Yeah.</p>
<p>522<br>00:43:14,000 –&gt; 00:43:15,000<br>Yeah.</p>
<p>523<br>00:43:15,000 –&gt; 00:43:16,000<br>Yeah.</p>
<p>524<br>00:43:16,000 –&gt; 00:43:17,000<br>Yeah.</p>
<p>525<br>00:43:17,000 –&gt; 00:43:18,000<br>Yeah.</p>
<p>526<br>00:43:18,000 –&gt; 00:43:19,000<br>Yeah.</p>
<p>527<br>00:43:19,000 –&gt; 00:43:20,000<br>Yeah.</p>
<p>528<br>00:43:20,000 –&gt; 00:43:21,000<br>Yeah.</p>
<p>529<br>00:43:21,000 –&gt; 00:43:22,000<br>Yeah.</p>
<p>530<br>00:43:22,000 –&gt; 00:43:23,000<br>Yeah.</p>
<p>531<br>00:43:23,000 –&gt; 00:43:24,000<br>Yeah.</p>
<p>532<br>00:43:24,000 –&gt; 00:43:25,000<br>Yeah.</p>
<p>533<br>00:43:25,000 –&gt; 00:43:26,000<br>Yeah.</p>
<p>534<br>00:43:26,000 –&gt; 00:43:27,000<br>Yeah.</p>
<p>535<br>00:43:27,000 –&gt; 00:43:28,000<br>Yeah.</p>
<p>536<br>00:43:28,000 –&gt; 00:43:29,000<br>Yeah.</p>
<p>537<br>00:43:29,000 –&gt; 00:43:30,000<br>Yeah.</p>
<p>538<br>00:43:30,000 –&gt; 00:43:31,000<br>Yeah.</p>
<p>539<br>00:43:31,000 –&gt; 00:43:32,000<br>Yeah.</p>
<p>540<br>00:43:32,000 –&gt; 00:43:33,000<br>Yeah.</p>
<p>541<br>00:43:33,000 –&gt; 00:43:34,000<br>Yeah.</p>
<p>542<br>00:43:34,000 –&gt; 00:43:35,000<br>Yeah.</p>
<p>543<br>00:43:35,000 –&gt; 00:43:36,000<br>Yeah.</p>
<p>544<br>00:43:36,000 –&gt; 00:43:37,000<br>Yeah.</p>
<p>545<br>00:43:37,000 –&gt; 00:43:38,000<br>Yeah.</p>
<p>546<br>00:43:38,000 –&gt; 00:43:39,000<br>Yeah.</p>
<p>547<br>00:43:39,000 –&gt; 00:43:40,000<br>Yeah.</p>
<p>548<br>00:43:40,000 –&gt; 00:43:41,000<br>Yeah.</p>
<p>549<br>00:43:41,000 –&gt; 00:43:42,000<br>Yeah.</p>
<p>550<br>00:43:42,000 –&gt; 00:43:43,000<br>Yeah.</p>
<p>551<br>00:43:43,000 –&gt; 00:43:44,000<br>Yeah.</p>
<p>552<br>00:43:44,000 –&gt; 00:43:45,000<br>Yeah.</p>
<p>553<br>00:43:45,000 –&gt; 00:43:46,000<br>Yeah.</p>
<p>554<br>00:43:46,000 –&gt; 00:43:47,000<br>Yeah.</p>
<p>555<br>00:43:47,000 –&gt; 00:43:48,000<br>Yeah.</p>
<p>556<br>00:43:48,000 –&gt; 00:43:49,000<br>Yeah.</p>
<p>557<br>00:43:49,000 –&gt; 00:43:50,000<br>Yeah.</p>
<p>558<br>00:43:50,000 –&gt; 00:43:51,000<br>Yeah.</p>
<p>559<br>00:43:51,000 –&gt; 00:43:52,000<br>Yeah.</p>
<p>560<br>00:43:52,000 –&gt; 00:43:53,000<br>Yeah.</p>
<p>561<br>00:43:53,000 –&gt; 00:43:54,000<br>Yeah.</p>
<p>562<br>00:43:54,000 –&gt; 00:43:55,000<br>Yeah.</p>
<p>563<br>00:43:55,000 –&gt; 00:43:56,000<br>Yeah.</p>
<p>564<br>00:43:56,000 –&gt; 00:43:57,000<br>Yeah.</p>
<p>565<br>00:43:57,000 –&gt; 00:43:58,000<br>Yeah.</p>
<p>566<br>00:43:58,000 –&gt; 00:43:59,000<br>Yeah.</p>
<p>567<br>00:43:59,000 –&gt; 00:44:00,000<br>Yeah.</p>
<p>568<br>00:44:00,000 –&gt; 00:44:01,000<br>Yeah.</p>
<p>569<br>00:44:01,000 –&gt; 00:44:02,000<br>Yeah.</p>
<p>570<br>00:44:02,000 –&gt; 00:44:03,000<br>Yeah.</p>
<p>571<br>00:44:03,000 –&gt; 00:44:04,000<br>Yeah.</p>
<p>572<br>00:44:04,000 –&gt; 00:44:05,000<br>Yeah.</p>
<p>573<br>00:44:05,000 –&gt; 00:44:06,000<br>Yeah.</p>
<p>574<br>00:44:06,000 –&gt; 00:44:07,000<br>Yeah.</p>
<p>575<br>00:44:07,000 –&gt; 00:44:08,000<br>Yeah.</p>
<p>576<br>00:44:08,000 –&gt; 00:44:09,000<br>Yeah.</p>
<p>577<br>00:44:09,000 –&gt; 00:44:10,000<br>Yeah.</p>
<p>578<br>00:44:10,000 –&gt; 00:44:11,000<br>Yeah.</p>
<p>579<br>00:44:11,000 –&gt; 00:44:12,000<br>Yeah.</p>
<p>580<br>00:44:12,000 –&gt; 00:44:13,000<br>Yeah.</p>
<p>581<br>00:44:13,000 –&gt; 00:44:14,000<br>Yeah.</p>
<p>582<br>00:44:14,000 –&gt; 00:44:15,000<br>Yeah.</p>
<p>583<br>00:44:15,000 –&gt; 00:44:16,000<br>Yeah.</p>
<p>584<br>00:44:16,000 –&gt; 00:44:17,000<br>Yeah.</p>
<p>585<br>00:44:17,000 –&gt; 00:44:18,000<br>Yeah.</p>
<p>586<br>00:44:18,000 –&gt; 00:44:19,000<br>Yeah.</p>
<p>587<br>00:44:19,000 –&gt; 00:44:20,000<br>Yeah.</p>
<p>588<br>00:44:20,000 –&gt; 00:44:21,000<br>Yeah.</p>
<p>589<br>00:44:21,000 –&gt; 00:44:22,000<br>Yeah.</p>
<p>590<br>00:44:22,000 –&gt; 00:44:23,000<br>Yeah.</p>
<p>591<br>00:44:23,000 –&gt; 00:44:24,000<br>Yeah.</p>
<p>592<br>00:44:24,000 –&gt; 00:44:25,000<br>Yeah.</p>
<p>593<br>00:44:25,000 –&gt; 00:44:27,000<br>Yeah.</p>
<p>594<br>00:44:27,000 –&gt; 00:44:28,000<br>Yeah.</p>
<p>595<br>00:44:28,000 –&gt; 00:44:29,000<br>Yeah.</p>
<p>596<br>00:44:29,000 –&gt; 00:44:30,000<br>So don’t sit.</p>
<p>597<br>00:44:31,000 –&gt; 00:44:32,000<br>I really like it.</p>
<p>598<br>00:44:32,000 –&gt; 00:44:34,000<br>I don’t know what it is.</p>
<p>599<br>00:44:34,000 –&gt; 00:44:37,000<br>I don’t know what it is.</p>
<p>600<br>00:44:37,000 –&gt; 00:44:39,000<br>I really like it.</p>
<p>601<br>00:44:39,000 –&gt; 00:44:41,000<br>Yeah.</p>
<p>602<br>00:44:41,000 –&gt; 00:44:42,000<br>Yeah.</p>
<p>603<br>00:44:42,000 –&gt; 00:44:43,000<br>Yeah.</p>
<p>604<br>00:44:43,000 –&gt; 00:44:44,000<br>Yeah.</p>
<p>605<br>00:44:44,000 –&gt; 00:44:45,000<br>Yeah.</p>
<p>606<br>00:44:45,000 –&gt; 00:44:46,000<br>Yeah.</p>
<p>607<br>00:44:46,000 –&gt; 00:44:47,000<br>Yeah.</p>
<p>608<br>00:44:47,000 –&gt; 00:44:48,000<br>Yeah.</p>
<p>609<br>00:44:48,000 –&gt; 00:44:49,000<br>Yeah.</p>
<p>610<br>00:44:49,000 –&gt; 00:44:51,000<br>Yeah.</p>
<p>611<br>00:44:51,000 –&gt; 00:44:53,000<br>Yeah.</p>
<p>612<br>00:44:53,000 –&gt; 00:44:54,000<br>Yeah.</p>
<p>613<br>00:44:54,000 –&gt; 00:44:55,000<br>Yeah.</p>
<p>614<br>00:44:55,000 –&gt; 00:44:56,000<br>Yeah.</p>
<p>615<br>00:44:56,000 –&gt; 00:44:57,000<br>Yeah.</p>
<p>616<br>00:44:57,000 –&gt; 00:44:57,760<br>That’s.</p>
<p>617<br>00:45:28,000 –&gt; 00:45:30,000<br>I’m going to go to the next room.</p>
<p>618<br>00:45:30,000 –&gt; 00:45:32,000<br>I’m going to go to the next room.</p>
<p>619<br>00:45:32,000 –&gt; 00:45:34,000<br>I’m going to go to the next room.</p>
<p>620<br>00:45:34,000 –&gt; 00:45:36,000<br>I’m going to go to the next room.</p>
<p>621<br>00:45:36,000 –&gt; 00:45:38,000<br>I’m going to go to the next room.</p>
<p>622<br>00:45:38,000 –&gt; 00:45:40,000<br>I’m going to go to the next room.</p>
<p>623<br>00:45:40,000 –&gt; 00:45:42,000<br>I’m going to go to the next room.</p>
<p>624<br>00:45:42,000 –&gt; 00:45:44,000<br>I’m going to go to the next room.</p>
<p>625<br>00:45:44,000 –&gt; 00:45:46,000<br>I’m going to go to the next room.</p>
<p>626<br>00:45:46,000 –&gt; 00:45:48,000<br>I’m going to go to the next room.</p>
<p>627<br>00:45:48,000 –&gt; 00:45:50,000<br>I’m going to go to the next room.</p>
<p>628<br>00:45:50,000 –&gt; 00:45:52,000<br>I’m going to go to the next room.</p>
<p>629<br>00:45:52,000 –&gt; 00:45:54,000<br>I’m going to go to the next room.</p>
<p>630<br>00:45:54,000 –&gt; 00:45:56,000<br>I’m going to go to the next room.</p>
<p>631<br>00:45:56,000 –&gt; 00:45:58,000<br>I’m going to go to the next room.</p>
<p>632<br>00:46:26,000 –&gt; 00:46:28,000<br>I’m going to go to the next room.</p>
<p>633<br>00:46:28,000 –&gt; 00:46:30,000<br>I’m going to go to the next room.</p>
<p>634<br>00:46:30,000 –&gt; 00:46:32,000<br>I’m going to go to the next room.</p>
<p>635<br>00:46:32,000 –&gt; 00:46:34,000<br>I’m going to go to the next room.</p>
<p>636<br>00:46:34,000 –&gt; 00:46:36,000<br>I’m going to go to the next room.</p>
<p>637<br>00:46:36,000 –&gt; 00:46:38,000<br>I’m going to go to the next room.</p>
<p>638<br>00:46:38,000 –&gt; 00:46:40,000<br>I’m going to go to the next room.</p>
<p>639<br>00:46:40,000 –&gt; 00:46:42,000<br>I’m going to go to the next room.</p>
<p>640<br>00:46:42,000 –&gt; 00:46:44,000<br>I’m going to go to the next room.</p>
<p>641<br>00:46:44,000 –&gt; 00:46:46,000<br>I’m going to go to the next room.</p>
<p>642<br>00:46:46,000 –&gt; 00:46:48,000<br>I’m going to go to the next room.</p>
<p>643<br>00:46:48,000 –&gt; 00:46:50,000<br>I’m going to go to the next room.</p>
<p>644<br>00:46:50,000 –&gt; 00:46:52,000<br>I’m going to go to the next room.</p>
<p>645<br>00:46:52,000 –&gt; 00:46:54,000<br>I’m going to go to the next room.</p>
<p>646<br>00:46:54,000 –&gt; 00:46:56,000<br>I’m going to go to the next room.</p>
<p>647<br>00:46:56,000 –&gt; 00:46:58,000<br>I’m going to go to the next room.</p>
<p>648<br>00:46:58,000 –&gt; 00:47:00,000<br>I’m going to go to the next room.</p>
<p>649<br>00:47:00,000 –&gt; 00:47:02,000<br>I’m going to go to the next room.</p>
<p>650<br>00:47:02,000 –&gt; 00:47:04,000<br>I’m going to go to the next room.</p>
<p>651<br>00:47:04,000 –&gt; 00:47:06,000<br>I’m going to go to the next room.</p>
<p>652<br>00:47:06,000 –&gt; 00:47:08,000<br>I’m going to go to the next room.</p>
<p>653<br>00:47:08,000 –&gt; 00:47:10,000<br>I’m going to go to the next room.</p>
<p>654<br>00:47:10,000 –&gt; 00:47:12,000<br>I’m going to go to the next room.</p>
<p>655<br>00:47:12,000 –&gt; 00:47:14,000<br>I’m going to go to the next room.</p>
<p>656<br>00:47:14,000 –&gt; 00:47:16,000<br>I’m going to go to the next room.</p>
<p>657<br>00:47:16,000 –&gt; 00:47:18,000<br>I’m going to go to the next room.</p>
<p>658<br>00:47:18,000 –&gt; 00:47:20,000<br>I’m going to go to the next room.</p>
<p>659<br>00:47:20,000 –&gt; 00:47:22,000<br>I’m going to go to the next room.</p>
<p>660<br>00:47:22,000 –&gt; 00:47:24,000<br>Vanessa here.</p>
<p>661<br>00:47:24,000 –&gt; 00:47:26,000<br>Vanessa.</p>
<p>662<br>00:47:26,000 –&gt; 00:47:37,000<br>You okay, you okay.</p>
<p>663<br>00:47:37,000 –&gt; 00:47:40,000<br>You okay, you’re okay, you’re coming back.</p>
<p>664<br>00:47:40,000 –&gt; 00:47:42,000<br>You okay, you’re coming back.</p>
<p>665<br>00:47:42,000 –&gt; 00:47:44,000<br>You okay, you’re coming back.</p>
<p>666<br>00:47:44,000 –&gt; 00:47:46,000<br>You okay, you okay, you’re coming back.</p>
<p>667<br>00:47:46,000 –&gt; 00:47:48,000<br>You okay, you are coming back.</p>
<p>668<br>00:47:48,000 –&gt; 00:47:50,000<br>You’re coming back.</p>
<p>669<br>00:47:50,000 –&gt; 00:47:52,000<br>close the thumbs.</p>
<p>670<br>00:48:20,000 –&gt; 00:48:36,000<br>this</p>
<p>671<br>00:48:36,000 –&gt; 00:48:46,000<br>OK!</p>
<p>672<br>00:48:46,000 –&gt; 00:48:47,000<br>Okay.</p>
<p>673<br>00:48:47,000 –&gt; 00:48:48,000<br>Good.</p>
<p>674<br>00:48:48,000 –&gt; 00:49:14,679<br>So, you know, just a quick to summarize, you know, why, you know, that would break linear</p>
<p>675<br>00:49:14,679 –&gt; 00:49:15,679<br>stability.</p>
<p>676<br>00:49:15,679 –&gt; 00:49:21,399<br>And so the vertical change changed that was sort of contemplated was to, you know, both,</p>
<p>677<br>00:49:21,399 –&gt; 00:49:25,000<br>you know, keep propagating to S1 and S2 and S3.</p>
<p>678<br>00:49:25,000 –&gt; 00:49:29,759<br>But, you know, as soon as S1 actually is done with its propagation, the sender responds</p>
<p>679<br>00:49:29,759 –&gt; 00:49:31,599<br>back to the client.</p>
<p>680<br>00:49:31,599 –&gt; 00:49:37,480<br>And clearly that is, we’ll break linearizability because, let’s say, this client won’t get</p>
<p>681<br>00:49:37,480 –&gt; 00:49:40,759<br>the right, got the acknowledgement back, you know, from S1.</p>
<p>682<br>00:49:40,760 –&gt; 00:49:44,480<br>S1 of course has, you know, the right also progressed S2 and S3.</p>
<p>683<br>00:49:44,480 –&gt; 00:49:50,600<br>But maybe before, you know, S2 actually context S3, the client actually sends a read operation</p>
<p>684<br>00:49:50,600 –&gt; 00:49:51,600<br>to S3.</p>
<p>685<br>00:49:51,600 –&gt; 00:49:57,160<br>And of course, now we’ll return the value from before the right for stunt.</p>
<p>686<br>00:49:57,160 –&gt; 00:49:59,840<br>So the client doesn’t even observe its own rights.</p>
<p>687<br>00:49:59,840 –&gt; 00:50:03,480<br>And so I’m clearly breaking linearizability.</p>
<p>688<br>00:50:03,480 –&gt; 00:50:09,280<br>So it’s very important that, you know, as I said earlier that these, the tail actually</p>
<p>689<br>00:50:09,280 –&gt; 00:50:15,200<br>sends the acknowledgement back to the client because really the, once the tail has processed</p>
<p>690<br>00:50:15,200 –&gt; 00:50:22,480<br>the, where I do operation, that is actually really what the commit point is.</p>
<p>691<br>00:50:22,480 –&gt; 00:50:25,480<br>Any questions about that?</p>
<p>692<br>00:50:25,480 –&gt; 00:50:30,760<br>Okay, so this was sort of normal operation.</p>
<p>693<br>00:50:30,760 –&gt; 00:50:33,760<br>And I want to talk a little bit about crashes.</p>
<p>694<br>00:50:34,760 –&gt; 00:50:43,760<br>About since it’s a two four stupid systems, so all the actions is where when the failures happen.</p>
<p>695<br>00:50:43,760 –&gt; 00:50:48,280<br>And one of the things that is cool about the chain replication is, you know, the number</p>
<p>696<br>00:50:48,280 –&gt; 00:50:51,040<br>failure scenario is actually quite limited.</p>
<p>697<br>00:50:51,040 –&gt; 00:50:56,520<br>And so let me, so basically the free cases, namely the head fails, the one at the intermediate</p>
<p>698<br>00:50:56,520 –&gt; 00:50:58,360<br>search fails or tail fails.</p>
<p>699<br>00:50:58,360 –&gt; 00:51:01,800<br>And so let’s look at one of each of those cases.</p>
<p>700<br>00:51:01,800 –&gt; 00:51:05,800<br>So here’s our, you know, the case we have ahead, you know, it’s s1.</p>
<p>701<br>00:51:05,800 –&gt; 00:51:10,600<br>And let’s say that it applied U1, U2 and U3.</p>
<p>702<br>00:51:10,600 –&gt; 00:51:15,360<br>So free updates, it talks to S2.</p>
<p>703<br>00:51:15,360 –&gt; 00:51:20,600<br>Maybe S2 has done U2 and U1.</p>
<p>704<br>00:51:20,600 –&gt; 00:51:24,360<br>And you know, we are we have S3, which is the tail.</p>
<p>705<br>00:51:24,360 –&gt; 00:51:26,519<br>And it only has done U1 so far.</p>
<p>706<br>00:51:26,519 –&gt; 00:51:32,880<br>And so the coin was to put the coin was talking to S1.</p>
<p>707<br>00:51:32,880 –&gt; 00:51:37,480<br>And we now want to think about like what happens and what needs to happen is one of these</p>
<p>708<br>00:51:37,480 –&gt; 00:51:38,480<br>crashes.</p>
<p>709<br>00:51:38,480 –&gt; 00:51:43,119<br>And so let’s start with the case that the head crashes.</p>
<p>710<br>00:51:43,119 –&gt; 00:51:46,559<br>And so the head crashes, what needs to be done?</p>
<p>711<br>00:51:46,559 –&gt; 00:51:48,559<br>This is an easy case.</p>
<p>712<br>00:51:48,559 –&gt; 00:51:51,400<br>This is a hard case.</p>
<p>713<br>00:51:51,400 –&gt; 00:51:52,400<br>Easy.</p>
<p>714<br>00:51:53,240 –&gt; 00:51:54,240<br>Easy.</p>
<p>715<br>00:51:54,240 –&gt; 00:51:55,440<br>I help with an easy case.</p>
<p>716<br>00:51:55,440 –&gt; 00:51:56,440<br>Why?</p>
<p>717<br>00:51:56,440 –&gt; 00:52:00,880<br>You can just cut off the head.</p>
<p>718<br>00:52:00,880 –&gt; 00:52:01,880<br>Oh, sorry.</p>
<p>719<br>00:52:01,880 –&gt; 00:52:06,320<br>Yeah, the head and, you know, make S2 the head now.</p>
<p>720<br>00:52:06,320 –&gt; 00:52:07,320<br>Yeah.</p>
<p>721<br>00:52:07,320 –&gt; 00:52:09,320<br>We just promote, you know, so what’s the most good?</p>
<p>722<br>00:52:09,320 –&gt; 00:52:13,280<br>And the correct is that the configuration server discovers that S1 is gone.</p>
<p>723<br>00:52:13,280 –&gt; 00:52:15,039<br>What decides if S1 is gone.</p>
<p>724<br>00:52:15,039 –&gt; 00:52:22,160<br>And then basically can promote S2 to be the head in the</p>
<p>725<br>00:52:22,159 –&gt; 00:52:27,480<br>subsequent operations and clients know in the future and talk to this guy.</p>
<p>726<br>00:52:27,480 –&gt; 00:52:30,000<br>And why is this correct?</p>
<p>727<br>00:52:30,000 –&gt; 00:52:32,279<br>So what operation have we lost?</p>
<p>728<br>00:52:32,279 –&gt; 00:52:34,239<br>We lost U3.</p>
<p>729<br>00:52:34,239 –&gt; 00:52:35,239<br>Yeah.</p>
<p>730<br>00:52:35,239 –&gt; 00:52:36,480<br>And is that a problem?</p>
<p>731<br>00:52:36,480 –&gt; 00:52:39,480<br>That’s valid to lose operations.</p>
<p>732<br>00:52:39,480 –&gt; 00:52:40,480<br>Yeah.</p>
<p>733<br>00:52:40,480 –&gt; 00:52:41,480<br>Yeah.</p>
<p>734<br>00:52:41,480 –&gt; 00:52:42,480<br>It’s fair game to lose U3.</p>
<p>735<br>00:52:42,480 –&gt; 00:52:47,199<br>But U3 has not been committed because only operations at the tail are committed.</p>
<p>736<br>00:52:47,199 –&gt; 00:52:49,399<br>And so it’s just as if the operation never happens.</p>
<p>737<br>00:52:49,400 –&gt; 00:52:56,119<br>And the client could not even have observed that actually U2 or U3 actually has happened.</p>
<p>738<br>00:52:56,119 –&gt; 00:52:57,119<br>Or U3 has.</p>
<p>739<br>00:52:57,119 –&gt; 00:52:58,119<br>Okay.</p>
<p>740<br>00:52:58,119 –&gt; 00:53:01,160<br>So that’s perfectly fine to do this.</p>
<p>741<br>00:53:01,160 –&gt; 00:53:03,720<br>Why is it important that the configuration server is actually involved here?</p>
<p>742<br>00:53:03,720 –&gt; 00:53:07,559<br>Could it like STU2 decide on its own to become the head?</p>
<p>743<br>00:53:07,559 –&gt; 00:53:10,400<br>Let’s say S2 couldn’t talk to S1 anymore and it says like, ah, whatever.</p>
<p>744<br>00:53:10,400 –&gt; 00:53:11,960<br>I want to become head.</p>
<p>745<br>00:53:11,960 –&gt; 00:53:13,200<br>Would that be valid?</p>
<p>746<br>00:53:14,199 –&gt; 00:53:18,199<br>Would that like maybe create a split?</p>
<p>747<br>00:53:18,199 –&gt; 00:53:19,199<br>Yeah.</p>
<p>748<br>00:53:19,199 –&gt; 00:53:22,359<br>That would create a split ring, right?</p>
<p>749<br>00:53:22,359 –&gt; 00:53:26,599<br>Because it might get us to might just be petitioned from S1.</p>
<p>750<br>00:53:26,599 –&gt; 00:53:28,399<br>And so now both are heads.</p>
<p>751<br>00:53:28,399 –&gt; 00:53:30,199<br>And maybe both are processing commands.</p>
<p>752<br>00:53:30,199 –&gt; 00:53:34,199<br>And that would be, you know, a violator.</p>
<p>753<br>00:53:34,199 –&gt; 00:53:38,199<br>You know, basically, this sort of this whole property of I think the total order.</p>
<p>754<br>00:53:38,199 –&gt; 00:53:40,199<br>We cannot have to do.</p>
<p>755<br>00:53:40,199 –&gt; 00:53:44,199<br>And does this to even know that S1 is ahead?</p>
<p>756<br>00:53:44,199 –&gt; 00:53:47,199<br>Because it just receives.</p>
<p>757<br>00:53:47,199 –&gt; 00:53:51,199<br>You probably got it from the configuration information in previous time, right?</p>
<p>758<br>00:53:51,199 –&gt; 00:53:56,199<br>Like when you know, configuration server decides on the new configuration that can tell all the servers and whatever.</p>
<p>759<br>00:53:56,199 –&gt; 00:54:00,199<br>And the client that actually care, you know, here’s the new configuration.</p>
<p>760<br>00:54:00,199 –&gt; 00:54:05,199<br>Does this only happen when like S1 to S2 connection is separate or wait, what?</p>
<p>761<br>00:54:05,199 –&gt; 00:54:08,199<br>So what causes the split brain again?</p>
<p>762<br>00:54:08,199 –&gt; 00:54:13,199<br>The brain would happen if S2 on its own decided that S1 has failed and became the head.</p>
<p>763<br>00:54:13,199 –&gt; 00:54:23,199<br>And so we’re not a lot of that happen and the way actually the will work out in practice is that there is a configuration server that actually decides what is actually the current configuration.</p>
<p>764<br>00:54:23,199 –&gt; 00:54:35,199<br>And so if it decides that S1 is dead, then it can import S2 and S3 saying like, hey, you guys are now the new chain and S2 is the head.</p>
<p>765<br>00:54:35,199 –&gt; 00:54:40,199<br>And when that chain happens, so in this case, basically as one is dropped, nothing else has to happen.</p>
<p>766<br>00:54:40,199 –&gt; 00:54:46,199<br>Because as through the only update that we lost is the one that actually was not committed anyway.</p>
<p>767<br>00:54:46,199 –&gt; 00:54:50,199<br>So there’s nothing to be repaired for.</p>
<p>768<br>00:54:50,199 –&gt; 00:55:00,199<br>Or making this going from this setting from free replicas with the dropping the head is basically pretty straightforward operation.</p>
<p>769<br>00:55:00,199 –&gt; 00:55:02,199<br>Okay.</p>
<p>770<br>00:55:02,199 –&gt; 00:55:07,199<br>I have a question. So there’s an assumption here, right?</p>
<p>771<br>00:55:07,199 –&gt; 00:55:18,199<br>That like the commands that like leave S1 will arrive in order in S2.</p>
<p>772<br>00:55:18,199 –&gt; 00:55:22,199<br>Is that like, is that a reasonable assumption for like?</p>
<p>773<br>00:55:22,199 –&gt; 00:55:28,199<br>Well, I think with the way they, so they basically say, you know, we need a reliable five vote between S1 and S2.</p>
<p>774<br>00:55:28,199 –&gt; 00:55:33,199<br>And S3. And I think the way they implemented that is probably using TCP connection.</p>
<p>775<br>00:55:33,199 –&gt; 00:55:36,199<br>Okay.</p>
<p>776<br>00:55:36,199 –&gt; 00:55:37,199<br>Thanks.</p>
<p>777<br>00:55:37,199 –&gt; 00:55:40,199<br>Okay. So let’s look at the second case.</p>
<p>778<br>00:55:40,199 –&gt; 00:55:43,199<br>So we’re half, you know, we get S1.</p>
<p>779<br>00:55:43,199 –&gt; 00:55:46,199<br>You know, S2.</p>
<p>780<br>00:55:46,199 –&gt; 00:55:54,199<br>S3. And of course, there could be more, you know, servers in the chain, but like, you know, free is enough for us to consider all the cases.</p>
<p>781<br>00:55:54,199 –&gt; 00:55:59,199<br>And so now what we want to do to take the case, we’re a minute one crashes.</p>
<p>782<br>00:55:59,199 –&gt; 00:56:01,199<br>This one crashes.</p>
<p>783<br>00:56:01,199 –&gt; 00:56:11,199<br>And so the configuration server at some point decides, yeah, S2 is crashed, you know, informs S1 and S3, you know, basically, they formed a new chain.</p>
<p>784<br>00:56:11,199 –&gt; 00:56:16,199<br>And we’re wondering about like, what else needs to happen?</p>
<p>785<br>00:56:16,199 –&gt; 00:56:21,199<br>So we saw in the first case, the head drops, then nothing really has to be done other than updating the chain.</p>
<p>786<br>00:56:21,199 –&gt; 00:56:27,199<br>Now we’re updating the chain and the question is, does anything needs to happen?</p>
<p>787<br>00:56:27,199 –&gt; 00:56:33,199<br>The S1 needs to send to S3 the request that it sent to us to, but didn’t make it to S3.</p>
<p>788<br>00:56:33,199 –&gt; 00:56:39,199<br>Yes, exactly. Right. So we have, you know, you won, you two, you three.</p>
<p>789<br>00:56:39,199 –&gt; 00:56:44,199<br>This was guy had seen you won a you two. This guy had seen you won.</p>
<p>790<br>00:56:44,199 –&gt; 00:56:58,199<br>And, you know, you two that’s actually in progress, you know, and I got lost mass to basically S1 has to bring S3 up to date and basically forward it to you two and you three.</p>
<p>791<br>00:56:58,199 –&gt; 00:57:01,199<br>Okay. So there’s actually a little bit of working off.</p>
<p>792<br>00:57:01,199 –&gt; 00:57:03,199<br>Let’s consider the final case.</p>
<p>793<br>00:57:03,199 –&gt; 00:57:05,199<br>The tail.</p>
<p>794<br>00:57:05,199 –&gt; 00:57:09,199<br>So here we go again. We have three cases.</p>
<p>795<br>00:57:09,199 –&gt; 00:57:13,199<br>It’s one or three servers. That’s two.</p>
<p>796<br>00:57:13,199 –&gt; 00:57:16,199<br>And the third one is free.</p>
<p>797<br>00:57:16,199 –&gt; 00:57:18,199<br>And, uh,</p>
<p>798<br>00:57:18,199 –&gt; 00:57:23,199<br>and let’s just say I showed the tail crashes.</p>
<p>799<br>00:57:23,199 –&gt; 00:57:32,199<br>And so, at some point in time, the configuration server notices the sites that the new chain is going to be S1 and S2 tells S1 and then two that they’re part of the new chain.</p>
<p>800<br>00:57:32,199 –&gt; 00:57:37,199<br>And, uh, what else needs to happen?</p>
<p>801<br>00:57:37,199 –&gt; 00:57:47,199<br>Well, let’s write down. We know these guys have seen you won you two and you three. This guy has seen you won a YouTube.</p>
<p>802<br>00:57:47,199 –&gt; 00:57:51,199<br>So who becomes the new tail in this scenario?</p>
<p>803<br>00:57:51,199 –&gt; 00:57:53,199<br>S2.</p>
<p>804<br>00:57:53,199 –&gt; 00:57:57,199<br>Yeah, studio becomes a new tail. And anything else that needs to happen?</p>
<p>805<br>00:57:57,199 –&gt; 00:58:02,199<br>Um, I guess the client needs to be informed that S2 is the new.</p>
<p>806<br>00:58:02,199 –&gt; 00:58:05,199<br>Yeah. I was on the client by learning from the configuration server.</p>
<p>807<br>00:58:05,199 –&gt; 00:58:06,199<br>Correct.</p>
<p>808<br>00:58:06,199 –&gt; 00:58:15,199<br>And so yeah, but nothing else has to happen. Right? Because, uh, the, all the committed, you know, the no committed operations are lost.</p>
<p>809<br>00:58:15,199 –&gt; 00:58:24,199<br>Uh, and, uh, you know, and S3 were still in, uh, needs to still be extra propagated to S2 and I will be just happening.</p>
<p>810<br>00:58:24,199 –&gt; 00:58:29,199<br>Okay. So dropping the tails. Also, regional stream. So dropping the tail in the head is a reasonable straightforward.</p>
<p>811<br>00:58:29,199 –&gt; 00:58:33,199<br>Dropping the middle one is a little bit more complicated, but not much more complicated.</p>
<p>812<br>00:58:33,199 –&gt; 00:58:49,199<br>And the key thing though, I want to sort of emphasize here is how does this compare to figure seven and eight in the raft paper?</p>
<p>813<br>00:58:49,199 –&gt; 00:58:52,199<br>Maybe two. Yeah, go ahead.</p>
<p>814<br>00:58:52,199 –&gt; 00:58:59,199<br>I saw a question. So, uh, so when I see the new field going into mint the entries that are in S2, I don’t know.</p>
<p>815<br>00:58:59,199 –&gt; 00:59:06,199<br>So don’t we need to send the knowledge inspector the client saying that these new operations have been automatically committed?</p>
<p>816<br>00:59:06,199 –&gt; 00:59:13,199<br>Uh, sorry. I didn’t hear you. We’re pretty, uh, we’re pretty noisy connection there.</p>
<p>817<br>00:59:13,199 –&gt; 00:59:24,199<br>So it’s like, I was just saying that that’s the new tail. Don’t we have to send knowledge back to the client? There are some entries that have been automatically committed?</p>
<p>818<br>00:59:24,199 –&gt; 00:59:30,199<br>Yeah, there might be the case that the, what, what happened is the client is probably going to retry, correct?</p>
<p>819<br>00:59:30,199 –&gt; 00:59:36,199<br>And, uh, we have to have a separate due duplication scheme like in a Latvian anyway.</p>
<p>820<br>00:59:36,199 –&gt; 00:59:44,199<br>And so there’s probably a couple different ways about have to do it to figure something out particular clear which one it will take.</p>
<p>821<br>00:59:44,199 –&gt; 00:59:56,199<br>Yeah, like in that case, then in the paper, just say like, you know, it might like, even if it doesn’t respond that code or could not like have succeeded.</p>
<p>822<br>00:59:56,199 –&gt; 00:59:58,199<br>Yeah.</p>
<p>823<br>00:59:58,199 –&gt; 01:00:09,199<br>Okay, so back to my original question, which is like, you know, how does this contrast this picture of my, you know, my drawing picture here on this whiteboard, how does that contrast the figure seven and eight?</p>
<p>824<br>01:00:09,199 –&gt; 01:00:11,199<br>Simply.</p>
<p>825<br>01:00:11,199 –&gt; 01:00:27,199<br>Yeah, that’s the key point now. Why don’t they get across, right? These like, you know, there’s not that many cases to consider a year, basically three cases, which is like slightly, you know, quite a bit simpler than the, in the case of the rap paper where you know, the many critics consider and the snares are quite complicated.</p>
<p>826<br>01:00:27,199 –&gt; 01:00:38,199<br>Now part of that is because, you know, it’s a chain, right? And again, things are pushed down in a very sort of straightforward manner down the replication chain.</p>
<p>827<br>01:00:38,199 –&gt; 01:00:45,199<br>Part of that is, of course, you know, the configuration part is sort of outsourced through the configuration manager manager.</p>
<p>828<br>01:00:45,199 –&gt; 01:00:55,199<br>But for the primary backup part of the recovery plan, that’s a reasonable straightforward, you know, they’re only three configurations to consider.</p>
<p>829<br>01:00:55,199 –&gt; 01:01:12,199<br>And one more sort of point I want to make, which is like, you know, how to add a replica because any system, you know, that you’re going to run for real, real, at some point you got a new one in because otherwise, you know, you’re going to lose, you start to free, then you have to, then you have one and then you have zero and then you’re on the bill.</p>
<p>830<br>01:01:12,199 –&gt; 01:01:18,199<br>So, you know, you have to add new replica, so let’s consider the case.</p>
<p>831<br>01:01:18,199 –&gt; 01:01:22,199<br>And then, you know, we have S1, it is the head.</p>
<p>832<br>01:01:22,199 –&gt; 01:01:32,199<br>And let’s say we were in a scenario where, you know, we have S1 and S2, which the tail and basically we want to bring up, you know, S3.</p>
<p>833<br>01:01:32,199 –&gt; 01:01:37,199<br>And that turns out, you know, as the paper described, that it was most convenient to actually do this.</p>
<p>834<br>01:01:37,199 –&gt; 01:01:41,199<br>At the, at the tail end of it.</p>
<p>835<br>01:01:41,199 –&gt; 01:01:54,199<br>And so the way that we proceed is like, so the client is here, it’s talking to S2 because that’s actually the current tail S3 comes up.</p>
<p>836<br>01:01:54,199 –&gt; 01:02:01,199<br>And basically what the first thing it does is actually copies, you know, all the state from S3 to from S2 to S3.</p>
<p>837<br>01:02:01,199 –&gt; 01:02:11,199<br>And so this may take hours, like we’re, you know, tens of minutes or maybe in deep multiple hours, you’re like we’re copying, you know, bigger bites of data or terabytes of data from S2 to S3.</p>
<p>838<br>01:02:11,199 –&gt; 01:02:17,199<br>But while that’s happening, you know, S2 and S3, you know, S3 can just, you know, share requests.</p>
<p>839<br>01:02:17,199 –&gt; 01:02:24,199<br>Of course, it does have to remember which ones are came in after, you know, S3 start copying.</p>
<p>840<br>01:02:24,199 –&gt; 01:02:30,199<br>And so you can see the list of like all the updates that are sort of have happened, but they’re have not been propagated to S3 yet.</p>
<p>841<br>01:02:30,199 –&gt; 01:02:37,199<br>At some point S3 is done, you know, with all the copying and basically tells S2, okay, man, I’m ready to become the tail.</p>
<p>842<br>01:02:37,199 –&gt; 01:02:40,199<br>I got all the state as to say.</p>
<p>843<br>01:02:40,199 –&gt; 01:02:49,199<br>And so since an email, basically since email sends a message to S2 saying like, okay, I want to be detailed as to responses like, yeah, that’s okay.</p>
<p>844<br>01:02:49,199 –&gt; 01:02:54,199<br>But once you apply it all the updates.</p>
<p>845<br>01:02:54,199 –&gt; 01:03:01,199<br>And so basically as to sense the updates and response to this, I want to go on the company.</p>
<p>846<br>01:03:01,199 –&gt; 01:03:10,199<br>Tail requests, you know, you know, response to that to S3, S3 replies the updates and then becomes the tail.</p>
<p>847<br>01:03:10,199 –&gt; 01:03:16,199<br>And you know, clients that we’re talking to S2 and S2 can tell the client, you know, for now on, I’m not the tail anymore, you should talk to S3.</p>
<p>848<br>01:03:16,199 –&gt; 01:03:19,199<br>And so they can swap, you know, the direction.</p>
<p>849<br>01:03:19,199 –&gt; 01:03:26,199<br>And so that’s the way to add replica into a chain.</p>
<p>850<br>01:03:26,199 –&gt; 01:03:28,199<br>So question on this.</p>
<p>851<br>01:03:28,199 –&gt; 01:03:36,199<br>Don’t you run into this like infinite loop problem where S2 sends updates to S3 and when S3 is like updating, it’s also serving more requests.</p>
<p>852<br>01:03:36,199 –&gt; 01:03:40,199<br>And so that’s more updates than is the send and goes back and forth.</p>
<p>853<br>01:03:40,199 –&gt; 01:03:57,199<br>No, no, no, no, no, no, once S2 has sent the updates that S3 has not seen yet, you know, to S2 to S3, then from then on, it’s normal chain replication whenever S2 gets a request, you know, an update from S1, you know, it forwards to S3.</p>
<p>854<br>01:03:57,199 –&gt; 01:04:02,199<br>Right, but S3 can’t become the tail until it is successfully processed all the updates.</p>
<p>855<br>01:04:02,199 –&gt; 01:04:12,199<br>Oh, yeah, so once it sets up the TCP channel, basically S2 can just say like from once you have processed these guys, you can become the tail because you have seen everything.</p>
<p>856<br>01:04:12,199 –&gt; 01:04:18,199<br>I mean, and everything else can be pipeline after that, right, in the same TCP channel.</p>
<p>857<br>01:04:18,199 –&gt; 01:04:26,199<br>It could become the tail, right, right after, like even before it processed the update, right, as long as it doesn’t serve requests.</p>
<p>858<br>01:04:26,199 –&gt; 01:04:38,199<br>It does as long as doesn’t serve requests exactly right it just has to process all the updates that S2 has received and S3 not once it’s updated those then it become come to tail and start processing requests.</p>
<p>859<br>01:04:38,199 –&gt; 01:04:44,199<br>I see so blocks like requests for a moment while it process updates.</p>
<p>860<br>01:04:44,199 –&gt; 01:04:48,199<br>Exactly.</p>
<p>861<br>01:04:48,199 –&gt; 01:04:53,199<br>Okay.</p>
<p>862<br>01:04:53,199 –&gt; 01:05:07,199<br>Okay, so now, you know, I want to come back to basically questions a lot of people ask, you know, how this contrast to sort of, you know, how are the CR properties, you know, chain replication properties, how does it compare.</p>
<p>863<br>01:05:07,199 –&gt; 01:05:15,199<br>Kind of wondered the good ask what are the good properties and mostly, you know, with respect to our comparison to raft.</p>
<p>864<br>01:05:15,199 –&gt; 01:05:24,199<br>And of course, I got to say to of course, like the chain replication just influenced the primary backup scheme by not, you know, the configuration service.</p>
<p>865<br>01:05:24,199 –&gt; 01:05:28,199<br>So we’ll come back to that a little bit more in detail, but there are a couple things that we can know it’s going to prefer.</p>
<p>866<br>01:05:28,199 –&gt; 01:05:35,199<br>And we just compare sort of the way the radical works with the chain replication.</p>
<p>867<br>01:05:35,199 –&gt; 01:05:42,199<br>And the first of all, you know, we can observe positive aspect of chain replication is that declined.</p>
<p>868<br>01:05:42,199 –&gt; 01:05:47,199<br>I can see.</p>
<p>869<br>01:05:47,199 –&gt; 01:05:57,199<br>So, you know, I’m going to split between between the head and the tail.</p>
<p>870<br>01:05:57,199 –&gt; 01:06:07,199<br>So the load of actually serving any client operation that can be split actually between two of them, they don’t have to all run through the leader as in raft.</p>
<p>871<br>01:06:07,199 –&gt; 01:06:12,199<br>The head sends an update.</p>
<p>872<br>01:06:12,199 –&gt; 01:06:28,199<br>What’s so unlike in raft, where the head or the leader basically sends updates the log entries to every appear in this particular scheme actually it’s only happened the head only sends one basically RPC.</p>
<p>873<br>01:06:28,199 –&gt; 01:06:32,199<br>And so there’s sort of fewer messages involved.</p>
<p>874<br>01:06:32,199 –&gt; 01:06:41,199<br>Reads or career operations involve only.</p>
<p>875<br>01:06:41,199 –&gt; 01:06:43,199<br>Only the tail.</p>
<p>876<br>01:06:43,199 –&gt; 01:06:51,199<br>Correct. And in the raft, you know, the if you even implement the read only optimization, the read only optimization.</p>
<p>877<br>01:06:51,199 –&gt; 01:07:06,199<br>And the voice having the read operation to go through the log and being dependent to all the walks of the peers, but it still requires that the leader actually context and majority of peers to decide whether it actually.</p>
<p>878<br>01:07:06,199 –&gt; 01:07:11,199<br>The operation can be served.</p>
<p>879<br>01:07:11,199 –&gt; 01:07:14,199<br>So another possibility aspect of this.</p>
<p>880<br>01:07:14,199 –&gt; 01:07:24,199<br>This is a simple crash recovery, as we talked about.</p>
<p>881<br>01:07:24,199 –&gt; 01:07:34,199<br>But you know, a major downside, you know, compared to sort of the raft scheme is that you know one failure.</p>
<p>882<br>01:07:34,199 –&gt; 01:07:45,199<br>Required recovery duration.</p>
<p>883<br>01:07:45,199 –&gt; 01:07:53,199<br>The reason that the recovery duration required is because like a right actually have to go through the whole chain.</p>
<p>884<br>01:07:53,199 –&gt; 01:07:59,199<br>And so and then right cannot be knowledge until that every serve in the chain actually has process it.</p>
<p>885<br>01:07:59,199 –&gt; 01:08:09,199<br>And that is actually slightly different correctly raft is you well know because soon as basically a majority the peers actually have accepted the particular right operation and a pen to their logs.</p>
<p>886<br>01:08:09,199 –&gt; 01:08:17,199<br>And then you can just proceed. And so there’s actually no interaction at all if like one server fails, for example.</p>
<p>887<br>01:08:17,199 –&gt; 01:08:29,199<br>And if the remaining server still for the majority while chain replication if one server would fail, then you know somebody of the duration actually has to happen, which means there’s going to be a short period of going to probably down top.</p>
<p>888<br>01:08:29,199 –&gt; 01:08:35,199<br>Right. Does that make sense?</p>
<p>889<br>01:08:35,199 –&gt; 01:08:45,199<br>Now, I want to make one more point, sort of in contrast, you know, to sort of the raft replication scheme is that this because the read operations involve only one server.</p>
<p>890<br>01:08:45,199 –&gt; 01:08:55,199<br>There’s a cool extension if you will that actually gets really high read performance. And so the basic idea is as follows.</p>
<p>891<br>01:08:55,199 –&gt; 01:09:21,199<br>The basic idea is basically to split, you know, the split objects or they call volumes in the paper split the objects across multiple change.</p>
<p>892<br>01:09:21,199 –&gt; 01:09:45,199<br>So instead of having one chain as I would have done in the previous reports, you know, we’re going to have multiple chains. And so, for example, we might have a CH1 in chain one, you know, S1 is the head as to the middle guy and as free to tail in chain two.</p>
<p>893<br>01:09:45,199 –&gt; 01:09:57,199<br>Yeah, we’re going to rotate things around as to is the head as one is the where as free is the middle guy, whoops, as free is the middle guy and as one is to tail.</p>
<p>894<br>01:09:57,199 –&gt; 01:10:25,199<br>And basically what we’re going to do is we’re going to split objects across these multiple chains. So the configuration server basically has a map, you know, saying like, you know, chart one objects and shared one go to chain one objects and share two go to chain two objects and start free, no go to chain free.</p>
<p>895<br>01:10:25,199 –&gt; 01:10:40,199<br>And what is the cool part about it is that we have no multiple tails and we as one as retail for some chain as one is a tail for some chain, this too is a tail for some chain.</p>
<p>896<br>01:10:40,199 –&gt; 01:10:56,199<br>And basically read operations for these different chains can now be completely executed in parallel. So if the read operations sort of hit all the different charge, sort of uniformly spread that basically, you know, the our read throughput is going to increase, you know, linearly with the number of tails that we have.</p>
<p>897<br>01:10:56,199 –&gt; 01:11:00,199<br>And in this case, we have three tails, so we get three times the report.</p>
<p>898<br>01:11:01,199 –&gt; 01:11:09,199<br>So we can basically sort of same as the so we get a little bit of the same properties that zookeeper hat where the read performs can be excellent, you know, it can scale with the number server.</p>
<p>899<br>01:11:10,199 –&gt; 01:11:16,199<br>But we also get not only that we get the scale part, but we maintain the linear is ability.</p>
<p>900<br>01:11:17,199 –&gt; 01:11:21,199<br>And in this scheme, we don’t have to actually give up on linear is ability.</p>
<p>901<br>01:11:22,199 –&gt; 01:11:32,199<br>So we get sort of two nice properties, namely, you know, good read performance in effect scaling with the number servers, at least for reads are two different to the chains.</p>
<p>902<br>01:11:33,199 –&gt; 01:11:36,199<br>And we got actually, and we maintain linear is ability.</p>
<p>903<br>01:11:37,199 –&gt; 01:11:44,199<br>Any questions about this.</p>
<p>904<br>01:11:49,199 –&gt; 01:11:58,199<br>Sorry, in this case client, when they are deciding which chain to read from, would they be able to.</p>
<p>905<br>01:11:59,199 –&gt; 01:12:05,199<br>To do it like to decide themselves or do they need to contact the configuration server to decide.</p>
<p>906<br>01:12:06,199 –&gt; 01:12:11,199<br>Yeah, so that’s a great question. So typically in the paper actually doesn’t really say it’s explicit about it.</p>
<p>907<br>01:12:11,199 –&gt; 01:12:15,199<br>They talk about maybe talking through some proxy to the servers.</p>
<p>908<br>01:12:16,199 –&gt; 01:12:19,199<br>What you will do in lap four is basically you will download the configurations.</p>
<p>909<br>01:12:19,199 –&gt; 01:12:22,199<br>The configuration will include the sharp assignment.</p>
<p>910<br>01:12:23,199 –&gt; 01:12:25,199<br>And you will download that from the configuration server.</p>
<p>911<br>01:12:29,199 –&gt; 01:12:37,199<br>You need to be careful about how you ordered the servers and each of the chains prevent like a particular chain from being oversaturated or particular link between my two servers.</p>
<p>912<br>01:12:38,199 –&gt; 01:12:42,199<br>Yeah, this, this, this, this scheme doesn’t really take that into account.</p>
<p>913<br>01:12:43,199 –&gt; 01:12:51,199<br>You can imagine like the configuration planner, the configuration manager have a sophisticated model of actually how the network is laid out and you know can be very careful about how to change or done.</p>
<p>914<br>01:12:52,199 –&gt; 01:13:05,199<br>Maybe even charge more sharks to one chain a few of sharks to another chain all the stuff is principle possible right because the configuration can just manage, you can just compute anything it likes and basically says years the assignment.</p>
<p>915<br>01:13:07,199 –&gt; 01:13:10,199<br>Thank you, I can even rebalance if it wants to.</p>
<p>916<br>01:13:11,199 –&gt; 01:13:24,199<br>So the question I could you explain again how linearized bill is kept under this extension well, you know, nothing has really changed.</p>
<p>917<br>01:13:25,199 –&gt; 01:13:27,199<br>We’re still doing primary backup using a chain.</p>
<p>918<br>01:13:28,199 –&gt; 01:13:36,199<br>And so, you know, we basically carry over the linearized ability from the single chain and that’s it.</p>
<p>919<br>01:13:41,199 –&gt; 01:13:45,199<br>This might be like speculative, but how this compared to.</p>
<p>920<br>01:13:46,199 –&gt; 01:13:55,199<br>I guess maybe it’s equivalent of just like having groups of servers for each like link instead of having reusing the same ones or not for each link but for each.</p>
<p>921<br>01:13:56,199 –&gt; 01:14:05,199<br>Step in the chain so like s one is like three servers s two is three servers instead of reusing the same one and entering from different points.</p>
<p>922<br>01:14:06,199 –&gt; 01:14:12,199<br>Yeah, well, what would be the advantage of that scheme that you imagine I mean just for scalability.</p>
<p>923<br>01:14:13,199 –&gt; 01:14:27,199<br>Well also maintainer and linearized ability well, the reason that the scheme is attractive is that because they have an detail might have quite a bit of load but the middle guy does it and you know by having sort of this arrangement we spread the load across all servers.</p>
<p>924<br>01:14:29,199 –&gt; 01:14:30,199<br>I see.</p>
<p>925<br>01:14:36,199 –&gt; 01:14:37,199<br>Okay, good.</p>
<p>926<br>01:14:40,199 –&gt; 01:14:42,199<br>So maybe I want to summarize here.</p>
<p>927<br>01:14:47,199 –&gt; 01:14:50,199<br>And sort of talk a little bit about so we saw this approach one.</p>
<p>928<br>01:14:52,199 –&gt; 01:14:53,199<br>Which we do lap one.</p>
<p>929<br>01:14:54,199 –&gt; 01:15:03,199<br>Which we do in lap three, which is, you know, we run all the operations through raft and all the replication, you know, the sort of the configuration and the replication is all billed.</p>
<p>930<br>01:15:05,199 –&gt; 01:15:08,199<br>And then we’re using a raft and nothing else is involved.</p>
<p>931<br>01:15:09,199 –&gt; 01:15:20,199<br>And then sort of this approach to, you know, which is the topic of this particular paper where, you know, there’s a deviation server perhaps build using raft.</p>
<p>932<br>01:15:21,199 –&gt; 01:15:33,199<br>Or packs of genuine and a primary backup replication scheme and primary backup using chain replication.</p>
<p>933<br>01:15:36,199 –&gt; 01:15:52,199<br>And you can see you may hopefully, you know, there’s a bit of a clear that there’s some attractive properties to approach to in the sense that you can get scalable rep performance on the primary backups.</p>
<p>934<br>01:15:53,199 –&gt; 01:16:07,199<br>Of course, not a configuration server because you know, it runs raft like, you know, you do in approach one. But you get at least, you know, maybe scalable rep performance for actually operations on the replicas of our on the primary background scheme like to put and get operations.</p>
<p>935<br>01:16:09,199 –&gt; 01:16:17,199<br>And the other thing that is nice about this is that sort of the, if you have your data is very very large, you can have more specialized</p>
<p>936<br>01:16:17,199 –&gt; 01:16:25,199<br>simulation or schemes to basically copy the state from one machine to another machine.</p>
<p>937<br>01:16:26,199 –&gt; 01:16:33,199<br>And you know, the chain replication or any sort of primary backup scheme that sort of separated from the configuration server allows you to do that easily.</p>
<p>938<br>01:16:34,199 –&gt; 01:16:46,199<br>And so it’s quite common that, you know, the in practice, you know, people for a lot of products too, although it is also not impossible to actually use approach one for your replicated state machine, including the data.</p>
<p>939<br>01:16:47,199 –&gt; 01:16:56,199<br>And so, you know, you can also do the operations, including server, using operations like, you know, put and get operations. And in fact, there’s receiving lot free redo, but we’ll see later a paper in the,</p>
<p>940<br>01:16:56,199 –&gt; 01:17:04,199<br>you know, the physical spanner that actually uses, you know, packs this direction, you also do the operations.</p>
<p>941<br>01:17:05,199 –&gt; 01:17:15,199<br>Any further questions here?</p>
<p>942<br>01:17:15,199 –&gt; 01:17:23,199<br>I wish you all good luck on the midterm on Thursday, and I will see you in person, or virtually in person next week.</p>
<p>943<br>01:17:29,199 –&gt; 01:17:36,199<br>And if you have any questions, please feel free to hang around and do my best to answer that.</p>
<p>944<br>01:17:36,199 –&gt; 01:17:51,199<br>I have a question about something that you mentioned about raft. So you mentioned that all the leads have to go through the majority of servers, but I’m not quite sure I understand why because the leader has all committed entry.</p>
<p>945<br>01:17:52,199 –&gt; 01:17:53,199<br>Yeah, there’s two two schemes.</p>
<p>946<br>01:17:53,199 –&gt; 01:18:13,199<br>If the leader, either you’re running a situation where all reason rice are served by the leader, right, or, you know, there’s a possibility to serve in principle, read operation for another peer, but then you have to contact the first and the majority of the service to make absolute sure that you have to last operation.</p>
<p>947<br>01:18:14,199 –&gt; 01:18:20,199<br>Got it. So that that requirement is if we want to spread off the reads across every year.</p>
<p>948<br>01:18:20,199 –&gt; 01:18:26,199<br>And we have to be more sophisticated and we cannot do it on our own because that would definitely bring in our ability.</p>
<p>949<br>01:18:28,199 –&gt; 01:18:30,199<br>Right, but if everything goes to the leader, we don’t know.</p>
<p>950<br>01:18:31,199 –&gt; 01:18:39,199<br>Then you’re golden correct, except you know, you have to do this trick where you have sort of an empty agreement at the beginning of every new term.</p>
<p>951<br>01:18:41,199 –&gt; 01:18:43,199<br>Just to make sure that you actually are up to date.</p>
<p>952<br>01:18:45,199 –&gt; 01:18:46,199<br>Okay, thank you.</p>
<p>953<br>01:18:46,199 –&gt; 01:18:47,199<br>Thank you.</p>
<p>954<br>01:18:48,199 –&gt; 01:18:53,199<br>Could you quickly go over again when you’re adding a new server at the tail.</p>
<p>955<br>01:18:54,199 –&gt; 01:19:01,199<br>So just to make sure I understand so essentially it starts this process for like popping all the data from s2 to s3.</p>
<p>956<br>01:19:02,199 –&gt; 01:19:03,199<br>Yep.</p>
<p>957<br>01:19:03,199 –&gt; 01:19:14,199<br>And then if it receives requests for any of that data while that’s still happening, the next three is going to ask us to for anything that it still has directly and it’s going to get it and then respond.</p>
<p>958<br>01:19:14,199 –&gt; 01:19:15,199<br>Yep.</p>
<p>959<br>01:19:15,199 –&gt; 01:19:21,199<br>And then it keeps doing that until it gets data that s2 no longer has and then it just goes live essentially.</p>
<p>960<br>01:19:22,199 –&gt; 01:19:28,199<br>Yeah, well, you could do slightly differently. You know, you could actually have s3 could basically tell s2.</p>
<p>961<br>01:19:28,199 –&gt; 01:19:45,199<br>So you can do s3 can become the leader or just sort of detail and basically don’t process any common operations from the client yet until that has received the remaining operations from s2.</p>
<p>962<br>01:19:47,199 –&gt; 01:19:49,199<br>Also, now case s2 is still the tail.</p>
<p>963<br>01:19:51,199 –&gt; 01:19:53,199<br>Yeah, that’s three gets everything.</p>
<p>964<br>01:19:53,199 –&gt; 01:19:54,199<br>Yeah.</p>
<p>965<br>01:19:54,199 –&gt; 01:19:55,199<br>Okay.</p>
<p>966<br>01:19:55,199 –&gt; 01:19:56,199<br>Thank you.</p>
<p>967<br>01:19:56,199 –&gt; 01:20:02,199<br>There’s basically the paper and described one particular way of doing it. There’s a couple of ways of doing it.</p>
<p>968<br>01:20:04,199 –&gt; 01:20:11,199<br>But if you do that then, like how long do you wait to get everything.</p>
<p>969<br>01:20:13,199 –&gt; 01:20:15,199<br>I think I also have the same contribution as someone else.</p>
<p>970<br>01:20:15,199 –&gt; 01:20:18,199<br>You know, you know, you know, it went order the switches happening.</p>
<p>971<br>01:20:18,199 –&gt; 01:20:19,199<br>Correct.</p>
<p>972<br>01:20:19,199 –&gt; 01:20:21,199<br>So, for example, like s3.</p>
<p>973<br>01:20:21,199 –&gt; 01:20:25,199<br>So s2 is, let’s say, maybe has a big operation through 100.</p>
<p>974<br>01:20:25,199 –&gt; 01:20:29,199<br>You start the copy operation is like with the snapshots and they’re wrapped.</p>
<p>975<br>01:20:29,199 –&gt; 01:20:34,199<br>You start the copy operation. So when the copy operation is done, s3 is up to date until 100.</p>
<p>976<br>01:20:34,199 –&gt; 01:20:36,199<br>Right.</p>
<p>977<br>01:20:36,199 –&gt; 01:20:40,199<br>Then, you know, maybe s2 already has done 10 more operations.</p>
<p>978<br>01:20:40,199 –&gt; 01:20:43,199<br>So that has one one on one one on two and one on three.</p>
<p>979<br>01:20:43,199 –&gt; 01:20:44,199<br>Right.</p>
<p>980<br>01:20:44,199 –&gt; 01:20:48,199<br>And basically s3 can contact s2.</p>
<p>981<br>01:20:48,199 –&gt; 01:20:50,199<br>Say, give me your remaining operations.</p>
<p>982<br>01:20:50,199 –&gt; 01:20:54,199<br>And s2 says like, well, my remaining operations are 101 through 110.</p>
<p>983<br>01:20:54,199 –&gt; 01:21:01,199<br>And as a side effect, you know, s3 also tells s2 will stop being the tail.</p>
<p>984<br>01:21:01,199 –&gt; 01:21:05,199<br>And s2 responds with those operations.</p>
<p>985<br>01:21:05,199 –&gt; 01:21:08,199<br>s3 applies those operation 101 through 110.</p>
<p>986<br>01:21:08,199 –&gt; 01:21:12,199<br>And then tells client and mean time in this tail,</p>
<p>987<br>01:21:12,199 –&gt; 01:21:21,199<br>but a does some process and you commence from client jet or read operation to client jet into with actually has process 101 through 110.</p>
<p>988<br>01:21:21,199 –&gt; 01:21:22,199<br>Okay.</p>
<p>989<br>01:21:22,199 –&gt; 01:21:23,199<br>Okay. I see.</p>
<p>990<br>01:21:23,199 –&gt; 01:21:24,199<br>I see.</p>
<p>991<br>01:21:24,199 –&gt; 01:21:25,199<br>Okay.</p>
<p>992<br>01:21:25,199 –&gt; 01:21:26,199<br>That’s.</p>
<p>993<br>01:21:26,199 –&gt; 01:21:29,199<br>I was a question.</p>
<p>994<br>01:21:29,199 –&gt; 01:21:30,199<br>Oh, sorry.</p>
<p>995<br>01:21:30,199 –&gt; 01:21:32,199<br>No, go ahead.</p>
<p>996<br>01:21:32,199 –&gt; 01:21:33,199<br>Go ahead.</p>
<p>997<br>01:21:33,199 –&gt; 01:21:34,199<br>Okay.</p>
<p>998<br>01:21:34,199 –&gt; 01:21:40,199<br>My question was a little similar to the extension that he talked about.</p>
<p>999<br>01:21:40,199 –&gt; 01:21:46,199<br>I thought I thought about could you could you do a tree instead of a chain.</p>
<p>1000<br>01:21:46,199 –&gt; 01:21:47,199<br>So.</p>
<p>1001<br>01:21:47,199 –&gt; 01:21:49,199<br>Hi.</p>
<p>1002<br>01:21:49,199 –&gt; 01:21:52,199<br>I think there’s a.</p>
<p>1003<br>01:21:52,199 –&gt; 01:21:55,199<br>There are other data structures possible.</p>
<p>1004<br>01:21:55,199 –&gt; 01:22:00,199<br>I’m going to give example, you know, a number of people in email proposed that you could have like have s1.</p>
<p>1005<br>01:22:00,199 –&gt; 01:22:08,199<br>Then you could have like s3, 3, 4, 5, all the intermediate ones, you know, s1 talks to them a parallel to all the intermediate ones.</p>
<p>1006<br>01:22:08,199 –&gt; 01:22:12,199<br>They’re talking all to the tail.</p>
<p>1007<br>01:22:12,199 –&gt; 01:22:17,199<br>Is that what you mean with a tree?</p>
<p>1008<br>01:22:17,199 –&gt; 01:22:26,199<br>I meant more of there would be like a number of leafs that would be at all roughly the same height.</p>
<p>1009<br>01:22:26,199 –&gt; 01:22:28,199<br>So like a balanced tree.</p>
<p>1010<br>01:22:28,199 –&gt; 01:22:34,199<br>And then the leaves will have like a chain going through them.</p>
<p>1011<br>01:22:34,199 –&gt; 01:22:39,199<br>And I think that like linear stability can be broken here.</p>
<p>1012<br>01:22:39,199 –&gt; 01:22:42,199<br>If you like.</p>
<p>1013<br>01:22:42,199 –&gt; 01:22:54,199<br>I think harder about it, but it would have the nice property that you wouldn’t like the now the propagation delay would be like logarithmic instead of linear as here.</p>
<p>1014<br>01:22:54,199 –&gt; 01:22:56,199<br>And you could reach from all the leaves.</p>
<p>1015<br>01:22:56,199 –&gt; 01:22:57,199<br>Yeah.</p>
<p>1016<br>01:22:57,199 –&gt; 01:23:00,199<br>And then you know, you know, the leaves are dangerous, right?</p>
<p>1017<br>01:23:00,199 –&gt; 01:23:09,199<br>Because they might have, you know, one client might have talked to another leaf earlier and the leaves might not be in sync.</p>
<p>1018<br>01:23:09,199 –&gt; 01:23:12,199<br>So that sounds dangerous to me.</p>
<p>1019<br>01:23:12,199 –&gt; 01:23:16,199<br>But maybe your your scheme is a little bit more sophisticated than I’m thinking.</p>
<p>1020<br>01:23:16,199 –&gt; 01:23:24,199<br>The depth of the tree or the depth of the chain is really governed by the meantime to be failure.</p>
<p>1021<br>01:23:24,199 –&gt; 01:23:32,199<br>If you’re the meeting, if you typically run with free server free to five serves because that’s good enough for your high availability.</p>
<p>1022<br>01:23:32,199 –&gt; 01:23:39,199<br>And because you can, you know, we cover for four servers before the whole thing is down.</p>
<p>1023<br>01:23:39,199 –&gt; 01:23:44,199<br>Then that really covers the depth of the chain.</p>
<p>1024<br>01:23:44,199 –&gt; 01:23:50,199<br>And yeah, that we do some latency.</p>
<p>1025<br>01:23:50,199 –&gt; 01:23:52,199<br>That makes sense here. Thank you.</p>
<p>1026<br>01:23:52,199 –&gt; 01:23:54,199<br>Change will generally be short.</p>
<p>1027<br>01:23:54,199 –&gt; 01:23:58,199<br>Right. Okay. Okay. That makes sense. Thanks.</p>
<p>1028<br>01:23:58,199 –&gt; 01:24:06,199<br>Is this the only case where the hard chain would go down if all the servers in the chain went down?</p>
<p>1029<br>01:24:06,199 –&gt; 01:24:08,199<br>Yeah.</p>
<p>1030<br>01:24:08,199 –&gt; 01:24:11,199<br>Thank you.</p>
<p>1031<br>01:24:11,199 –&gt; 01:24:14,199<br>So, you know, it’s very, very dangerous.</p>
<p>1032<br>01:24:14,199 –&gt; 01:24:21,199<br>How you like maintain the strong consistency when like S1, S2 and S3 can all do the read in this slide.</p>
<p>1033<br>01:24:21,199 –&gt; 01:24:26,199<br>You get strong assistance you poor, share, per short or per object.</p>
<p>1034<br>01:24:26,199 –&gt; 01:24:28,199<br>You know, that’s sent to the chain.</p>
<p>1035<br>01:24:28,199 –&gt; 01:24:37,199<br>So if you read, you write one object, you write object one, you read object one, all those operations are going to go through the same chain.</p>
<p>1036<br>01:24:37,199 –&gt; 01:24:41,199<br>And so you get strong systems you forward that particular object.</p>
<p>1037<br>01:24:41,199 –&gt; 01:24:46,199<br>Oh, God, it’s, but it may not be the case that across all the objects we have strong consistency.</p>
<p>1038<br>01:24:46,199 –&gt; 01:24:48,199<br>I don’t know.</p>
<p>1039<br>01:24:48,199 –&gt; 01:24:51,199<br>Let me hesitate on that.</p>
<p>1040<br>01:24:51,199 –&gt; 01:25:01,199<br>Let me hesitate. I think, you know, that requires maybe more machinery.</p>
<p>1041<br>01:25:01,199 –&gt; 01:25:06,199<br>What does that mean like across all the objects getting strong consistency?</p>
<p>1042<br>01:25:06,199 –&gt; 01:25:11,199<br>You read right, I’ve get one, you read right object two.</p>
<p>1043<br>01:25:11,199 –&gt; 01:25:16,199<br>And then some client, reader object one.</p>
<p>1044<br>01:25:16,199 –&gt; 01:25:25,199<br>Are you going to get basically, you know, if you have a client that reads both objects, are you going to guarantee to see total order and linearize.</p>
<p>1045<br>01:25:25,199 –&gt; 01:25:27,199<br>Serialized building.</p>
<p>1046<br>01:25:27,199 –&gt; 01:25:30,199<br>And serialized bill is slightly different.</p>
<p>1047<br>01:25:30,199 –&gt; 01:25:32,199<br>What’s not talking about serialized bill.</p>
<p>1048<br>01:25:32,199 –&gt; 01:25:36,199<br>We’ll come back and we’ll get to get that later in a couple of weeks.</p>
<p>1049<br>01:25:36,199 –&gt; 01:25:41,199<br>And.</p>
<p>1050<br>01:25:41,199 –&gt; 01:25:44,199<br>I’m asking to do actually make a commitment right now.</p>
<p>1051<br>01:25:44,199 –&gt; 01:25:46,199<br>I need to think a little bit about it.</p>
<p>1052<br>01:25:46,199 –&gt; 01:25:48,199<br>Okay. That’s really good.</p>
<p>1053<br>01:25:48,199 –&gt; 01:25:55,199<br>So the question is like, you know, you have consistency or linearized ability for a single client reading and writing.</p>
<p>1054<br>01:25:55,199 –&gt; 01:25:57,199<br>But not for.</p>
<p>1055<br>01:25:57,199 –&gt; 01:25:59,199<br>On multiple objects.</p>
<p>1056<br>01:25:59,199 –&gt; 01:26:06,199<br>You have even multiple clients talking to this, you know, I’m doing operations on the same object, have strong linearized, have linearized ability.</p>
<p>1057<br>01:26:06,199 –&gt; 01:26:07,199<br>Recognition scheme.</p>
<p>1058<br>01:26:07,199 –&gt; 01:26:13,199<br>The question is, we have, you know, linearized ability across objects too.</p>
<p>1059<br>01:26:13,199 –&gt; 01:26:16,199<br>But why is that important?</p>
<p>1060<br>01:26:16,199 –&gt; 01:26:20,199<br>I don’t see where, like, where that would be important.</p>
<p>1061<br>01:26:20,199 –&gt; 01:26:22,199<br>Like.</p>
<p>1062<br>01:26:22,199 –&gt; 01:26:25,199<br>Because you’re, you’re going to like.</p>
<p>1063<br>01:26:25,199 –&gt; 01:26:28,199<br>You can’t group operations, right?</p>
<p>1064<br>01:26:28,199 –&gt; 01:26:31,199<br>So like a write and write or.</p>
<p>1065<br>01:26:31,199 –&gt; 01:26:38,199<br>I mean, you read object one, you write object one, you read object one, then you read up to you write object to.</p>
<p>1066<br>01:26:38,199 –&gt; 01:26:41,199<br>And, you know, the.</p>
<p>1067<br>01:26:41,199 –&gt; 01:26:46,199<br>The question is, you know, in linearized ability, you know, those, those operations need to be told the order.</p>
<p>1068<br>01:26:46,199 –&gt; 01:26:53,199<br>And they need to pursue a preserve this property off real time.</p>
<p>1069<br>01:26:53,199 –&gt; 01:27:01,199<br>And since you’re here, you have different chain that might not actually not have it, but I don’t want to commit to no statement about it all across change.</p>
<p>1070<br>01:27:01,199 –&gt; 01:27:08,199<br>You know, within the chain is actually guaranteed linearized ability, even if you have different objects.</p>
<p>1071<br>01:27:08,199 –&gt; 01:27:14,199<br>There’s something I don’t understand on the paper, which is the update propagation invariant.</p>
<p>1072<br>01:27:14,199 –&gt; 01:27:18,199<br>Where like, sort of the.</p>
<p>1073<br>01:27:18,199 –&gt; 01:27:21,199<br>For in this order of the chain.</p>
<p>1074<br>01:27:21,199 –&gt; 01:27:22,199<br>Yep.</p>
<p>1075<br>01:27:22,199 –&gt; 01:27:28,199<br>And so, you know, like, commits are prefix of each successor’s commits.</p>
<p>1076<br>01:27:28,199 –&gt; 01:27:29,199<br>Yep.</p>
<p>1077<br>01:27:29,199 –&gt; 01:27:35,199<br>Is that guaranteed after like a full pass has gone through the chain.</p>
<p>1078<br>01:27:35,199 –&gt; 01:27:42,199<br>It’s always true. Right. Like, you know, if you go back to this picture here.</p>
<p>1079<br>01:27:42,199 –&gt; 01:27:48,199<br>I mean, the make up basically very simple observation, which is like, you see, you can find a good picture.</p>
<p>1080<br>01:27:48,199 –&gt; 01:27:53,199<br>That probably scribbled over everything. So it’s going to be maybe not as clean.</p>
<p>1081<br>01:27:53,199 –&gt; 01:27:58,199<br>Basically what they’re saying, like if you look at this figure, correct, that.</p>
<p>1082<br>01:27:58,199 –&gt; 01:28:06,199<br>S3 always has a prefix with S2 and S2 always has a prefix with S1.</p>
<p>1083<br>01:28:06,199 –&gt; 01:28:10,199<br>And that’s the only thing of basically that invariance test.</p>
<p>1084<br>01:28:10,199 –&gt; 01:28:11,199<br>Oh, the.</p>
<p>1085<br>01:28:11,199 –&gt; 01:28:13,199<br>So I and J.</p>
<p>1086<br>01:28:13,199 –&gt; 01:28:17,199<br>So the one out the successor is has the prefix of the predecessor.</p>
<p>1087<br>01:28:17,199 –&gt; 01:28:20,199<br>And this is slightly compusing. I just realized that later.</p>
<p>1088<br>01:28:20,199 –&gt; 01:28:23,199<br>I have to somebody else ask this question.</p>
<p>1089<br>01:28:23,199 –&gt; 01:28:29,199<br>In the definition, the ice and jays are used to two different ways.</p>
<p>1090<br>01:28:29,199 –&gt; 01:28:32,199<br>Well, not really different ways of one is a definition.</p>
<p>1091<br>01:28:32,199 –&gt; 01:28:36,199<br>And one is actually the invariant.</p>
<p>1092<br>01:28:36,199 –&gt; 01:28:40,199<br>And you’re going to be a little bit careful.</p>
<p>1093<br>01:28:40,199 –&gt; 01:28:43,199<br>The rules of ice and jays in the very other round.</p>
<p>1094<br>01:28:43,199 –&gt; 01:28:44,199<br>Yeah, exactly.</p>
<p>1095<br>01:28:44,199 –&gt; 01:28:47,199<br>Thank you.</p>
<p>1096<br>01:28:47,199 –&gt; 01:28:50,199<br>You’re welcome.</p>
<p>1097<br>01:28:50,199 –&gt; 01:28:52,199<br>So.</p>
<p>1098<br>01:28:52,199 –&gt; 01:28:54,199<br>Yeah, go ahead.</p>
<p>1099<br>01:28:54,199 –&gt; 01:29:00,199<br>I was just going to ask what happens when you have like a network partition instead of a crash.</p>
<p>1100<br>01:29:00,199 –&gt; 01:29:03,199<br>So if you go to like the crash slide.</p>
<p>1101<br>01:29:03,199 –&gt; 01:29:06,199<br>What happens to the chain if there is a network partition.</p>
<p>1102<br>01:29:06,199 –&gt; 01:29:11,199<br>So maybe ask something like a like S2 is actually still alive.</p>
<p>1103<br>01:29:11,199 –&gt; 01:29:16,199<br>But there’s a partition between the configuration manager and an S2 or something.</p>
<p>1104<br>01:29:16,199 –&gt; 01:29:20,199<br>And so now both S1 and S2 are pointing to S3.</p>
<p>1105<br>01:29:20,199 –&gt; 01:29:22,199<br>No, no, no, no.</p>
<p>1106<br>01:29:22,199 –&gt; 01:29:24,199<br>Yeah, yeah, yeah.</p>
<p>1107<br>01:29:24,199 –&gt; 01:29:25,199<br>Okay, there’s going to be some.</p>
<p>1108<br>01:29:25,199 –&gt; 01:29:30,199<br>I’m assuming what I think the papers are talking about this, but I assume that all configurations are numbered.</p>
<p>1109<br>01:29:30,199 –&gt; 01:29:32,199<br>Like a view number.</p>
<p>1110<br>01:29:32,199 –&gt; 01:29:39,199<br>And S3 will not accept any commands from S2 if the view numbers don’t match.</p>
<p>1111<br>01:29:39,199 –&gt; 01:29:42,199<br>Okay, got it. Thank you.</p>
<p>1112<br>01:29:42,199 –&gt; 01:29:48,199<br>So related to that, one thing I couldn’t figure out is even with like configuration numbers or something.</p>
<p>1113<br>01:29:48,199 –&gt; 01:29:53,199<br>Yeah, how do you make sure that when you get rid of the tail and like the third scenario you’ve drawn.</p>
<p>1114<br>01:29:53,199 –&gt; 01:29:59,199<br>Now that when you get rid of the tail that all the clients that might issue a read are aware that this old series no longer tell clients.</p>
<p>1115<br>01:29:59,199 –&gt; 01:30:05,199<br>I think the way you would do it is that the configuration when the client download the configuration from the.</p>
<p>1116<br>01:30:05,199 –&gt; 01:30:06,199<br>Configuration manager.</p>
<p>1117<br>01:30:06,199 –&gt; 01:30:13,199<br>And every operating includes the view number and S3 will see hey, there’s an old view number.</p>
<p>1118<br>01:30:13,199 –&gt; 01:30:15,199<br>Don’t talk to you about.</p>
<p>1119<br>01:30:15,199 –&gt; 01:30:22,199<br>I guess when then does the clients talk the configurations over to get a new view number because I’m worried about the scenario where there’s a client that has an old.</p>
<p>1120<br>01:30:22,199 –&gt; 01:30:32,199<br>So for example, the S2 can just retry saying like retry and the client then go back to the configuration server and reread to the state.</p>
<p>1121<br>01:30:32,199 –&gt; 01:30:38,199<br>I guess what I’m worried about is like S3 has been never partitioned away from the court from the coordinator.</p>
<p>1122<br>01:30:38,199 –&gt; 01:30:42,199<br>And so the coordinator like gets rid of S3 from the tail and increases the version number.</p>
<p>1123<br>01:30:42,199 –&gt; 01:30:52,199<br>But some client out there doesn’t find out that the version numbers increase and still thinks S3 is the tail talks to S3 doesn’t read meanwhile people are doing rights to S1 S2 and.</p>
<p>1124<br>01:30:52,199 –&gt; 01:30:56,199<br>They haven’t heard or haven’t seen that basically.</p>
<p>1125<br>01:30:56,199 –&gt; 01:31:02,199<br>Yeah, this is probably the reason why in the paper to go through the proxy.</p>
<p>1126<br>01:31:02,199 –&gt; 01:31:03,199<br>I see.</p>
<p>1127<br>01:31:03,199 –&gt; 01:31:08,199<br>Okay.</p>
<p>1128<br>01:31:08,199 –&gt; 01:31:16,199<br>I have a question kind of going back to that like unanswered question about kind of like cross object.</p>
<p>1129<br>01:31:16,199 –&gt; 01:31:20,199<br>So I think that’s the only way to get the answer to that.</p>
<p>1130<br>01:31:20,199 –&gt; 01:31:24,199<br>So I think that’s the only way to get the answer to that.</p>
<p>1131<br>01:31:24,199 –&gt; 01:31:26,199<br>So I think that’s the only way to get the answer to that.</p>
<p>1132<br>01:31:26,199 –&gt; 01:31:28,199<br>So I think that’s the only way to get the answer to that.</p>
<p>1133<br>01:31:28,199 –&gt; 01:31:30,199<br>So I think that’s the only way to get the answer to that.</p>
<p>1134<br>01:31:30,199 –&gt; 01:31:32,199<br>So I think that’s the only way to get the answer to that.</p>
<p>1135<br>01:31:32,199 –&gt; 01:31:34,199<br>So I think that’s the only way to get the answer to that.</p>
<p>1136<br>01:31:34,199 –&gt; 01:31:36,199<br>So I think that’s the only way to get the answer to that.</p>
<p>1137<br>01:31:36,199 –&gt; 01:31:38,199<br>So I think that’s the only way to get the answer to that.</p>
<p>1138<br>01:31:38,199 –&gt; 01:31:40,199<br>So I think that’s the only way to get the answer to that.</p>
<p>1139<br>01:31:40,199 –&gt; 01:31:42,199<br>So I think that’s the only way to get the answer to that.</p>
<p>1140<br>01:31:42,199 –&gt; 01:31:44,199<br>So I think that’s the only way to get the answer to that.</p>
<p>1141<br>01:31:44,199 –&gt; 01:31:46,199<br>No, I would end up in a couple of weeks.</p>
<p>1142<br>01:31:46,199 –&gt; 01:31:47,199<br>Okay, okay.</p>
<p>1143<br>01:31:47,199 –&gt; 01:31:48,199<br>It’s going to be a big topic.</p>
<p>1144<br>01:31:48,199 –&gt; 01:31:50,199<br>I basically have to do two actions.</p>
<p>1145<br>01:31:50,199 –&gt; 01:31:52,199<br>Okay, that’s good.</p>
<p>1146<br>01:31:52,199 –&gt; 01:31:54,199<br>Yeah, thanks.</p>
<p>1147<br>01:31:54,199 –&gt; 01:31:58,199<br>You might be going back to like the third slide.</p>
<p>1148<br>01:31:58,199 –&gt; 01:31:59,199<br>Yep.</p>
<p>1149<br>01:31:59,199 –&gt; 01:32:03,199<br>I think it was the third slide.</p>
<p>1150<br>01:32:03,199 –&gt; 01:32:09,199<br>Maybe not fourth slide.</p>
<p>1151<br>01:32:09,199 –&gt; 01:32:12,199<br>Oh, it’s like sorry.</p>
<p>1152<br>01:32:12,199 –&gt; 01:32:15,199<br>So I was a little bit confused when you mentioned like if</p>
<p>1153<br>01:32:15,199 –&gt; 01:32:18,199<br>Lockholder failed an intermediate state stuff.</p>
<p>1154<br>01:32:18,199 –&gt; 01:32:24,199<br>What exactly on this slide applies to Z-locks and what applies to the go locks again?</p>
<p>1155<br>01:32:24,199 –&gt; 01:32:30,199<br>These are almost all statements about Z-locks.</p>
<p>1156<br>01:32:30,199 –&gt; 01:32:33,199<br>So is the first statement that if the lockholder fails,</p>
<p>1157<br>01:32:33,199 –&gt; 01:32:36,199<br>then the intermediate state is not cleaned up or is cleaned up?</p>
<p>1158<br>01:32:36,199 –&gt; 01:32:38,199<br>No, it gets to do.</p>
<p>1159<br>01:32:38,199 –&gt; 01:32:40,199<br>So if the intermediate state is visible,</p>
<p>1160<br>01:32:40,199 –&gt; 01:32:42,199<br>but then generally if you have a leader election,</p>
<p>1161<br>01:32:42,199 –&gt; 01:32:44,199<br>you could clean up the intermediate state.</p>
<p>1162<br>01:32:44,199 –&gt; 01:32:47,199<br>That was just the point.</p>
<p>1163<br>01:32:47,199 –&gt; 01:32:53,199<br>Oh, so with with go locks is that also not the case like if there’s a machine that’s holding a go lock.</p>
<p>1164<br>01:32:53,199 –&gt; 01:32:55,199<br>That’s doing stuff and then it.</p>
<p>1165<br>01:32:55,199 –&gt; 01:33:00,199<br>Obstetting dies isn’t still the intermediate state visible.</p>
<p>1166<br>01:33:00,199 –&gt; 01:33:03,199<br>Okay, I think what I’m talking about is go locks, you know,</p>
<p>1167<br>01:33:03,199 –&gt; 01:33:07,199<br>is something that’s a statement about multiple threats running on the same machine.</p>
<p>1168<br>01:33:07,199 –&gt; 01:33:20,199<br>And so if the go lock disappears because machine crashes on the threads are not machine crash too.</p>
<p>1169<br>01:33:20,199 –&gt; 01:33:27,199<br>Right, but when you say that the intermediate state is visible to other people.</p>
<p>1170<br>01:33:27,199 –&gt; 01:33:30,199<br>That’s still true for go locks though, right?</p>
<p>1171<br>01:33:30,199 –&gt; 01:33:34,199<br>You know, if they written persistent state to disk.</p>
<p>1172<br>01:33:34,199 –&gt; 01:33:40,199<br>Or into some shared file system, but like no, the machine is gone, the disk is gone, everything’s gone.</p>
<p>1173<br>01:33:40,199 –&gt; 01:33:46,199<br>Oh, got it. Okay. So it’s saying that the pers like the persistence like intermediate state is persistent.</p>
<p>1174<br>01:33:46,199 –&gt; 01:33:49,199<br>The zookeeper intermediate state might be visible very often.</p>
<p>1175<br>01:33:49,199 –&gt; 01:33:54,199<br>The leading the guy might have created some more files and those are visible now.</p>
<p>1176<br>01:33:54,199 –&gt; 01:33:57,199<br>Okay, I see. Thank you.</p>
<p>1177<br>01:33:57,199 –&gt; 01:34:04,199<br>So I just follow up on that. So it’s the implication that if a go routine ever dies while holding the lock.</p>
<p>1178<br>01:34:04,199 –&gt; 01:34:07,199<br>The entire go program must have died too.</p>
<p>1179<br>01:34:07,199 –&gt; 01:34:15,199<br>And there’s that you can never have a good go routine die holding a lot with that with and like have other parts of program continue with.</p>
<p>1180<br>01:34:15,199 –&gt; 01:34:19,199<br>The go routine crashes, the application crashes.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>MIT6824 P11Lecture11 ChainReplication</div>
      <div>http://example.com/2025/10/25/MIT6824 P11Lecture11-ChainReplication/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年10月25日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/10/25/MIT6824%20P10Lecture10-GuestLectureonGo-RussCox/" title="MIT6824 P10Lecture10 GuestLectureonGo RussCox">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">MIT6824 P10Lecture10 GuestLectureonGo RussCox</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/10/25/CS144-networkP977-3PhysicalandLink/" title="CS144 NetworkP977 3PhysicalandLink">
                        <span class="hidden-mobile">CS144 NetworkP977 3PhysicalandLink</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
