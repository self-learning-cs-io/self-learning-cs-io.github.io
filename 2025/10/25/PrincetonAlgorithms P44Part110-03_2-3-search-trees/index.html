

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="100:00:00,000 –&gt; 00:00:04,520Welcome back. 200:00:04,520 –&gt; 00:00:08,419Today we’re going to talk about balance search trees, which will lead us to an ultimate 300:00:08,419 –&gt; 00:00:15,560sy">
<meta property="og:type" content="article">
<meta property="og:title" content="PrincetonAlgorithms P44Part110 03_2 3 Search Trees">
<meta property="og:url" content="http://example.com/2025/10/25/PrincetonAlgorithms%20P44Part110-03_2-3-search-trees/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="100:00:00,000 –&gt; 00:00:04,520Welcome back. 200:00:04,520 –&gt; 00:00:08,419Today we’re going to talk about balance search trees, which will lead us to an ultimate 300:00:08,419 –&gt; 00:00:15,560sy">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-10-25T05:03:39.826Z">
<meta property="article:modified_time" content="2025-10-25T05:03:39.826Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>PrincetonAlgorithms P44Part110 03_2 3 Search Trees - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="PrincetonAlgorithms P44Part110 03_2 3 Search Trees"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-10-25 13:03" pubdate>
          2025年10月25日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.2k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          19 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">PrincetonAlgorithms P44Part110 03_2 3 Search Trees</h1>
            
            
              <div class="markdown-body">
                
                <p>1<br>00:00:00,000 –&gt; 00:00:04,520<br>Welcome back.</p>
<p>2<br>00:00:04,520 –&gt; 00:00:08,419<br>Today we’re going to talk about balance search trees, which will lead us to an ultimate</p>
<p>3<br>00:00:08,419 –&gt; 00:00:15,560<br>symbol table implementation that can provide fast performance for all the symbol table operations.</p>
<p>4<br>00:00:15,560 –&gt; 00:00:18,400<br>We’ve looked at guaranteed.</p>
<p>5<br>00:00:18,400 –&gt; 00:00:23,320<br>So here’s a review of where we were with symbol tables.</p>
<p>6<br>00:00:23,320 –&gt; 00:00:30,480<br>We took a look at the last time at the binary search tree, which if things are well modeled</p>
<p>7<br>00:00:30,480 –&gt; 00:00:34,399<br>by random insertions have great performance.</p>
<p>8<br>00:00:34,399 –&gt; 00:00:39,000<br>They get searched and it’s searched on a time proportional to log base two event, and they</p>
<p>9<br>00:00:39,000 –&gt; 00:00:41,840<br>support ordered operations.</p>
<p>10<br>00:00:41,840 –&gt; 00:00:47,560<br>But really our goal is to have these operations be guaranteed to take time proportional to</p>
<p>11<br>00:00:47,560 –&gt; 00:00:53,820<br>log in because we don’t have control over the order of operations and they may not be</p>
<p>12<br>00:00:53,820 –&gt; 00:00:55,280<br>random at all.</p>
<p>13<br>00:00:55,280 –&gt; 00:01:00,400<br>And in fact in many real applications they’re not very random.</p>
<p>14<br>00:01:00,400 –&gt; 00:01:04,920<br>So that’s what we’re going to look at now is try to find an implementation that can guarantee</p>
<p>15<br>00:01:04,920 –&gt; 00:01:09,480<br>to be fast for all the symbol table operations.</p>
<p>16<br>00:01:09,480 –&gt; 00:01:12,200<br>That’s our challenge.</p>
<p>17<br>00:01:12,200 –&gt; 00:01:19,040<br>So what we’re going to talk about to do is an algorithm that actually pretty old algorithm</p>
<p>18<br>00:01:19,040 –&gt; 00:01:25,480<br>called two three trees in a particular implementation that requires very little code called left-leaning</p>
<p>19<br>00:01:25,480 –&gt; 00:01:27,520<br>red-black BSTs.</p>
<p>20<br>00:01:27,520 –&gt; 00:01:31,040<br>And then we’ll talk about a generalization called Btrees.</p>
<p>21<br>00:01:31,040 –&gt; 00:01:39,240<br>And these methods are all widely used throughout our computational infrastructure.</p>
<p>22<br>00:01:39,239 –&gt; 00:01:45,079<br>To start we’ll talk about two three search trees which is a model that underlies the</p>
<p>23<br>00:01:45,079 –&gt; 00:01:51,159<br>concise and efficient implementation that we’re going to look at.</p>
<p>24<br>00:01:51,159 –&gt; 00:01:57,959<br>So a two three tree is a way to generalize BSTs to provide the flexibility that we need</p>
<p>25<br>00:01:57,959 –&gt; 00:02:00,239<br>to guarantee fast performance.</p>
<p>26<br>00:02:00,239 –&gt; 00:02:02,319<br>And the idea is very simple.</p>
<p>27<br>00:02:02,319 –&gt; 00:02:05,399<br>We allow one or two keys per node.</p>
<p>28<br>00:02:05,400 –&gt; 00:02:10,640<br>That is we allow for the possibility of something called a three node that can hold two keys,</p>
<p>29<br>00:02:10,640 –&gt; 00:02:13,080<br>but then it has to have three children.</p>
<p>30<br>00:02:13,080 –&gt; 00:02:18,520<br>In a regular BST node, a two node we have one link for the keys that are less than the key</p>
<p>31<br>00:02:18,520 –&gt; 00:02:21,759<br>in the node and one link for the keys that are greater.</p>
<p>32<br>00:02:21,759 –&gt; 00:02:27,879<br>In a three node we need three links, one for less, one for between and one for greater.</p>
<p>33<br>00:02:27,879 –&gt; 00:02:32,520<br>Another property of these two three trees is that we’re going to have perfect balance.</p>
<p>34<br>00:02:32,520 –&gt; 00:02:39,560<br>That is every path from the root to a null link is going to have the same length in a two three tree.</p>
<p>35<br>00:02:39,560 –&gt; 00:02:47,080<br>So as I mentioned, the symmetric order is part of the definition of a two three tree.</p>
<p>36<br>00:02:47,080 –&gt; 00:02:50,560<br>Every three node has three links and two keys.</p>
<p>37<br>00:02:50,560 –&gt; 00:02:56,120<br>The left link is for the keys that are, that points to a two three tree with the keys that</p>
<p>38<br>00:02:56,120 –&gt; 00:03:00,000<br>are smaller than the smaller of the two keys in the three node.</p>
<p>39<br>00:03:00,000 –&gt; 00:03:05,479<br>The middle link points to a two three tree that contains all the keys that are between the two keys.</p>
<p>40<br>00:03:05,479 –&gt; 00:03:12,840<br>And the right link points to a two three tree containing all the keys that are larger than the larger the two keys in the three node.</p>
<p>41<br>00:03:12,840 –&gt; 00:03:17,759<br>Okay, let’s take a look at a demo of searching in a two three tree.</p>
<p>42<br>00:03:17,759 –&gt; 00:03:25,520<br>So say we have this two three tree here and we want to search for whether or not H is one of the keys in the tree.</p>
<p>43<br>00:03:25,520 –&gt; 00:03:38,520<br>So we start at the root, compare the search key against the key or keys in the node and follow the link corresponding to the interval that we know must contain the search key by the definition of the tree.</p>
<p>44<br>00:03:38,520 –&gt; 00:03:41,439<br>And then we recursively continue the search.</p>
<p>45<br>00:03:41,439 –&gt; 00:03:50,160<br>So if we’re looking for H, it’s less than M. So the only place it could be in this two three tree is in the two three tree on the left link.</p>
<p>46<br>00:03:50,160 –&gt; 00:03:52,960<br>So we follow the left link.</p>
<p>47<br>00:03:52,960 –&gt; 00:03:56,960<br>Now we compare H with E and J and in this case it’s between.</p>
<p>48<br>00:03:56,960 –&gt; 00:03:58,599<br>So now we’re going to take the middle link.</p>
<p>49<br>00:03:58,599 –&gt; 00:04:02,159<br>That’s the only place that H possibly could be.</p>
<p>50<br>00:04:02,159 –&gt; 00:04:09,600<br>And in this case, that node, one node to three tree contains H. So that’s a search hit.</p>
<p>51<br>00:04:09,600 –&gt; 00:04:12,840<br>Let’s take another example for unsuccessful search.</p>
<p>52<br>00:04:12,840 –&gt; 00:04:15,680<br>A key that’s not in the tree.</p>
<p>53<br>00:04:15,680 –&gt; 00:04:17,199<br>As usual, we start at the root.</p>
<p>54<br>00:04:17,199 –&gt; 00:04:19,800<br>It’s less so we go left.</p>
<p>55<br>00:04:19,800 –&gt; 00:04:21,360<br>It’s less than both keys.</p>
<p>56<br>00:04:21,360 –&gt; 00:04:25,360<br>So if it’s in the tree, it would have to be in the left link.</p>
<p>57<br>00:04:25,360 –&gt; 00:04:27,160<br>And it’s between those two keys.</p>
<p>58<br>00:04:27,160 –&gt; 00:04:30,400<br>So if it’s in the tree, it would have to be on the middle link.</p>
<p>59<br>00:04:30,400 –&gt; 00:04:34,120<br>And that link is null, so that’s a search miss.</p>
<p>60<br>00:04:34,120 –&gt; 00:04:41,280<br>So the search is a natural generalization of the search in binary search trees.</p>
<p>61<br>00:04:41,280 –&gt; 00:04:43,120<br>Now what about inserting?</p>
<p>62<br>00:04:43,120 –&gt; 00:04:50,600<br>Well, it’s a similar type of strategy as with regular binary search trees,</p>
<p>63<br>00:04:50,600 –&gt; 00:04:56,040<br>except that we manipulate the two and three nodes to keep perfect balance in the tree.</p>
<p>64<br>00:04:56,040 –&gt; 00:05:00,920<br>So the easy case is if the key winds up in a two node at the bottom like this one.</p>
<p>65<br>00:05:00,920 –&gt; 00:05:06,519<br>Suppose we’re inserting K. K is less than M, so we go left.</p>
<p>66<br>00:05:06,519 –&gt; 00:05:10,519<br>K is greater than both keys, so we go right.</p>
<p>67<br>00:05:10,519 –&gt; 00:05:16,359<br>K is less than L, so the search ends at the left link of L.</p>
<p>68<br>00:05:16,359 –&gt; 00:05:22,199<br>And to perform an insertion, all we need to do is replace that two node with a three</p>
<p>69<br>00:05:22,199 –&gt; 00:05:24,599<br>node containing K.</p>
<p>70<br>00:05:24,599 –&gt; 00:05:30,319<br>Now K is inserted into the two three tree and it satisfies all the rules.</p>
<p>71<br>00:05:30,319 –&gt; 00:05:34,639<br>Now if we’re inserting into a three node at the bottom, we have to do more work.</p>
<p>72<br>00:05:34,639 –&gt; 00:05:40,319<br>And specifically, the work we do is we add the key to a three node to create a temporary</p>
<p>73<br>00:05:40,319 –&gt; 00:05:45,959<br>four node and then split up that four node and move its middle key into the parent.</p>
<p>74<br>00:05:45,959 –&gt; 00:05:49,319<br>So let’s see an example.</p>
<p>75<br>00:05:49,319 –&gt; 00:05:55,040<br>If we’re going to insert Z into this tree, it’s greater than N, so we go to the right.</p>
<p>76<br>00:05:55,040 –&gt; 00:05:58,120<br>It’s greater than R, so we go to the right.</p>
<p>77<br>00:05:58,120 –&gt; 00:06:03,959<br>Now it’s greater than X and that’s an L link to the right of X, so the search ends there</p>
<p>78<br>00:06:03,959 –&gt; 00:06:09,159<br>and what we’d want to do is insert Z into that three node.</p>
<p>79<br>00:06:09,160 –&gt; 00:06:16,760<br>And the way we do it is first make a temporary four node that replaces that three node.</p>
<p>80<br>00:06:16,760 –&gt; 00:06:22,640<br>And then that’s not a two three tree because it’s got that one four node with three keys</p>
<p>81<br>00:06:22,640 –&gt; 00:06:24,720<br>and four links.</p>
<p>82<br>00:06:24,720 –&gt; 00:06:31,640<br>But what we can do is split that four node and pass the middle key up to its parent.</p>
<p>83<br>00:06:31,640 –&gt; 00:06:37,720<br>So split it into two two nodes and pass the middle key to the parent.</p>
<p>84<br>00:06:37,720 –&gt; 00:06:43,680<br>That’s kind of a magical operation and believe me, it’s easier to get it done in the implementation</p>
<p>85<br>00:06:43,680 –&gt; 00:06:45,280<br>than the graphics.</p>
<p>86<br>00:06:45,280 –&gt; 00:06:52,040<br>But now you can see that that local transformation on the two three tree completes the insertion.</p>
<p>87<br>00:06:52,040 –&gt; 00:06:56,240<br>Now if that parent were a three node, it would become a temporary four node and would</p>
<p>88<br>00:06:56,240 –&gt; 00:07:00,240<br>continue the process moving up the tree.</p>
<p>89<br>00:07:00,240 –&gt; 00:07:04,200<br>That’s a demo of searching insertion in a two three tree.</p>
<p>90<br>00:07:04,200 –&gt; 00:07:07,120<br>So let’s look at a double split like that.</p>
<p>91<br>00:07:07,120 –&gt; 00:07:11,240<br>So say we’re inserting L into this tree.</p>
<p>92<br>00:07:11,240 –&gt; 00:07:16,560<br>So it goes down to the middle and winds up needing to be inserted in the three node in</p>
<p>93<br>00:07:16,560 –&gt; 00:07:17,959<br>the middle.</p>
<p>94<br>00:07:17,959 –&gt; 00:07:20,600<br>So we’re going to convert that into a four node.</p>
<p>95<br>00:07:20,600 –&gt; 00:07:22,920<br>Now L is the middle key of that one.</p>
<p>96<br>00:07:22,920 –&gt; 00:07:31,240<br>So we’re going to split that four node into two two nodes and move L to the parent.</p>
<p>97<br>00:07:31,240 –&gt; 00:07:36,560<br>The four node had four links and the two two nodes have four links.</p>
<p>98<br>00:07:36,560 –&gt; 00:07:39,519<br>So nothing has to be changed below.</p>
<p>99<br>00:07:39,519 –&gt; 00:07:45,720<br>And then this insertion into the parent changed it from a three node into a four node, essentially</p>
<p>100<br>00:07:45,720 –&gt; 00:07:50,720<br>adding a link because of the split with the two two nodes where there was only one three</p>
<p>101<br>00:07:50,720 –&gt; 00:07:52,240<br>node before.</p>
<p>102<br>00:07:52,240 –&gt; 00:07:53,959<br>But now that’s not a two three tree.</p>
<p>103<br>00:07:53,959 –&gt; 00:07:55,840<br>So we have to split again.</p>
<p>104<br>00:07:55,840 –&gt; 00:07:58,000<br>And in this case, there’s no parent.</p>
<p>105<br>00:07:58,000 –&gt; 00:08:03,639<br>So we create a new one and the height of the tree increases by one.</p>
<p>106<br>00:08:03,639 –&gt; 00:08:08,360<br>It’s the only time the height of a two three tree changes when the root splits the height</p>
<p>107<br>00:08:08,360 –&gt; 00:08:12,959<br>introduces increases by one.</p>
<p>108<br>00:08:12,959 –&gt; 00:08:19,120<br>So that’s a demo of insertion into a three node at the bottom in a two three tree that</p>
<p>109<br>00:08:19,120 –&gt; 00:08:21,439<br>percolates all the way to the top.</p>
<p>110<br>00:08:21,439 –&gt; 00:08:26,439<br>Now let’s look at constructing a two three tree from an initially empty tree.</p>
<p>111<br>00:08:26,439 –&gt; 00:08:30,839<br>So if we start by just inserting a key, well, that just creates a two node containing</p>
<p>112<br>00:08:30,839 –&gt; 00:08:33,319<br>that key.</p>
<p>113<br>00:08:33,320 –&gt; 00:08:34,680<br>And that’s a legal two three tree.</p>
<p>114<br>00:08:34,680 –&gt; 00:08:35,800<br>So we’re fine.</p>
<p>115<br>00:08:35,800 –&gt; 00:08:43,720<br>Now inserting e into that, well, it’s going to be if it’s in the tree left of S, that’s</p>
<p>116<br>00:08:43,720 –&gt; 00:08:44,720<br>a null link.</p>
<p>117<br>00:08:44,720 –&gt; 00:08:49,240<br>So we need to convert that two node into a three node.</p>
<p>118<br>00:08:49,240 –&gt; 00:08:51,160<br>Okay, and that’s a legal two three tree.</p>
<p>119<br>00:08:51,160 –&gt; 00:08:52,160<br>So we stop.</p>
<p>120<br>00:08:52,160 –&gt; 00:08:58,040<br>And inserting a into that, we convert that three node into a temporary four node.</p>
<p>121<br>00:08:58,040 –&gt; 00:09:01,800<br>But then we need to split that four node moving e to the parent.</p>
<p>122<br>00:09:01,799 –&gt; 00:09:06,639<br>And that creates a new root node and increases the size of the tree by one.</p>
<p>123<br>00:09:06,639 –&gt; 00:09:08,439<br>But now that’s a legal two three tree.</p>
<p>124<br>00:09:08,439 –&gt; 00:09:10,679<br>So we stop.</p>
<p>125<br>00:09:10,679 –&gt; 00:09:16,879<br>Insert r into that, it goes to the right of e, convert into a three node.</p>
<p>126<br>00:09:16,879 –&gt; 00:09:23,479<br>Now insert c into that, goes to the left of e, has to be joined with a into a new three</p>
<p>127<br>00:09:23,479 –&gt; 00:09:24,479<br>node.</p>
<p>128<br>00:09:24,479 –&gt; 00:09:27,759<br>Again, that’s a legal two three tree and we stop.</p>
<p>129<br>00:09:27,759 –&gt; 00:09:31,659<br>Now we insert h, the guy that goes to the right of e, that three</p>
<p>130<br>00:09:31,659 –&gt; 00:09:34,259<br>node gets converted into a four node.</p>
<p>131<br>00:09:34,259 –&gt; 00:09:35,699<br>That’s a temporary four node.</p>
<p>132<br>00:09:35,699 –&gt; 00:09:40,379<br>We split and move r to the parent.</p>
<p>133<br>00:09:40,379 –&gt; 00:09:44,579<br>Now that parent’s a legal three node and there’s nothing more to be done.</p>
<p>134<br>00:09:44,579 –&gt; 00:09:48,059<br>We have a legal three three, two three tree.</p>
<p>135<br>00:09:48,059 –&gt; 00:09:51,819<br>Insert x, bigger than r, goes to the right.</p>
<p>136<br>00:09:51,819 –&gt; 00:09:56,939<br>There’s a two node, there’s room for the x.</p>
<p>137<br>00:09:56,939 –&gt; 00:10:01,620<br>Insert p, that goes between e and r.</p>
<p>138<br>00:10:01,620 –&gt; 00:10:06,740<br>The two node containing h, right link is null, so we convert that two node into a three</p>
<p>139<br>00:10:06,740 –&gt; 00:10:07,740<br>node.</p>
<p>140<br>00:10:07,740 –&gt; 00:10:10,179<br>And now we have a legal two three tree.</p>
<p>141<br>00:10:10,179 –&gt; 00:10:15,820<br>Now you can see this next insertion is going to cause some splitting wherever it is.</p>
<p>142<br>00:10:15,820 –&gt; 00:10:19,179<br>So insert l, that’s between e and r.</p>
<p>143<br>00:10:19,179 –&gt; 00:10:22,860<br>So it goes in the three node containing h and p.</p>
<p>144<br>00:10:22,860 –&gt; 00:10:29,940<br>We convert that into a temporary four node, split that four node moving l to the parent.</p>
<p>145<br>00:10:29,940 –&gt; 00:10:36,640<br>Now that parent’s a four node and that has to be split and we create a new root node</p>
<p>146<br>00:10:36,640 –&gt; 00:10:39,820<br>and then the height of the tree grows by one.</p>
<p>147<br>00:10:39,820 –&gt; 00:10:43,060<br>And that’s a legal two three tree, so we stop.</p>
<p>148<br>00:10:43,060 –&gt; 00:10:48,620<br>So those local transformations converting a two node to a three node or converting a three</p>
<p>149<br>00:10:48,620 –&gt; 00:10:53,460<br>to a four and then splitting and passing a node up, those are the operating operations</p>
<p>150<br>00:10:53,460 –&gt; 00:10:59,700<br>we need to consider to get balance in our search trees.</p>
<p>151<br>00:10:59,700 –&gt; 00:11:06,500<br>All right, so as I’ve mentioned in this diagram shows the splitting of four node in a two</p>
<p>152<br>00:11:06,500 –&gt; 00:11:09,259<br>three tree is a local transformation.</p>
<p>153<br>00:11:09,259 –&gt; 00:11:13,220<br>It only involves changing a constant number of links.</p>
<p>154<br>00:11:13,220 –&gt; 00:11:21,019<br>So in this example shows the general situation when the four node to be split is the middle</p>
<p>155<br>00:11:21,019 –&gt; 00:11:24,220<br>link but the same is true if it’s a left or right.</p>
<p>156<br>00:11:24,220 –&gt; 00:11:28,179<br>And those six sub trees drawn could be huge.</p>
<p>157<br>00:11:28,179 –&gt; 00:11:32,419<br>They can contain millions of keys but it doesn’t matter what they contain.</p>
<p>158<br>00:11:32,419 –&gt; 00:11:33,779<br>We don’t touch them at all.</p>
<p>159<br>00:11:33,779 –&gt; 00:11:40,019<br>Nor do we touch anything above this node in the tree until the split happens.</p>
<p>160<br>00:11:40,019 –&gt; 00:11:46,419<br>So the transformation that splits that BCD node and inserts the c into the three node at</p>
<p>161<br>00:11:46,419 –&gt; 00:11:54,939<br>the root just involves making that three node into a temporary four node and making that</p>
<p>162<br>00:11:54,939 –&gt; 00:11:59,500<br>four node into two two nodes and adjusting the links appropriately.</p>
<p>163<br>00:11:59,500 –&gt; 00:12:09,099<br>Just a constant number of operations and that’s why this operation is in general efficient.</p>
<p>164<br>00:12:09,100 –&gt; 00:12:18,540<br>So let’s look at just the global properties that these manipulations preserve.</p>
<p>165<br>00:12:18,540 –&gt; 00:12:24,779<br>The two things that are critical is that in a two three tree we always have some metric</p>
<p>166<br>00:12:24,779 –&gt; 00:12:32,220<br>order that is the order that we defined for two nodes and three nodes and we also have</p>
<p>167<br>00:12:32,220 –&gt; 00:12:33,220<br>perfect balance.</p>
<p>168<br>00:12:33,220 –&gt; 00:12:36,460<br>The distance from the root to the bottom is always the same.</p>
<p>169<br>00:12:36,460 –&gt; 00:12:42,019<br>And to prove that we just need to show that each transformation maintains symmetric order</p>
<p>170<br>00:12:42,019 –&gt; 00:12:43,900<br>and perfect balance.</p>
<p>171<br>00:12:43,900 –&gt; 00:12:48,060<br>And these are all the possible transformations that we could do.</p>
<p>172<br>00:12:48,060 –&gt; 00:12:53,900<br>If we split the root then that’s what happens at the root and if there was perfect balance</p>
<p>173<br>00:12:53,900 –&gt; 00:12:58,060<br>before there’s perfect balance after with the height one bigger.</p>
<p>174<br>00:12:58,060 –&gt; 00:13:04,580<br>If the parent was a two node then the transformation is a local transformation and if you look at</p>
<p>175<br>00:13:04,580 –&gt; 00:13:09,980<br>where the links are then it’s easy to see by induction that if there was perfect balance</p>
<p>176<br>00:13:09,980 –&gt; 00:13:14,620<br>before there’s perfect balance afterward because we didn’t change anything about the</p>
<p>177<br>00:13:14,620 –&gt; 00:13:17,020<br>perfect balance in any of those subtrees.</p>
<p>178<br>00:13:17,020 –&gt; 00:13:19,139<br>And that’s true in every case.</p>
<p>179<br>00:13:19,139 –&gt; 00:13:25,180<br>If the three nodes at the right and this one is one higher and those four are one lower</p>
<p>180<br>00:13:25,180 –&gt; 00:13:26,820<br>and afterwards it’s the same.</p>
<p>181<br>00:13:26,820 –&gt; 00:13:30,820<br>If there was perfect balance before there’s perfect balance afterwards because we didn’t</p>
<p>182<br>00:13:30,820 –&gt; 00:13:32,900<br>change the height of any nodes.</p>
<p>183<br>00:13:32,899 –&gt; 00:13:37,259<br>We just moved things around locally within nodes.</p>
<p>184<br>00:13:37,259 –&gt; 00:13:42,139<br>And this is when the parent is a three node then there’s the three cases if we split at</p>
<p>185<br>00:13:42,139 –&gt; 00:13:45,299<br>the left, split at the middle and split at the right.</p>
<p>186<br>00:13:45,299 –&gt; 00:13:52,220<br>And again changing the four node to two nodes and adding links if there was perfect balance</p>
<p>187<br>00:13:52,220 –&gt; 00:13:56,699<br>before this perfect balance after because we didn’t change the heights of anything else</p>
<p>188<br>00:13:56,699 –&gt; 00:13:59,019<br>in the tree.</p>
<p>189<br>00:13:59,019 –&gt; 00:14:05,980<br>So our operations maintain symmetric order in perfect balance in a two three tree.</p>
<p>190<br>00:14:05,980 –&gt; 00:14:12,620<br>So that’s going to give us a very easy way to describe the performance.</p>
<p>191<br>00:14:12,620 –&gt; 00:14:19,179<br>The all our operations have cost that is proportional to the path length from the height</p>
<p>192<br>00:14:19,179 –&gt; 00:14:24,659<br>to the bottom and every path from the root to the link has the same length.</p>
<p>193<br>00:14:24,659 –&gt; 00:14:26,659<br>How long can those paths be?</p>
<p>194<br>00:14:27,059 –&gt; 00:14:32,459<br>Well it’s not hard to see that the in the worst case if there are all two nodes that’s</p>
<p>195<br>00:14:32,459 –&gt; 00:14:36,659<br>the longest they could be it’s log base two of n.</p>
<p>196<br>00:14:36,659 –&gt; 00:14:41,980<br>And if there are all three nodes it would be log base three of n which is less it’s about</p>
<p>197<br>00:14:41,980 –&gt; 00:14:44,980<br>0.63 log base two of n.</p>
<p>198<br>00:14:44,980 –&gt; 00:14:50,459<br>So all the paths in a two three tree with n nodes have to have length between those two</p>
<p>199<br>00:14:50,459 –&gt; 00:14:51,459<br>bounds.</p>
<p>200<br>00:14:51,660 –&gt; 00:14:57,060<br>And those are pretty small numbers for a million nodes that’s between 12 and 20.</p>
<p>201<br>00:14:57,060 –&gt; 00:15:02,660<br>And if it’s a billion nodes that’s between 18 and 30.</p>
<p>202<br>00:15:02,660 –&gt; 00:15:04,660<br>Those are remarkably small numbers.</p>
<p>203<br>00:15:04,660 –&gt; 00:15:09,860<br>So we’re going to have guaranteed performance even for a huge databases.</p>
<p>204<br>00:15:09,860 –&gt; 00:15:14,019<br>We’re going to be able to guarantee that we can get search and insert done with just</p>
<p>205<br>00:15:14,019 –&gt; 00:15:15,860<br>18 to 30 operations.</p>
<p>206<br>00:15:15,860 –&gt; 00:15:19,379<br>That’s quite remarkable really.</p>
<p>207<br>00:15:19,379 –&gt; 00:15:25,059<br>So here’s what our table will look like when we finish the implementation of two three</p>
<p>208<br>00:15:25,059 –&gt; 00:15:26,539<br>trees.</p>
<p>209<br>00:15:26,539 –&gt; 00:15:31,179<br>Every operation is guaranteed to be a constant times log n.</p>
<p>210<br>00:15:31,179 –&gt; 00:15:36,500<br>Now the constant depends on the implementation exactly what kind of manipulations we need</p>
<p>211<br>00:15:36,500 –&gt; 00:15:40,659<br>to do to convert three nodes to four nodes and so forth.</p>
<p>212<br>00:15:40,659 –&gt; 00:15:47,299<br>But it’s easy to see from the demos and the diagrams that those are going to be constant.</p>
<p>213<br>00:15:47,299 –&gt; 00:15:53,099<br>Guaranteed logarithmic performance for all operations, which is certainly what we want</p>
<p>214<br>00:15:53,099 –&gt; 00:15:56,259<br>in a symbol table implementation.</p>
<p>215<br>00:15:56,259 –&gt; 00:15:58,419<br>Now what about the implementation?</p>
<p>216<br>00:15:58,419 –&gt; 00:16:02,299<br>Well we’re actually not going to talk about a direct implementation of two three trees</p>
<p>217<br>00:16:02,299 –&gt; 00:16:05,500<br>because it’s kind of complicated.</p>
<p>218<br>00:16:05,500 –&gt; 00:16:09,379<br>It’s cumbersome to maintain multiple node types.</p>
<p>219<br>00:16:09,379 –&gt; 00:16:15,179<br>You might need multiple compares to move down the tree if there’s a three node that takes</p>
<p>220<br>00:16:15,179 –&gt; 00:16:17,299<br>more compares than a two node.</p>
<p>221<br>00:16:17,299 –&gt; 00:16:19,779<br>So it’s complicated to analyze.</p>
<p>222<br>00:16:19,779 –&gt; 00:16:24,939<br>We have to keep track of links as we go up and down the tree to take you into the splitting</p>
<p>223<br>00:16:24,939 –&gt; 00:16:27,699<br>and there’s a lot of cases.</p>
<p>224<br>00:16:27,699 –&gt; 00:16:34,259<br>I drew all the cases and whether you’re splitting into the middle of a four node or the</p>
<p>225<br>00:16:34,259 –&gt; 00:16:37,179<br>right of a two node is just a lot of cases.</p>
<p>226<br>00:16:37,179 –&gt; 00:16:44,379<br>So you could do it but we’re not going to because there’s a much easier way.</p>
<p>227<br>00:16:44,379 –&gt; 00:16:50,340<br>So that’s two three trees, a model for implementing balanced trees and Guaranteed logarithmic time.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>PrincetonAlgorithms P44Part110 03_2 3 Search Trees</div>
      <div>http://example.com/2025/10/25/PrincetonAlgorithms P44Part110-03_2-3-search-trees/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年10月25日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/10/25/PrincetonAlgorithms%20P43Part19-07_deletion-in-bsts/" title="PrincetonAlgorithms P43Part19 07_deletion In Bsts">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">PrincetonAlgorithms P43Part19 07_deletion In Bsts</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/10/25/PrincetonAlgorithms%20P37Part18-06_event-driven-simulation-optional/" title="PrincetonAlgorithms P37Part18 06_event Driven Simulation Optional">
                        <span class="hidden-mobile">PrincetonAlgorithms P37Part18 06_event Driven Simulation Optional</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
