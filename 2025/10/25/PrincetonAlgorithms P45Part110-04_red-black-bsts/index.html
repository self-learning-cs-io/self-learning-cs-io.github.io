

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="100:00:00,000 –&gt; 00:00:08,480Now we’ll look at red-black BSTs, which is a simple data structure that allows us to implement 200:00:08,480 –&gt; 00:00:16,800two-three trees with very little extra co">
<meta property="og:type" content="article">
<meta property="og:title" content="PrincetonAlgorithms P45Part110 04_red Black Bsts">
<meta property="og:url" content="http://example.com/2025/10/25/PrincetonAlgorithms%20P45Part110-04_red-black-bsts/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="100:00:00,000 –&gt; 00:00:08,480Now we’ll look at red-black BSTs, which is a simple data structure that allows us to implement 200:00:08,480 –&gt; 00:00:16,800two-three trees with very little extra co">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-10-25T05:03:39.827Z">
<meta property="article:modified_time" content="2025-10-25T05:03:39.827Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>PrincetonAlgorithms P45Part110 04_red Black Bsts - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="PrincetonAlgorithms P45Part110 04_red Black Bsts"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-10-25 13:03" pubdate>
          2025年10月25日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.6k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          22 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">PrincetonAlgorithms P45Part110 04_red Black Bsts</h1>
            
            
              <div class="markdown-body">
                
                <p>1<br>00:00:00,000 –&gt; 00:00:08,480<br>Now we’ll look at red-black BSTs, which is a simple data structure that allows us to implement</p>
<p>2<br>00:00:08,480 –&gt; 00:00:16,800<br>two-three trees with very little extra code beyond the basic binary research tree code.</p>
<p>3<br>00:00:16,800 –&gt; 00:00:24,240<br>So this is actually the version that we’re looking at is called left-leaning red-black BSTs.</p>
<p>4<br>00:00:24,959 –&gt; 00:00:31,439<br>On a personal note, I wrote a research paper on this topic in 1979 with Leo Givas,</p>
<p>5<br>00:00:31,439 –&gt; 00:00:36,320<br>and we thought we pretty well understood these data structures at that time,</p>
<p>6<br>00:00:37,200 –&gt; 00:00:42,320<br>and people around the world use them in implementing various different systems.</p>
<p>7<br>00:00:43,119 –&gt; 00:00:50,959<br>But just a few years ago, for this course, I found a much simpler implementation of red-black trees,</p>
<p>8<br>00:00:51,439 –&gt; 00:00:57,520<br>and this is just a case study showing that there are simple algorithms still out there waiting</p>
<p>9<br>00:00:57,520 –&gt; 00:01:00,160<br>to be discovered, and this is one of them that we’re going to talk about.</p>
<p>10<br>00:01:01,280 –&gt; 00:01:08,240<br>So the idea is that we are going to represent every two-three tree as a binary search tree,</p>
<p>11<br>00:01:08,799 –&gt; 00:01:13,680<br>in order to get that done, we just need a simple representation for three nodes.</p>
<p>12<br>00:01:14,320 –&gt; 00:01:22,000<br>So what we’re going to do is use internal left-leaning links to glue the three nodes together.</p>
<p>13<br>00:01:22,480 –&gt; 00:01:28,480<br>So the larger of the two nodes in the three node will always be the root of a little binary</p>
<p>14<br>00:01:28,480 –&gt; 00:01:35,680<br>search tree of size two for the three node. In the link between the two nodes, the left link that</p>
<p>15<br>00:01:35,680 –&gt; 00:01:42,480<br>links the larger key to the smaller one will call a red, and that’s to distinguish those links from</p>
<p>16<br>00:01:42,480 –&gt; 00:01:48,560<br>the other links in the binary tree, so that we can tell when we’re inserting things which nodes</p>
<p>17<br>00:01:49,280 –&gt; 00:01:56,719<br>belong to three nodes and which ones don’t. And you can see from this transformation that it’s easy to</p>
<p>18<br>00:01:58,800 –&gt; 00:02:04,719<br>perform this, see this correspondence, the middle link between A and B, those are the keys that are</p>
<p>19<br>00:02:04,719 –&gt; 00:02:12,479<br>less than B and larger than A, so that takes two comparisons to get to them. The ones that are</p>
<p>20<br>00:02:12,479 –&gt; 00:02:17,199<br>less than A and less than B less than A, that’s two comparisons from that, the ones that are greater</p>
<p>21<br>00:02:17,199 –&gt; 00:02:23,280<br>than B are the right link of B. So just following those three cases, see that this correspondence is</p>
<p>22<br>00:02:23,280 –&gt; 00:02:31,120<br>going to work. So any two-three tree corresponds to a left-leaning red-black BST in this way.</p>
<p>23<br>00:02:31,599 –&gt; 00:02:40,960<br>Just take the three nodes and split them into little binary search trees of size two held together</p>
<p>24<br>00:02:40,960 –&gt; 00:02:49,680<br>by a red link. And correspondingly, given a red-black BST, then you can get the two-three tree if you</p>
<p>25<br>00:02:49,680 –&gt; 00:02:56,719<br>wanted it. But just look at the properties of looking at the properties of a left-leaning red-black</p>
<p>26<br>00:02:56,719 –&gt; 00:03:05,680<br>BST, with reference to what we know about two-three trees. First of all, no node has two red links</p>
<p>27<br>00:03:05,680 –&gt; 00:03:12,319<br>connected to it because the only red links are internal to three nodes and those have to have</p>
<p>28<br>00:03:12,319 –&gt; 00:03:19,840<br>external links or tree links connecting them to some other node. Every path from the root down</p>
<p>29<br>00:03:19,840 –&gt; 00:03:26,079<br>to a no-link has the same number of black links that just follows directly from the corresponding</p>
<p>30<br>00:03:26,080 –&gt; 00:03:33,920<br>property for two-three trees. A left-leaning red-black BST has perfect black balance in all the red</p>
<p>31<br>00:03:33,920 –&gt; 00:03:40,960<br>links lean left. So given a BST with some of the links colored red that has those properties,</p>
<p>32<br>00:03:40,960 –&gt; 00:03:47,840<br>that’s going to correspond to a two-three tree. And that’s a key property is this one-to-one correspondence</p>
<p>33<br>00:03:47,840 –&gt; 00:03:54,320<br>between two-three trees and left-leaning red-black trees. Given a two-three tree, we saw how to do it,</p>
<p>34<br>00:03:54,319 –&gt; 00:04:03,840<br>given a red-black tree, we just make the red links horizontal and merge the nodes together to be three nodes.</p>
<p>35<br>00:04:04,639 –&gt; 00:04:10,639<br>So all of the operations that we’re going to look at for red-black trees can be understood in terms</p>
<p>36<br>00:04:10,639 –&gt; 00:04:17,360<br>of the corresponding operations on two-three trees. Now, the first and really one of the most</p>
<p>37<br>00:04:17,360 –&gt; 00:04:27,120<br>critical observations is that search in a red-black BST is exactly the same as for an elementary BST.</p>
<p>38<br>00:04:27,120 –&gt; 00:04:33,199<br>We just ignore the color. Now, it’s going to be much faster because of better balance in the tree,</p>
<p>39<br>00:04:33,199 –&gt; 00:04:39,199<br>but in terms of the code, we don’t have to change the code at all. Our regular search code doesn’t</p>
<p>40<br>00:04:39,199 –&gt; 00:04:46,879<br>examine the color of a link. And so we can just use it exactly as is. And in fact, most of the other</p>
<p>41<br>00:04:46,879 –&gt; 00:04:52,800<br>operations that we implemented on BSTs are also identical. They don’t need the colors, but they can</p>
<p>42<br>00:04:52,800 –&gt; 00:05:01,279<br>all benefit from the fact that the trees are much better balanced. So this aspect of red-black BSTs</p>
<p>43<br>00:05:01,279 –&gt; 00:05:09,519<br>is an extremely nice one because the operations that we implemented for regular BSTs involve some</p>
<p>44<br>00:05:09,519 –&gt; 00:05:15,040<br>complicated code for floor and ceiling and rank and so forth. And we don’t have to change that code at</p>
<p>45<br>00:05:15,040 –&gt; 00:05:25,120<br>all. We just during the insertion make sure that we maintain the properties, the balanced properties.</p>
<p>46<br>00:05:25,920 –&gt; 00:05:31,280<br>And by doing that, we wind up with balance trees and we make all the operations quick, and we don’t</p>
<p>47<br>00:05:31,280 –&gt; 00:05:39,280<br>have to re-implement, we don’t have to change them at all. So, before we get to the code for insertion,</p>
<p>48<br>00:05:39,279 –&gt; 00:05:46,319<br>we have to look at the red representation. We didn’t actually have explicit representation of links.</p>
<p>49<br>00:05:46,959 –&gt; 00:05:55,359<br>Our links in trees are just references to nodes. You could implement this by building explicit links,</p>
<p>50<br>00:05:55,359 –&gt; 00:06:02,799<br>but an easier thing to do is to notice that every node is referenced by just one link in a tree,</p>
<p>51<br>00:06:03,520 –&gt; 00:06:11,280<br>the one from its parents. So you can put the color of a link in the node that it references. So in this case,</p>
<p>52<br>00:06:13,360 –&gt; 00:06:23,840<br>we have a red link connecting E and C. What we do is put a bit, a color bit in each in the node class.</p>
<p>53<br>00:06:23,839 –&gt; 00:06:34,719<br>And then if the link coming into a node is red, we set that to true. So this simple thing just tests is a node red.</p>
<p>54<br>00:06:34,719 –&gt; 00:06:44,959<br>We consider all null nodes to be black. No links to be black. We don’t have red links dangling off that would be incomplete three nodes.</p>
<p>55<br>00:06:45,120 –&gt; 00:06:54,319<br>Otherwise, if the color is red, we return true. Otherwise, return false to test whether or not it’s red.</p>
<p>56<br>00:06:54,319 –&gt; 00:07:05,839<br>So in this tree, the color of h.left is red. The color of h.right is black and so forth. So that’s the way we represent colors.</p>
<p>57<br>00:07:05,839 –&gt; 00:07:11,679<br>By putting a color bit in the node for the color of the link that points to it.</p>
<p>58<br>00:07:11,920 –&gt; 00:07:21,600<br>All right. So now there’s a couple of elementary operations that we have to perform on red black trees called rotations.</p>
<p>59<br>00:07:21,600 –&gt; 00:07:32,399<br>And the idea is that during the construction of a tree, during an insertion operation, sometimes we wind up with red links that are leaning in the wrong direction.</p>
<p>60<br>00:07:33,279 –&gt; 00:07:48,479<br>So we’ll need what’s called a left rotation. And the job of that operation is to take a right leaning red link that is there for whatever reason and reorient it to lean to the left.</p>
<p>61<br>00:07:50,479 –&gt; 00:07:58,079<br>So in this case, we have the right link of e points to s and s is red. So that’s a right leaning red link.</p>
<p>62<br>00:07:58,879 –&gt; 00:08:06,639<br>And so that’s the before. And what we want to do is reorient things so that it leans to the left.</p>
<p>63<br>00:08:06,639 –&gt; 00:08:21,919<br>And again, that has to be a local operation that only changes a few links. And just from the diagram, it’s not difficult to see that this little bit of code will do the job.</p>
<p>64<br>00:08:22,879 –&gt; 00:08:42,480<br>If we start with the right leaning red link. So first thing we do is take the reference of h.write and save that in x. So that’s the node that’s going to be the new root of the three nodes, so to speak.</p>
<p>65<br>00:08:43,440 –&gt; 00:08:59,039<br>And then x.left after the rotation is going to be h. And also whatever color h was, well, looks like it should be black, but actually this situation’s where it could be red.</p>
<p>66<br>00:08:59,039 –&gt; 00:09:06,480<br>Then x is going to have that color because the link coming into h is going to be the link coming into x.</p>
<p>67<br>00:09:07,200 –&gt; 00:09:16,399<br>And then h is color is going to be black afterwards. And then we return x to link further up the tree, which happens during our standard recursive insert.</p>
<p>68<br>00:09:19,279 –&gt; 00:09:29,840<br>So that’s a rotate left operation. Now the property of this operation, that’s very important is it maintains a symmetric order.</p>
<p>69<br>00:09:29,840 –&gt; 00:09:37,759<br>The keys between E and s are still there. We just changed the way we get to them in the keys less than E and so forth.</p>
<p>70<br>00:09:37,759 –&gt; 00:09:57,920<br>And also we maintain perfect black balance because we didn’t change the black height of anything by doing this transformation. All those subtrees, those three subtrees are exactly the same relative to the top and bottom of the tree as they were before the rotation.</p>
<p>71<br>00:10:00,800 –&gt; 00:10:19,600<br>Now paradoxically, and you’ll see why very soon, it also turns out that to get the insertion done properly, we sometimes need to take a left leaning red link and temporarily make it lean right.</p>
<p>72<br>00:10:20,159 –&gt; 00:10:26,399<br>Later on, we’ll get it back to the left again, but anyway, that’s a basic operation that we sometimes need.</p>
<p>73<br>00:10:27,920 –&gt; 00:10:42,159<br>So that’s just the symmetric code to the code that we just did. Now x is h dot left and h dot left is going to be x dot right after the rotation.</p>
<p>74<br>00:10:42,319 –&gt; 00:10:49,759<br>x is color still going to be h is color and h is color is going to be red in the right rotation implements this.</p>
<p>75<br>00:10:52,399 –&gt; 00:11:03,120<br>And again, that’s going to maintain a symmetric order in perfect black balance. We changed the way the red goes, but we didn’t change anything about the black.</p>
<p>76<br>00:11:04,080 –&gt; 00:11:05,919<br>Okay, that’s a right rotation.</p>
<p>77<br>00:11:07,600 –&gt; 00:11:13,039<br>Now here’s the third elementary operation that we’re going to perform. It’s called a color flip.</p>
<p>78<br>00:11:13,919 –&gt; 00:11:21,440<br>Sometimes during the insertion, we might wind up with a node that’s got two red links coming out of it.</p>
<p>79<br>00:11:22,000 –&gt; 00:11:28,560<br>That’s corresponds precisely to our temporary forenode when we’re doing two three trees.</p>
<p>80<br>00:11:29,199 –&gt; 00:11:35,279<br>And what we wanted to do with the temporary forenode was to split it and pass the center node up to the root.</p>
<p>81<br>00:11:35,759 –&gt; 00:11:39,039<br>Well, you can see from this structure that we’re all set to do that.</p>
<p>82<br>00:11:40,079 –&gt; 00:11:44,239<br>All we need to do actually is not change any links, just change all the colors.</p>
<p>83<br>00:11:45,439 –&gt; 00:11:52,879<br>And so that is we changed the link from e to a and from e to s to be black. That essentially splits the forenode.</p>
<p>84<br>00:11:53,600 –&gt; 00:12:01,840<br>And then we want to insert the e into its parent. And we just do that by changing its link to be red.</p>
<p>85<br>00:12:02,639 –&gt; 00:12:09,679<br>So that’s flipping the colors. And that’s the way we split a temporary forenode in a left-leaning red black tree.</p>
<p>86<br>00:12:10,240 –&gt; 00:12:14,639<br>And again, that’s just flipping colors. It doesn’t change any links. So it’s still, of course,</p>
<p>87<br>00:12:14,639 –&gt; 00:12:20,960<br>maintain symmetric order and perfect black balance. So those are the three basic operations we’re going to use.</p>
<p>88<br>00:12:20,960 –&gt; 00:12:28,399<br>Rotate left, rotate right, and flip colors. So the basic strategy is with those operations,</p>
<p>89<br>00:12:28,720 –&gt; 00:12:37,360<br>maintain one-to-one correspondence with two three trees when we do insertions. So here’s an example.</p>
<p>90<br>00:12:38,320 –&gt; 00:12:48,320<br>If we want to insert c into this red black tree, which is a representation of this two three tree,</p>
<p>91<br>00:12:49,039 –&gt; 00:12:58,159<br>then c is going to be less than e greater than a. So it’ll get added as the right link of a.</p>
<p>92<br>00:12:58,159 –&gt; 00:13:07,039<br>And every time we add a node, we just create a red link to its parents. And so that’s changing the two node into a three node.</p>
<p>93<br>00:13:07,519 –&gt; 00:13:14,320<br>In this case, it’s a three node that’s oriented the wrong way, so we need to do a left rotate.</p>
<p>94<br>00:13:14,320 –&gt; 00:13:22,720<br>After we do the left rotate, we have a legal left-leaning red black tree, and it exactly corresponds to that two three tree.</p>
<p>95<br>00:13:22,720 –&gt; 00:13:27,759<br>So the insertion of c gives us exactly what we’d want, the correspondence with the two three tree.</p>
<p>96<br>00:13:28,320 –&gt; 00:13:35,600<br>We have to work through other cases that can arise, but there’s not too many, so we’ll work through them.</p>
<p>97<br>00:13:35,680 –&gt; 00:13:39,600<br>And we have the basic operations, left rotate, right rotate, and flip colors.</p>
<p>98<br>00:13:40,320 –&gt; 00:13:45,040<br>All right, so first warm up, insert into a tree with exactly one node.</p>
<p>99<br>00:13:46,000 –&gt; 00:13:50,879<br>Well, if it goes on the left, then we just make a red link and add it on, and we’re done.</p>
<p>100<br>00:13:51,920 –&gt; 00:13:57,200<br>If it goes on the right, then we attach a new node with a red link on the right,</p>
<p>101<br>00:13:57,200 –&gt; 00:14:00,560<br>but we have to rotate it to the left to make a legal three node.</p>
<p>102<br>00:14:01,279 –&gt; 00:14:06,479<br>So that’s insert into a tree with a one node and make it a tree with two nodes.</p>
<p>103<br>00:14:08,319 –&gt; 00:14:14,239<br>And that one generalizes to help us insert into a two node at the bottom.</p>
<p>104<br>00:14:15,599 –&gt; 00:14:26,399<br>So we do the standard VST insert, color the new link red, and then if that new three node happens to</p>
<p>105<br>00:14:26,399 –&gt; 00:14:29,840<br>lean right, rotate it to the left. That’s the case that we just did.</p>
<p>106<br>00:14:31,919 –&gt; 00:14:37,919<br>So now let’s look at a second warm up. So say we have just two nodes in the tree, so it’s a,</p>
<p>107<br>00:14:38,639 –&gt; 00:14:41,679<br>we have two nodes, and that means it’s a single three node.</p>
<p>108<br>00:14:42,879 –&gt; 00:14:50,319<br>Then there’s three cases. So one is that the new one is larger than both of the keys.</p>
<p>109<br>00:14:51,040 –&gt; 00:14:55,520<br>If that’s true, then we attach the new node with a red link as always,</p>
<p>110<br>00:14:56,240 –&gt; 00:15:01,840<br>and that gives us a temporary four node. And what we want to do is split that four node,</p>
<p>111<br>00:15:02,560 –&gt; 00:15:07,200<br>and in this case, since we’re at the root, that’s all, so that just flips the colors.</p>
<p>112<br>00:15:07,760 –&gt; 00:15:12,800<br>Now the color of the root in our code would temporarily turn red and then would turn a black again.</p>
<p>113<br>00:15:13,759 –&gt; 00:15:22,000<br>So that’s inserting into a tree that’s a single three node, a node that’s larger than both of them,</p>
<p>114<br>00:15:22,000 –&gt; 00:15:25,679<br>a key that’s larger than both of them, and we get wind up with a four node.</p>
<p>115<br>00:15:25,679 –&gt; 00:15:31,839<br>But let’s look at the other two cases, and these understanding these is crucial to understanding the whole algorithm.</p>
<p>116<br>00:15:32,719 –&gt; 00:15:36,559<br>Let’s say the new key is smaller than both of the keys in our three node.</p>
<p>117<br>00:15:37,199 –&gt; 00:15:42,639<br>We attach a new link at the left of the smaller node,</p>
<p>118<br>00:15:43,519 –&gt; 00:15:48,159<br>and now we’ve got to find BST, but it has two red links in a row.</p>
<p>119<br>00:15:48,879 –&gt; 00:15:55,919<br>And that’s something that’s not allowed. So what we’re going to do is we’re going to rotate the top link to the right.</p>
<p>120<br>00:15:57,439 –&gt; 00:16:02,639<br>So that puts B at the root, and now it’s got two red children.</p>
<p>121<br>00:16:02,720 –&gt; 00:16:16,960<br>It reduces it to this case, and we flip the colors, and we have a single four node, sorry, a red-black tree that’s got three two nodes in no red links.</p>
<p>122<br>00:16:18,159 –&gt; 00:16:25,600<br>Same situation as before. So we had a single temporary four node, and we split it up into two two nodes, and I connected to a two node.</p>
<p>123<br>00:16:26,560 –&gt; 00:16:37,360<br>And then, so that’s the case when it’s smaller. Now we have to look at the third case, which is when the new node is inserted as in between, and comes out at this link here.</p>
<p>124<br>00:16:38,399 –&gt; 00:16:47,200<br>Again, we just add a red link, and now we have a BST with two red links along a path connected to a, and that’s not allowed.</p>
<p>125<br>00:16:48,160 –&gt; 00:16:55,759<br>In this case, it’s a bit trickier to fix the situation. What we do is we rotate the bottom link left.</p>
<p>126<br>00:16:57,600 –&gt; 00:17:09,759<br>So, and that gives us this, and reduce it to the other situation that we had before, and then we rotate the top link right, and then we flip the colors.</p>
<p>127<br>00:17:10,559 –&gt; 00:17:16,319<br>So this one, we use all three of our operations. Rotate left, rotate right, and flip the colors.</p>
<p>128<br>00:17:16,960 –&gt; 00:17:26,960<br>And that gets us an insertion into a tree that has, from a tree that is a single three node, to a tree that is three two nodes containing three keys.</p>
<p>129<br>00:17:28,960 –&gt; 00:17:36,640<br>So that sort of operation is going to work in a big tree when we insert into a new three node at the bottom.</p>
<p>130<br>00:17:37,360 –&gt; 00:17:57,440<br>We do the standard BST insert, color the new link red, and we do the rotations that we need, either one or two rotations to balance the temporary four node, and then we flip colors to pass the red link up one level, and then we might need to rotate to that and to make that one lean left.</p>
<p>131<br>00:17:57,440 –&gt; 00:18:05,120<br>So, for example, if we insert H into this tree here, it comes off as the left link to var.</p>
<p>132<br>00:18:05,919 –&gt; 00:18:14,319<br>So that gives us a temporary four node that’s not balanced, so we need to rotate the link from S to the right.</p>
<p>133<br>00:18:15,519 –&gt; 00:18:21,519<br>And that gives us now a temporary four node that is balanced. And again, these are all local transformations.</p>
<p>134<br>00:18:21,519 –&gt; 00:18:23,519<br>It’s not changing the rest of the tree.</p>
<p>135<br>00:18:24,319 –&gt; 00:18:34,719<br>Now we flip colors, and that gives us a good red black tree, except that one red line.</p>
<p>136<br>00:18:34,720 –&gt; 00:18:39,920<br>Red link that we just made is leaning the wrong way, so now we need to rotate left.</p>
<p>137<br>00:18:40,559 –&gt; 00:18:44,880<br>And then once we’ve done that, now we have a legal left leaning red black tree.</p>
<p>138<br>00:18:46,079 –&gt; 00:18:51,519<br>So that’s a insertion into a three node at the bottom.</p>
<p>139<br>00:18:53,120 –&gt; 00:19:03,519<br>So here’s another one that involves, remember we passed that red link up, if that gets passed up to a three node,</p>
<p>140<br>00:19:03,519 –&gt; 00:19:12,000<br>then we have to continue moving up the tree and just treat it in the same way as we just treated</p>
<p>141<br>00:19:12,639 –&gt; 00:19:17,920<br>inserting at the bottom. We have a new red link appearing into some three node.</p>
<p>142<br>00:19:18,400 –&gt; 00:19:27,119<br>There’s the three cases that could happen. Here’s an example. So say we’re inserting P into this</p>
<p>143<br>00:19:27,119 –&gt; 00:19:33,359<br>left leaning red black tree. It goes to the right of M, so we get a temporary four node that’s got</p>
<p>144<br>00:19:34,159 –&gt; 00:19:38,799<br>two red links, both children are red and that thing, so we want to flip the colors.</p>
<p>145<br>00:19:39,759 –&gt; 00:19:48,479<br>We flip the colors, and now our temporary four node is up higher in the tree, but it’s not balanced.</p>
<p>146<br>00:19:48,479 –&gt; 00:19:51,679<br>So we’re going to have to do two rotations to make that balanced.</p>
<p>147<br>00:19:51,840 –&gt; 00:20:00,480<br>First one is to make the bottom link left leaning, and then the second one is to make the top link right leaning</p>
<p>148<br>00:20:01,120 –&gt; 00:20:04,240<br>so that we can have the temporary four node balanced.</p>
<p>149<br>00:20:05,120 –&gt; 00:20:10,640<br>And then the last thing we do is flip the colors, and now that’s the result of that insertion.</p>
<p>150<br>00:20:11,200 –&gt; 00:20:17,440<br>It’s a bunch of transformations, but they’re all simple using our flip colors or left or right rotation.</p>
<p>151<br>00:20:17,920 –&gt; 00:20:28,400<br>And that one happened to be at the root. If that red link were way down in the tree, and there were another three node above it, we might have to do it again.</p>
<p>152<br>00:20:28,720 –&gt; 00:20:31,600<br>Again, exactly as would happen in a two, three tree.</p>
<p>153<br>00:20:33,440 –&gt; 00:20:40,240<br>So let’s do a demo of constructing the red black BST from our standard set of keys.</p>
<p>154<br>00:20:41,039 –&gt; 00:20:50,799<br>So we start with a single key, and now if we want to insert E, it goes to the left, that’s fine.</p>
<p>155<br>00:20:51,039 –&gt; 00:21:03,039<br>That’s a legal left leaning red black tree. A would go to the left of E, two left in a row, so we have to rotate S right, and then we have to flip the colors.</p>
<p>156<br>00:21:03,680 –&gt; 00:21:05,839<br>And that’s a legal red black BST.</p>
<p>157<br>00:21:07,119 –&gt; 00:21:16,480<br>So now if we insert R into this one, then it goes on a red link to the left of X, S, and that’s fine, it’s a red black BST.</p>
<p>158<br>00:21:17,599 –&gt; 00:21:22,799<br>Now if we insert C into this one, it goes less than E greater than A.</p>
<p>159<br>00:21:23,759 –&gt; 00:21:29,839<br>It’s a red link connecting A and C, but it’s leaning the wrong way, so we have to do a left rotation.</p>
<p>160<br>00:21:29,919 –&gt; 00:21:41,199<br>Legal red black BST. We want to insert H, that goes to the left of R, two reds in a row, rotate the top.</p>
<p>161<br>00:21:42,240 –&gt; 00:21:45,679<br>Rotate the top, our temporary four notice balanced, flip colors.</p>
<p>162<br>00:21:47,439 –&gt; 00:21:53,919<br>Now we have a three node, but the red link is leaning right, so we have to rotate.</p>
<p>163<br>00:21:53,920 –&gt; 00:22:06,000<br>And then now we have a legal red black BST. Insert X into that one, it goes to the right of S, that’s certainly leaning the wrong way, rotate left.</p>
<p>164<br>00:22:08,480 –&gt; 00:22:14,480<br>Insert M into this one, it goes to the right of H, leaning the wrong way, rotate left.</p>
<p>165<br>00:22:14,720 –&gt; 00:22:29,360<br>Most of the operations are simple ones like this happening at the bottom. Insert P, that goes to the right of M, that makes M a temporary four node that happens to be balanced, so flip the colors.</p>
<p>166<br>00:22:31,200 –&gt; 00:22:36,720<br>Flip the colors, now we have a temporary four node that’s out of balance, so we need a double rotation.</p>
<p>167<br>00:22:36,799 –&gt; 00:22:48,480<br>First rotate E to make that link point lean to the left, then rotate R to bring the temporary four node into balance, and then flip the colors.</p>
<p>168<br>00:22:48,640 –&gt; 00:22:59,279<br>And that’s a legal red black BST. Insert L into that one, goes to the right of H, leaning the wrong way, rotate left.</p>
<p>169<br>00:22:59,359 –&gt; 00:23:07,039<br>And that’s an example of building a red black BST from our standard set of keys.</p>
<p>170<br>00:23:09,599 –&gt; 00:23:17,440<br>Now we’re ready to look at the implementation of the code for inserting into a left leaning red black tree.</p>
<p>171<br>00:23:18,000 –&gt; 00:23:25,360<br>And the key to understanding this code is to realize that the same code handles all of the cases.</p>
<p>172<br>00:23:26,400 –&gt; 00:23:31,279<br>And the way that it works is we’re always reducing one case to another.</p>
<p>173<br>00:23:32,320 –&gt; 00:23:41,440<br>We got this most complicated case, we did a left rotate on the bottom node, and that transformed it to this case where they’re both leaning left.</p>
<p>174<br>00:23:42,000 –&gt; 00:23:52,000<br>And then we did a right rotate on the top node, and that transformed to the case where our temporary four node is balanced, and then we flip colors on that.</p>
<p>175<br>00:23:52,720 –&gt; 00:23:58,080<br>So for a particular insertion, we can take advantage of this, reduce one case to another,</p>
<p>176<br>00:23:59,279 –&gt; 00:24:10,960<br>by in the way that we’re moving in the tree to get everything happen with just a few extra lines of code in our standard binary search tree.</p>
<p>177<br>00:24:11,519 –&gt; 00:24:16,720<br>So in gray is our standard insertion code for binary search trees.</p>
<p>178<br>00:24:17,759 –&gt; 00:24:32,880<br>And remember, we took some pains to think about the recursive implementation where when we go down a link, we replace that link by whatever the recursive routine gives us back.</p>
<p>179<br>00:24:33,760 –&gt; 00:24:38,240<br>And that strategy is going to pay off in giving us a really simple code.</p>
<p>180<br>00:24:39,920 –&gt; 00:24:47,200<br>And because in this implementation for left leaning red black trees, we’re going to return the link whenever we’re done.</p>
<p>181<br>00:24:47,920 –&gt; 00:24:54,320<br>And then that’ll get that link installed up in the node above, whether it be left or right.</p>
<p>182<br>00:24:55,039 –&gt; 00:25:10,399<br>Typical implementations of red black trees that do not use this recursive strategy wind up having lots of cases depending on whether left or right or double rotate to the left or double rotate to the right.</p>
<p>183<br>00:25:11,119 –&gt; 00:25:16,000<br>It can be critical of this code because my own code was this way for the first three editions of the book.</p>
<p>184<br>00:25:16,639 –&gt; 00:25:22,000<br>It’s only a misadition that we figured out how to make the code this simple.</p>
<p>185<br>00:25:22,960 –&gt; 00:25:26,160<br>Okay, so one of the things that have to be done, let’s just check.</p>
<p>186<br>00:25:27,599 –&gt; 00:25:37,440<br>When we insert a new node, all we want to do is create a new node with the given associating the given value with the given key as before.</p>
<p>187<br>00:25:38,160 –&gt; 00:25:47,759<br>But now we just make that node red. So that’s adding a new node with a red link at the bottom, inserting that into whatever.</p>
<p>188<br>00:25:47,839 –&gt; 00:25:52,319<br>Two or three nodes attached to.</p>
<p>189<br>00:25:53,519 –&gt; 00:26:16,000<br>And then we do the comparisons as before and that’s all fine. Now when it’s returned, then that’s the point at which we’re going to check whether the links are leaning to the left as they’re supposed to and whether or not there are any double links or not.</p>
<p>190<br>00:26:16,640 –&gt; 00:26:33,119<br>So the first thing is if is red h dot right and not is red h dot left. So that means h is h dot right is red.</p>
<p>191<br>00:26:33,679 –&gt; 00:26:41,359<br>So that means that the right link of h is leaning the wrong way. h is a three node leaning the wrong way.</p>
<p>192<br>00:26:41,599 –&gt; 00:26:52,799<br>So we just rotate left h. So whenever we find a right link or sitting on a right red link, we just rotate it left and return that.</p>
<p>193<br>00:26:52,959 –&gt; 00:26:57,439<br>So that would be in this case here, would rotate it left and reduce it to that one.</p>
<p>194<br>00:26:57,519 –&gt; 00:27:11,519<br>Or in the case one, we’re just inserting a new node and it turns out to be the right red link attached to a black one.</p>
<p>195<br>00:27:12,160 –&gt; 00:27:25,039<br>So that handles that case. Now if h dot left is red and h dot left that left is also red, that’s this case here where we have two left leaning red links.</p>
<p>196<br>00:27:25,359 –&gt; 00:27:36,879<br>Then in that case we just rotate the top one right and that brings us to this one. So notice that we’re in this case we do this rotation first, we’re on this node.</p>
<p>197<br>00:27:37,599 –&gt; 00:27:45,440<br>And then that returns when we come up to a deal with the situation on this node after the return and then we do that rotation.</p>
<p>198<br>00:27:46,000 –&gt; 00:27:55,039<br>And then after that rotation or if there were no rotations at all if the insertion happened over here, then we test and flip the colors.</p>
<p>199<br>00:27:55,840 –&gt; 00:28:09,360<br>It’s a little mind bending at first because of the recursive structure, but it won’t take you long to convince yourself that this little bit of extra code completes the implementation of left leaning red black trees.</p>
<p>200<br>00:28:09,440 –&gt; 00:28:13,759<br>It’s quite remarkable actually. So let’s look at a visualization.</p>
<p>201<br>00:28:16,400 –&gt; 00:28:27,440<br>Watching about this is a balanced tree getting constructed in the worst case where everything that comes in is in ascending order.</p>
<p>202<br>00:28:28,000 –&gt; 00:28:35,279<br>A regular binary search tree would just be all string out in a single line and would have quadratic time for this input.</p>
<p>203<br>00:28:36,000 –&gt; 00:28:45,120<br>But a left leaning red black tree actually when it whenever it becomes a power of two is completely balanced as you can see from this example.</p>
<p>204<br>00:28:46,320 –&gt; 00:28:52,400<br>Even though they came in ascending order the tree winds up being perfectly balanced.</p>
<p>205<br>00:28:53,759 –&gt; 00:29:06,559<br>And what about descending order? Well it’s left leaning and the process is a little bit different and sometimes the left path can get long but not that long.</p>
<p>206<br>00:29:07,119 –&gt; 00:29:11,039<br>The worst that can happen is that it alternates red and black.</p>
<p>207<br>00:29:13,039 –&gt; 00:29:21,839<br>And then after it gets to that worst case it also winds up being completely balanced when we have a power of two.</p>
<p>208<br>00:29:22,480 –&gt; 00:29:30,319<br>Interesting to think just about this case and to prove to yourself that it’s always going to be perfectly balanced when it’s descending.</p>
<p>209<br>00:29:30,960 –&gt; 00:29:34,639<br>And this is just for random insertions.</p>
<p>210<br>00:29:36,879 –&gt; 00:29:51,519<br>The tree stays very balanced. It’s guaranteed that the longest path which is alternating red and black can be no more than twice as long as the shortest path which is all blacks.</p>
<p>211<br>00:29:51,519 –&gt; 00:30:10,720<br>And so in this case the longest path is 10 and the average path is 7 for 255. Very close to log base 2 of n.</p>
<p>212<br>00:30:10,720 –&gt; 00:30:23,920<br>So easy to prove by correspondence with two three trees that the height is guaranteed to be less than two log base 2 n.</p>
<p>213<br>00:30:24,880 –&gt; 00:30:30,480<br>Every search in a left leaning red, black tree is guaranteed to take less than two log base 2 of n.</p>
<p>214<br>00:30:31,519 –&gt; 00:30:35,519<br>Because every pass got the same number of black lengths. He never had two red lengths in a row.</p>
<p>215<br>00:30:36,160 –&gt; 00:30:58,319<br>And actually in typical applications with any kind of randomness or even if there’s a lot of order it’s difficult to find situations, orders of keys that build trees that height is bigger than actually one log n.</p>
<p>216<br>00:30:58,960 –&gt; 00:31:04,319<br>In in real applications it’s very close to fully balanced all the time.</p>
<p>217<br>00:31:06,480 –&gt; 00:31:15,519<br>So that completes our summary for symbol table implementations. With red black BSTs we have full code.</p>
<p>218<br>00:31:15,680 –&gt; 00:31:26,879<br>It’s the regular BST code with a couple of lines adding the calls on the basic operations to rotate right, rotate left and color flip.</p>
<p>219<br>00:31:26,879 –&gt; 00:31:33,039<br>And we get guaranteed logarithmic performance. Not just for search insert in delete.</p>
<p>220<br>00:31:33,039 –&gt; 00:31:38,079<br>Well delete code is a bit more complicated but it’s on the book side and in the book.</p>
<p>221<br>00:31:38,960 –&gt; 00:31:54,399<br>But also since it’s the compare to interface and since it’s a binary tree representation all the other comparable operations extended operations for ordered symbol tables are going to be implemented and take time proportional to log n.</p>
<p>222<br>00:31:55,360 –&gt; 00:32:18,640<br>A lot of people ask why did we use the name red black? Well we invented this data structure of this way of looking at balanced trees at at Xerox Park which was the home of the personal computer and many other innovations that we live with today and turning graphic years in interface and internet and object oriented programming and many other things.</p>
<p>223<br>00:32:18,880 –&gt; 00:32:32,000<br>But one of the things that was invented there was laser printing and we were very excited to have nearby color laser printer that could print things out in color and out of the colors the red look the best.</p>
<p>224<br>00:32:32,000 –&gt; 00:32:43,680<br>So that’s why we picked the color red to distinguish red links the types of links in three notes. So that’s an answer the question for people that have been asking.</p>
<p>225<br>00:32:44,400 –&gt; 00:33:03,600<br>There’s another war story about red black bsts as I mentioned they’re widely used and there was an example not that long ago where a telephone company contracted with a database provider to build a database base that could store customer information.</p>
<p>226<br>00:33:03,599 –&gt; 00:33:25,519<br>And the provider implemented the database using red black bsts for search and insert. Now our original paper on red black trees was the way the paper was laid out a turnout that the delete implementation happened to be placed after all the references.</p>
<p>227<br>00:33:25,519 –&gt; 00:33:43,440<br>So a lot of people didn’t see the delete implementation and also we didn’t have the simple left leaning representation. So it was more complicated and involved a lot more cases and so usually not all the cases were put in the textbooks.</p>
<p>228<br>00:33:43,440 –&gt; 00:33:53,680<br>So people found deletion more difficult in fact that’s what led to led me to analyze the situation and come up with the left leaning variant.</p>
<p>229<br>00:33:54,640 –&gt; 00:34:12,720<br>So what they did in this implementation was they just put in regular hybrid deletion in the binary search in the red black bst not the deletion algorithm that’s guaranteed to keep the constant black height all the time.</p>
<p>230<br>00:34:12,719 –&gt; 00:34:42,639<br>But they still thought that it should be balanced and it shouldn’t matter much and they had a complex error recovery process that got triggered if the height limit got too big and they rebuilt the whole tree and then because of the way they did this deletion well the end of the story was that they had an example.</p>
<p>231<br>00:34:42,639 –&gt; 00:35:12,559<br>The client had extended outage because the implementer didn’t use the full algorithm and there was a lawsuit and some legal testimony and happy to report that the it was clear that hybrid deletion was the problem once the expert analyze it and the expert witness whose colleague of mine said if implemented properly the height of a red black bst.</p>
<p>232<br>00:35:12,559 –&gt; 00:35:23,519<br>So that’s the story of red black bst’s guaranteed log of performance for all symbol table operations.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>PrincetonAlgorithms P45Part110 04_red Black Bsts</div>
      <div>http://example.com/2025/10/25/PrincetonAlgorithms P45Part110-04_red-black-bsts/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年10月25日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/10/25/PrincetonAlgorithms%20P46Part110-05_b-trees-optional/" title="PrincetonAlgorithms P46Part110 05_b Trees Optional">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">PrincetonAlgorithms P46Part110 05_b Trees Optional</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/10/25/PrincetonAlgorithms%20P3Part12-04_quick-find/" title="PrincetonAlgorithms P3Part12 04_quick Find">
                        <span class="hidden-mobile">PrincetonAlgorithms P3Part12 04_quick Find</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
